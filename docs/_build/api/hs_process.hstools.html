<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="python">
  <head>
    <meta charset="utf-8" />
    <title>8.1.4. hstools &#8212; hs_process 0.0.3 documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="8.1.5. segment" href="hs_process.segment.html" />
    <link rel="prev" title="8.1.3. hsio" href="hs_process.hsio.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          hs_process</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="https://github.com/tnigon/hs_process">Github</a></li>
                <li><a href="https://pypi.org/project/hs-process/">PyPI</a></li>
                <li><a href="http://www.spectralpython.net/">Spectral Python</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Contents <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">1. Setup and Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial_hsio.html">2. Tutorial: <code class="docutils literal notranslate"><span class="pre">hsio</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial_hstools.html">3. Tutorial: <code class="docutils literal notranslate"><span class="pre">hstools</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial_segment.html">4. Tutorial: <code class="docutils literal notranslate"><span class="pre">segment</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial_spec_mod.html">5. Tutorial: <code class="docutils literal notranslate"><span class="pre">spec_mod</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial_spatial_mod.html">6. Tutorial: <code class="docutils literal notranslate"><span class="pre">spatial_mod</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial_batch.html">7. Tutorial: <code class="docutils literal notranslate"><span class="pre">batch</span></code></a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../my_hs_process_api.html">8. API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">9. License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">10. Change Log</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="hs_process.hsio.html" title="Previous Chapter: 8.1.3. hsio"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; 8.1.3. hsio</span>
    </a>
  </li>
  <li>
    <a href="hs_process.segment.html" title="Next Chapter: 8.1.5. segment"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">8.1.5. segment &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../_sources/api/hs_process.hstools.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">8.1.4. hstools</a></li>
</ul>

<form action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="body col-md-9 content" role="main">
      
  <div class="section" id="hstools">
<h1><span class="section-number">8.1.4. </span>hstools<a class="headerlink" href="#hstools" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="hs_process.hstools">
<em class="property">class </em><code class="sig-prename descclassname">hs_process.</code><code class="sig-name descname">hstools</code><span class="sig-paren">(</span><em class="sig-param">spyfile</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hs_process/utilities.html#hstools"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hs_process.hstools" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Basic tools for manipulating Spyfiles and accessing their metadata.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object) -- The datacube being accessed and/or
manipulated.</p>
</dd>
</dl>
<p class="rubric">Methods Summary</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#hs_process.hstools.clean_md_sets" title="hs_process.hstools.clean_md_sets"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clean_md_sets</span></code></a>([metadata])</p></td>
<td><p>Converts metadata items that are expressed as a list to be expressed as a dictionary.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hs_process.hstools.del_meta_item" title="hs_process.hstools.del_meta_item"><code class="xref py py-obj docutils literal notranslate"><span class="pre">del_meta_item</span></code></a>(metadata, key)</p></td>
<td><p>Deletes metadata item from SpyFile object.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hs_process.hstools.get_UTM" title="hs_process.hstools.get_UTM"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_UTM</span></code></a>(pix_e_ul, pix_n_ul, utm_x, utm_y, ...)</p></td>
<td><p>Calculates the new UTM coordinate of cropped plot to modify the &quot;map info&quot; tag of the .hdr file.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hs_process.hstools.get_band" title="hs_process.hstools.get_band"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_band</span></code></a>(target_wl[, spyfile])</p></td>
<td><p>Finds the band number of the closest target wavelength.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hs_process.hstools.get_band_index" title="hs_process.hstools.get_band_index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_band_index</span></code></a>(band_num)</p></td>
<td><p>Subtracts 1 from <code class="docutils literal notranslate"><span class="pre">band_num</span></code> and returns the band index(es).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hs_process.hstools.get_band_num" title="hs_process.hstools.get_band_num"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_band_num</span></code></a>(band_idx)</p></td>
<td><p>Adds 1 to <code class="docutils literal notranslate"><span class="pre">band_idx</span></code> and returns the band number(s).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hs_process.hstools.get_band_range" title="hs_process.hstools.get_band_range"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_band_range</span></code></a>(range_wl[, index, spyfile])</p></td>
<td><p>Retrieves the band index or band number for all bands within a wavelength range.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hs_process.hstools.get_center_wl" title="hs_process.hstools.get_center_wl"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_center_wl</span></code></a>(wl_list[, spyfile, wls])</p></td>
<td><p>Gets band numbers and mean wavelength from all wavelengths (or bands) in <code class="docutils literal notranslate"><span class="pre">wl_list</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hs_process.hstools.get_meta_set" title="hs_process.hstools.get_meta_set"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_meta_set</span></code></a>(meta_set[, idx])</p></td>
<td><p>Reads metadata &quot;set&quot; (i.e., string representation of a Python set; common in .hdr files), taking care to remove leading and trailing spaces.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hs_process.hstools.get_spectral_mean" title="hs_process.hstools.get_spectral_mean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_spectral_mean</span></code></a>(band_list[, spyfile])</p></td>
<td><p>Gets the spectral mean of a datacube from a list of bands.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hs_process.hstools.get_wavelength" title="hs_process.hstools.get_wavelength"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_wavelength</span></code></a>(target_band[, spyfile])</p></td>
<td><p>Returns actual wavelength of the closest target band.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hs_process.hstools.load_spyfile" title="hs_process.hstools.load_spyfile"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_spyfile</span></code></a>(spyfile)</p></td>
<td><p>Loads a <code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> (Spectral Python object) for data access and/or manipulation by the <code class="docutils literal notranslate"><span class="pre">hstools</span></code> class.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hs_process.hstools.mask_array" title="hs_process.hstools.mask_array"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mask_array</span></code></a>(array, metadata[, thresh, ...])</p></td>
<td><p>Creates a masked numpy array based on a threshold value.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hs_process.hstools.mean_datacube" title="hs_process.hstools.mean_datacube"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mean_datacube</span></code></a>(spyfile[, mask])</p></td>
<td><p>Calculates the mean spectra for a datcube; if <code class="docutils literal notranslate"><span class="pre">mask</span></code> is passed (as a</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hs_process.hstools.modify_meta_set" title="hs_process.hstools.modify_meta_set"><code class="xref py py-obj docutils literal notranslate"><span class="pre">modify_meta_set</span></code></a>(meta_set, idx, value)</p></td>
<td><p>Modifies metadata &quot;set&quot; (i.e., string representation of a Python set; common in .hdr files) by converting string to list, then adjusts the value of an item by its index.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hs_process.hstools.plot_histogram" title="hs_process.hstools.plot_histogram"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_histogram</span></code></a>(array[, fname_fig, title, ...])</p></td>
<td><p>Plots a histogram with the percentile value labeled.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods Documentation</p>
<dl class="method">
<dt id="hs_process.hstools.clean_md_sets">
<code class="sig-name descname">clean_md_sets</code><span class="sig-paren">(</span><em class="sig-param">metadata=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hs_process/utilities.html#hstools.clean_md_sets"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hs_process.hstools.clean_md_sets" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts metadata items that are expressed as a list to be expressed as
a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>metadata</strong> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>, optional) -- Metadata dictionary to clean</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>metadata_out</strong> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>) -- Cleaned metadata dictionary.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">dict</span></code></p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Create sample metadata with &quot;wavelength&quot; expressed as a list of strings</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;samples&#39;</span><span class="p">:</span> <span class="mi">1300</span><span class="p">,</span>
<span class="go">                &#39;lines&#39;: 617,</span>
<span class="go">                &#39;bands&#39;: 4,</span>
<span class="go">                &#39;file type&#39;: &#39;ENVI Standard&#39;,</span>
<span class="go">                &#39;wavelength&#39;: [&#39;394.6&#39;, &#39;396.6528&#39;, &#39;398.7056&#39;,</span>
<span class="go">                &#39;400.7584&#39;]}</span>
</pre></div>
</div>
<p>Clean metadata using <code class="docutils literal notranslate"><span class="pre">hstools.clean_md_sets</span></code>. Notice how
wavelength is now expressed as a <code class="docutils literal notranslate"><span class="pre">str</span></code> representation of a
<code class="docutils literal notranslate"><span class="pre">dict</span></code>, which is required for properly writing the metadata to
the .hdr file via <a class="reference external" href="http://www.spectralpython.net/class_func_ref.html#spectral.io.envi.save_image">save_image()</a> in Spectral Python.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">clean_md_sets</span><span class="p">(</span><span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">)</span>
<span class="go">{&#39;samples&#39;: 1300,</span>
<span class="go"> &#39;lines&#39;: 617,</span>
<span class="go"> &#39;bands&#39;: 4,</span>
<span class="go"> &#39;file type&#39;: &#39;ENVI Standard&#39;,</span>
<span class="go"> &#39;wavelength&#39;: &#39;{394.6, 396.6528, 398.7056, 400.7584}&#39;}</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="hs_process.hstools.del_meta_item">
<code class="sig-name descname">del_meta_item</code><span class="sig-paren">(</span><em class="sig-param">metadata</em>, <em class="sig-param">key</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hs_process/utilities.html#hstools.del_meta_item"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hs_process.hstools.del_meta_item" title="Permalink to this definition">¶</a></dt>
<dd><p>Deletes metadata item from SpyFile object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metadata</strong> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>) -- dictionary of the metadata</p></li>
<li><p><strong>key</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- dictionary key to delete</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>metadata</strong> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>) -- Dictionary containing the modified
metadata.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">dict</span></code></p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Create sample metadata</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;samples&#39;</span><span class="p">:</span> <span class="mi">1300</span><span class="p">,</span>
<span class="go">                &#39;lines&#39;: 617,</span>
<span class="go">                &#39;bands&#39;: 4,</span>
<span class="go">                &#39;file type&#39;: &#39;ENVI Standard&#39;,</span>
<span class="go">                &#39;map info&#39;: &#39;{UTM, 1.0, 1.0, 421356.76707299997, 4844936.7317699995, 0.04, 0.04, 15, T, WGS-84, units  meters, rotation  0.000}&#39;,</span>
<span class="go">                &#39;wavelength&#39;: [&#39;394.6&#39;, &#39;396.6528&#39;, &#39;398.7056&#39;,</span>
<span class="go">                &#39;400.7584&#39;]}</span>
</pre></div>
</div>
<p>Delete <em>&quot;map info&quot;</em> from <code class="docutils literal notranslate"><span class="pre">metadata</span></code> using <code class="docutils literal notranslate"><span class="pre">hstools.del_met_item</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">del_meta_item</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span> <span class="s1">&#39;map info&#39;</span><span class="p">)</span>
<span class="go">{&#39;samples&#39;: 1827,</span>
<span class="go"> &#39;lines&#39;: 617,</span>
<span class="go"> &#39;bands&#39;: 4,</span>
<span class="go"> &#39;file type&#39;: &#39;ENVI Standard&#39;,</span>
<span class="go"> &#39;wavelength&#39;: [&#39;394.6&#39;, &#39;396.6528&#39;, &#39;398.7056&#39;, &#39;400.7584&#39;]}</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="hs_process.hstools.get_UTM">
<code class="sig-name descname">get_UTM</code><span class="sig-paren">(</span><em class="sig-param">pix_e_ul</em>, <em class="sig-param">pix_n_ul</em>, <em class="sig-param">utm_x</em>, <em class="sig-param">utm_y</em>, <em class="sig-param">size_x</em>, <em class="sig-param">size_y</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hs_process/utilities.html#hstools.get_UTM"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hs_process.hstools.get_UTM" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the new UTM coordinate of cropped plot to modify the
&quot;map info&quot; tag of the .hdr file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pix_e_ul</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- upper left column (easting) where image
cropping begins.</p></li>
<li><p><strong>pix_n_ul</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- upper left row (northing) where image cropping
begins.</p></li>
<li><p><strong>utm_x</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>) -- UTM easting coordinates (meters) of the original
image (from the upper left).</p></li>
<li><p><strong>utm_y</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>) -- UTM northing coordinates (meters) of the
original image (from the upper left).</p></li>
<li><p><strong>size_x</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>) -- Ground resolved distance of the image pixels in
the x (easting) direction (meters).</p></li>
<li><p><strong>size_y</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>) -- Ground resolved distance of the image pixels in
the y (northing) direction (meters).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>2-element <code class="docutils literal notranslate"><span class="pre">tuple</span></code> containing</p>
<ul class="simple">
<li><p><strong>utm_x_new</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>): The modified UTM x coordinate (easting)
of cropped plot.</p></li>
<li><p><strong>utm_y_new</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>): The modified UTM y coordinate (northing)
of cropped plot.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Retrieve UTM coordinates and pixel sizes from the metadata</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">map_info_set</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;map info&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">utm_x</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_meta_set</span><span class="p">(</span><span class="n">map_info_set</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">utm_y</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_meta_set</span><span class="p">(</span><span class="n">map_info_set</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spy_ps_e</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">map_info_set</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spy_ps_n</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">map_info_set</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>
</pre></div>
</div>
<p>Calculate the UTM coordinates at the <em>100th easting pixel</em> and
<em>50th northing pixel</em> using <code class="docutils literal notranslate"><span class="pre">hstools.get_UTM</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ul_x_utm</span><span class="p">,</span> <span class="n">ul_y_utm</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_UTM</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span>
<span class="go">                                          utm_x, utm_y,</span>
<span class="go">                                          spy_ps_e,</span>
<span class="go">                                          spy_ps_n)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ul_x_utm</span>
<span class="go">441360.80707299995</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ul_y_utm</span>
<span class="go">4855934.691769999</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="hs_process.hstools.get_band">
<code class="sig-name descname">get_band</code><span class="sig-paren">(</span><em class="sig-param">target_wl</em>, <em class="sig-param">spyfile=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hs_process/utilities.html#hstools.get_band"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hs_process.hstools.get_band" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the band number of the closest target wavelength.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_wl</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code> or <code class="docutils literal notranslate"><span class="pre">float</span></code>) -- the target wavelength to retrieve
the band number for (required).</p></li>
<li><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object, optional) -- The datacube being accessed
and/or manipulated; if <code class="docutils literal notranslate"><span class="pre">None</span></code>, uses <code class="docutils literal notranslate"><span class="pre">hstools.spyfile</span></code>
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>key_band</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- band number of the closest target
wavelength (<code class="docutils literal notranslate"><span class="pre">target_wl</span></code>).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">int</span></code></p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Use <code class="docutils literal notranslate"><span class="pre">hstools.get_band</span></code> to find the band number corresponding to
<em>703 nm</em></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_band</span><span class="p">(</span><span class="mi">703</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
<span class="go">151</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="hs_process.hstools.get_band_index">
<code class="sig-name descname">get_band_index</code><span class="sig-paren">(</span><em class="sig-param">band_num</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hs_process/utilities.html#hstools.get_band_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hs_process.hstools.get_band_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Subtracts 1 from <code class="docutils literal notranslate"><span class="pre">band_num</span></code> and returns the band index(es).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>band_num</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code> or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the target band number(s) to retrieve</p></li>
<li><p><strong>band index for</strong> (<em>the</em>) -- </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>band_idx</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- band index of the passed band number
(<code class="docutils literal notranslate"><span class="pre">band_num</span></code>).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">int</span></code> or <code class="docutils literal notranslate"><span class="pre">list</span></code></p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Using <code class="docutils literal notranslate"><span class="pre">hstools.get_band_index</span></code>, find the band index of the <em>4th</em>, <em>43rd</em>, and <em>111th</em> bands</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_band_index</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">111</span><span class="p">])</span>
<span class="go">[3, 42, 110]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="hs_process.hstools.get_band_num">
<code class="sig-name descname">get_band_num</code><span class="sig-paren">(</span><em class="sig-param">band_idx</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hs_process/utilities.html#hstools.get_band_num"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hs_process.hstools.get_band_num" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds 1 to <code class="docutils literal notranslate"><span class="pre">band_idx</span></code> and returns the band number(s).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>band_idx</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code> or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the target band index(es) to
retrive the band number for (required).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>band_num</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code> or <code class="docutils literal notranslate"><span class="pre">list</span></code>): band number of the passed
band index (<code class="docutils literal notranslate"><span class="pre">band_idx</span></code>).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">int</span></code> or <code class="docutils literal notranslate"><span class="pre">list</span></code></p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Using <code class="docutils literal notranslate"><span class="pre">hstools.get_band_num</span></code>, find the band number located at the <em>4th</em>, <em>43rd</em>, and <em>111th</em> index values.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_band_num</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">111</span><span class="p">])</span>
<span class="go">[5, 44, 112]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="hs_process.hstools.get_band_range">
<code class="sig-name descname">get_band_range</code><span class="sig-paren">(</span><em class="sig-param">range_wl</em>, <em class="sig-param">index=True</em>, <em class="sig-param">spyfile=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hs_process/utilities.html#hstools.get_band_range"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hs_process.hstools.get_band_range" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves the band index or band number for all bands within a
wavelength range.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>range_wl</strong> (<code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the minimum and maximum wavelength to consider;
values should be <code class="docutils literal notranslate"><span class="pre">int</span></code> or <code class="docutils literal notranslate"><span class="pre">float</span></code>.</p></li>
<li><p><strong>index</strong> (<em>bool</em>) -- Indicates whether to return the band number
(<code class="docutils literal notranslate"><span class="pre">False</span></code>; min=1) or to return index number (<code class="docutils literal notranslate"><span class="pre">True</span></code>; min=0)
(default: <code class="docutils literal notranslate"><span class="pre">True</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>band_list</strong> (<code class="docutils literal notranslate"><span class="pre">list</span></code>): A list of all bands (either index or
number, depending on how <code class="docutils literal notranslate"><span class="pre">index</span></code> is set) between a range in
wavelength values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">list</span></code></p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Find the band number of all bands between <em>700</em> and <em>710 nm</em></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_band_range</span><span class="p">([</span><span class="mi">700</span><span class="p">,</span> <span class="mi">710</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">spyfile</span><span class="o">=</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
<span class="go">[150, 151, 152, 153, 154]</span>
</pre></div>
</div>
<p>Find the band index values of all bands between <em>700</em> and <em>710 nm</em>
via <code class="docutils literal notranslate"><span class="pre">hstools.get_band_range</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_band_range</span><span class="p">([</span><span class="mi">700</span><span class="p">,</span> <span class="mi">710</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">spyfile</span><span class="o">=</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
<span class="go">[149, 150, 151, 152, 153]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="hs_process.hstools.get_center_wl">
<code class="sig-name descname">get_center_wl</code><span class="sig-paren">(</span><em class="sig-param">wl_list</em>, <em class="sig-param">spyfile=None</em>, <em class="sig-param">wls=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hs_process/utilities.html#hstools.get_center_wl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hs_process.hstools.get_center_wl" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets band numbers and mean wavelength from all wavelengths (or bands)
in <code class="docutils literal notranslate"><span class="pre">wl_list</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wl_list</strong> (<code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the list of bands to get information for
(required).</p></li>
<li><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object) -- The datacube being accessed and/or
manipulated; if <code class="docutils literal notranslate"><span class="pre">None</span></code>, uses <code class="docutils literal notranslate"><span class="pre">hstools.spyfile</span></code> (default:
<code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>wls</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- whether wavelengths are passed in <code class="docutils literal notranslate"><span class="pre">wl_list</span></code> or if
bands are passed in <code class="docutils literal notranslate"><span class="pre">wl_list</span></code> (default: <code class="docutils literal notranslate"><span class="pre">True</span></code> - wavelenghts
passed).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>2-element <code class="docutils literal notranslate"><span class="pre">tuple</span></code> containing</p>
<ul class="simple">
<li><p><strong>bands</strong> (<code class="docutils literal notranslate"><span class="pre">list</span></code>): the list of bands (band number) corresponding
to <code class="docutils literal notranslate"><span class="pre">wl_list</span></code>.</p></li>
<li><p><strong>wls_mean</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>): the mean wavelength from <code class="docutils literal notranslate"><span class="pre">wl_list</span></code>.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Using <code class="docutils literal notranslate"><span class="pre">hstools.get_center_wl</span></code>, find the bands and <em>actual mean wavelength</em> of the bands closest to <em>700</em> and <em>710</em> nm.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bands</span><span class="p">,</span> <span class="n">wls_mean</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_center_wl</span><span class="p">([</span><span class="mi">700</span><span class="p">,</span> <span class="mi">710</span><span class="p">],</span> <span class="n">wls</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bands</span>
<span class="go">[150, 155]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wls_mean</span>
<span class="go">705.5992</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="hs_process.hstools.get_meta_set">
<code class="sig-name descname">get_meta_set</code><span class="sig-paren">(</span><em class="sig-param">meta_set</em>, <em class="sig-param">idx=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hs_process/utilities.html#hstools.get_meta_set"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hs_process.hstools.get_meta_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads metadata &quot;set&quot; (i.e., string representation of a Python set;
common in .hdr files), taking care to remove leading and trailing
spaces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>meta_set</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- the string representation of the metadata set</p></li>
<li><p><strong>idx</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- index to be read; if <code class="docutils literal notranslate"><span class="pre">None</span></code>, the whole list is
returned (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>metadata_list</strong> (<code class="docutils literal notranslate"><span class="pre">list</span></code> or <code class="docutils literal notranslate"><span class="pre">str</span></code>): List of metadata set
items (as <code class="docutils literal notranslate"><span class="pre">str</span></code>), or if idx is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, the item in the
position described by <code class="docutils literal notranslate"><span class="pre">idx</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">list</span></code> or <code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Retrieve the <em>&quot;map info&quot; set</em> from the metadata via
<code class="docutils literal notranslate"><span class="pre">hstools.get_meta_set</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">map_info_set</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;map info&#39;</span><span class="p">]</span>
<span class="go">[&#39;UTM&#39;,</span>
<span class="go"> &#39;1.0&#39;,</span>
<span class="go"> &#39;1.0&#39;,</span>
<span class="go"> &#39;441357.287073&#39;,</span>
<span class="go"> &#39;4855944.7717699995&#39;,</span>
<span class="go"> &#39;0.04&#39;,</span>
<span class="go"> &#39;0.04&#39;,</span>
<span class="go"> &#39;15&#39;,</span>
<span class="go"> &#39;T&#39;,</span>
<span class="go"> &#39;WGS-84&#39;,</span>
<span class="go"> &#39;units  meters&#39;,</span>
<span class="go"> &#39;rotation  0.000&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="hs_process.hstools.get_spectral_mean">
<code class="sig-name descname">get_spectral_mean</code><span class="sig-paren">(</span><em class="sig-param">band_list</em>, <em class="sig-param">spyfile=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hs_process/utilities.html#hstools.get_spectral_mean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hs_process.hstools.get_spectral_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the spectral mean of a datacube from a list of bands.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>band_list</strong> (<code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the list of bands to calculate the spectral
mean for on the datacube (required).</p></li>
<li><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object or <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) -- The datacube being
accessed and/or manipulated; if <code class="docutils literal notranslate"><span class="pre">None</span></code>, uses <code class="docutils literal notranslate"><span class="pre">hstools.spyfile</span></code>
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>array_mean</strong> (<code class="docutils literal notranslate"><span class="pre">numpy.array</span></code> or <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>): The
mean reflectance from <code class="docutils literal notranslate"><span class="pre">spyfile</span></code> for the bands in <code class="docutils literal notranslate"><span class="pre">band_list</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">numpy.array</span></code> or <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Calculate the spectral mean of the datacube via
<code class="docutils literal notranslate"><span class="pre">hstools.get_spectral_mean</span></code> using all bands between <em>800</em> and
<em>840 nm</em></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">band_list</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_band_range</span><span class="p">([</span><span class="mi">800</span><span class="p">,</span> <span class="mi">840</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array_mean</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_spectral_mean</span><span class="p">(</span><span class="n">band_list</span><span class="p">,</span> <span class="n">spyfile</span><span class="o">=</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">show_img</span><span class="p">(</span><span class="n">array_mean</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/get_spectral_mean.png" src="../_images/get_spectral_mean.png" />
</dd></dl>

<dl class="method">
<dt id="hs_process.hstools.get_wavelength">
<code class="sig-name descname">get_wavelength</code><span class="sig-paren">(</span><em class="sig-param">target_band</em>, <em class="sig-param">spyfile=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hs_process/utilities.html#hstools.get_wavelength"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hs_process.hstools.get_wavelength" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns actual wavelength of the closest target band.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_band</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code> or <code class="docutils literal notranslate"><span class="pre">float</span></code>) -- the target band to retrieve
wavelength number for (required).</p></li>
<li><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object, optional) -- The datacube being accessed and/or
manipulated; if <code class="docutils literal notranslate"><span class="pre">None</span></code>, uses <code class="docutils literal notranslate"><span class="pre">hstools.spyfile</span></code> (default:
<code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>key_wavelength</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>) -- wavelength of the closest
target band (<code class="docutils literal notranslate"><span class="pre">target_band</span></code>).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Use <code class="docutils literal notranslate"><span class="pre">hstools.get_wavelength</span></code> to find the wavelength value corresponding to the <em>151st band</em></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_wavelength</span><span class="p">(</span><span class="mi">151</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
<span class="go">702.52</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="hs_process.hstools.load_spyfile">
<code class="sig-name descname">load_spyfile</code><span class="sig-paren">(</span><em class="sig-param">spyfile</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hs_process/utilities.html#hstools.load_spyfile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hs_process.hstools.load_spyfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a <code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> (Spectral Python object) for data access and/or
manipulation by the <code class="docutils literal notranslate"><span class="pre">hstools</span></code> class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object) -- The datacube being accessed and/or
manipulated.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Load a new datacube using <code class="docutils literal notranslate"><span class="pre">hstools.load_spyfile</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">load_spyfile</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">spyfile</span>
<span class="go">Data Source:   &#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip&#39;</span>
<span class="go">    # Rows:            617</span>
<span class="go">    # Samples:        1300</span>
<span class="go">    # Bands:           240</span>
<span class="go">    Interleave:        BIP</span>
<span class="go">    Quantization:  32 bits</span>
<span class="go">    Data format:   float32</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="hs_process.hstools.mask_array">
<code class="sig-name descname">mask_array</code><span class="sig-paren">(</span><em class="sig-param">array</em>, <em class="sig-param">metadata</em>, <em class="sig-param">thresh=None</em>, <em class="sig-param">percentile=None</em>, <em class="sig-param">side='lower'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hs_process/utilities.html#hstools.mask_array"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hs_process.hstools.mask_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a masked numpy array based on a threshold value. If <code class="docutils literal notranslate"><span class="pre">array</span></code> is
already a masked array, that mask is maintained and the new mask(s) is/
are added to the original mask.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) -- The data array to mask.</p></li>
<li><p><strong>thresh</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code> or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- The value for which to base the
threshold; if <code class="docutils literal notranslate"><span class="pre">thresh</span></code> is <code class="docutils literal notranslate"><span class="pre">list</span></code> and <code class="docutils literal notranslate"><span class="pre">side</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>,
then all values in <code class="docutils literal notranslate"><span class="pre">thresh</span></code> will be masked; if <code class="docutils literal notranslate"><span class="pre">thresh</span></code> is
<code class="docutils literal notranslate"><span class="pre">list</span></code> and <code class="docutils literal notranslate"><span class="pre">side</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, then only the first
value in the list will be considered for thresholding (default:
<code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>percentile</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>) -- The percentile of pixels to mask; if
<code class="docutils literal notranslate"><span class="pre">percentile</span></code> = 95 and <code class="docutils literal notranslate"><span class="pre">side</span></code> = 'lower', the lowest 95% of
pixels will be masked prior to calculating the mean spectra
across pixels (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>; range: 0-100).</p></li>
<li><p><strong>side</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- The side of the threshold for which to apply the
mask. Must be either 'lower', 'upper', or <code class="docutils literal notranslate"><span class="pre">None</span></code>; if 'lower',
everything below the threshold will be masked; if <code class="docutils literal notranslate"><span class="pre">None</span></code>,
only the values that exactly match the threshol will be masked
(default: 'lower').</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>2-element <code class="docutils literal notranslate"><span class="pre">tuple</span></code> containing</p>
<ul class="simple">
<li><p><strong>array_mask</strong> (<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>): The masked <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>
based on the passed threshold and/or percentile value.</p></li>
<li><p><strong>metadata</strong> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>): The modified metadata.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Retrieve the image band at <em>800 nm</em> using <code class="docutils literal notranslate"><span class="pre">hstools.get_band</span></code> and
<code class="docutils literal notranslate"><span class="pre">hsio.spyfile.open_memmap</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">band</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_band</span><span class="p">(</span><span class="mi">800</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">open_memmap</span><span class="p">()[:,</span> <span class="p">:,</span> <span class="n">band</span><span class="p">]</span>
</pre></div>
</div>
<p>Create a masked array of all values below the <em>75th percentile</em>
via <code class="docutils literal notranslate"><span class="pre">hstools.mask_array</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">array_mask</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">mask_array</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span> <span class="n">percentile</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>See that the <em>&quot;history&quot;</em> tage in the <code class="docutils literal notranslate"><span class="pre">metadata</span></code> has been modified</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;history&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">158</span><span class="p">:]</span>
<span class="go">&quot;hs_process.mask_array[&lt;label: &#39;thresh?&#39; value:None; label: &#39;percentile?&#39; value:75; label: &#39;side?&#39; value:lower; label: &#39;unmasked_pct?&#39; value:24.9935170178282&gt;]&quot;</span>
</pre></div>
</div>
<p>Visualize the unmasked array using <code class="docutils literal notranslate"><span class="pre">hsio.show_img</span></code>. Set <code class="docutils literal notranslate"><span class="pre">vmin</span></code>
and <code class="docutils literal notranslate"><span class="pre">vmax</span></code> to ensure the same color scale is used in comparing
the masked vs. unmasked arrays.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">vmin</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vmax</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">show_img</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/mask_array_800nm.png" src="../_images/mask_array_800nm.png" />
<p>Visualize the unmasked array using <code class="docutils literal notranslate"><span class="pre">hsio.show_img</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">show_img</span><span class="p">(</span><span class="n">array_mask</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/mask_array_800nm_75th.png" src="../_images/mask_array_800nm_75th.png" />
</dd></dl>

<dl class="method">
<dt id="hs_process.hstools.mean_datacube">
<code class="sig-name descname">mean_datacube</code><span class="sig-paren">(</span><em class="sig-param">spyfile</em>, <em class="sig-param">mask=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hs_process/utilities.html#hstools.mean_datacube"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hs_process.hstools.mean_datacube" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Calculates the mean spectra for a datcube; if <code class="docutils literal notranslate"><span class="pre">mask</span></code> is passed (as a
<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>), then the mask is applied to <code class="docutils literal notranslate"><span class="pre">spyfile</span></code> prior to
computing the mean spectra.</p>
<dl>
<dt>Parameters:</dt><dd><dl class="simple">
<dt>spyfile (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object or <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>): The</dt><dd><p>hyperspectral datacube to mask.</p>
</dd>
<dt>mask (<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>): the mask to apply to <code class="docutils literal notranslate"><span class="pre">spyfile</span></code>; if</dt><dd><p><code class="docutils literal notranslate"><span class="pre">mask</span></code> does not have similar dimensions to <code class="docutils literal notranslate"><span class="pre">spyfile</span></code>, the
first band (i.e., first two dimensions) of <code class="docutils literal notranslate"><span class="pre">mask</span></code> will be
repeated <em>n</em> times to match the number of bands of <code class="docutils literal notranslate"><span class="pre">spyfile</span></code>
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>3-element <code class="docutils literal notranslate"><span class="pre">tuple</span></code> containing</p>
<ul class="simple">
<li><p><strong>spec_mean</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile.SpyFile</span></code> object): The mean spectra from
the input datacube.</p></li>
<li><p><strong>spec_std</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile.SpyFile</span></code> object): The standard deviation
of the spectra from the input datacube.</p></li>
<li><p><strong>datacube_masked</strong> (<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>): The masked
<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>; if <code class="docutils literal notranslate"><span class="pre">mask</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">datacube_masked</span></code>
is identical to the <code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> data array.</p></li>
</ul>
</dd>
<dt>Example:</dt><dd><p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Retrieve the image band at <em>800 nm</em> using <code class="docutils literal notranslate"><span class="pre">hstools.get_band</span></code> and
<code class="docutils literal notranslate"><span class="pre">hsio.spyfile.open_memmap</span></code>, then mask out all pixels whose value falls
below the <em>75th percentile</em>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">band</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_band</span><span class="p">(</span><span class="mi">800</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">open_memmap</span><span class="p">()[:,</span> <span class="p">:,</span> <span class="n">band</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array_mask</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">mask_array</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span> <span class="n">percentile</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Calculate the spectral mean from the remaining <em>(i.e., unmasked)</em>
pixels using <code class="docutils literal notranslate"><span class="pre">hstools.mean_datacube</span></code>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">spec_mean</span><span class="p">,</span> <span class="n">spec_std</span><span class="p">,</span> <span class="n">datacube_masked</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">mean_datacube</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">array_mask</span><span class="p">)</span>
</pre></div>
</div>
<p>Save using <code class="docutils literal notranslate"><span class="pre">hsio.write_spec</span></code> and <code class="docutils literal notranslate"><span class="pre">hsio.write_cube</span></code>, then load
into Spectronon software for visualization.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fname_hdr_spec</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\hstools\Wells_rep2_20180628_16h56m_pika_gige_7-mean_800nm_75th.spec.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_hdr_cube</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\hstools\Wells_rep2_20180628_16h56m_pika_gige_7-mean_800nm_75th.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">write_spec</span><span class="p">(</span><span class="n">fname_hdr_spec</span><span class="p">,</span> <span class="n">spec_mean</span><span class="p">,</span> <span class="n">spec_std</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">)</span>
<span class="go">Saving F:</span>
</pre></div>
</div>
</dd>
</dl>
</div></blockquote>
<dl>
<dt>igo0024Documentshs_process_demohstoolsWells_rep2_20180628_16h56m_pika_gige_7-mean_800nm_75th.spec</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">write_cube</span><span class="p">(</span><span class="n">fname_hdr_cube</span><span class="p">,</span> <span class="n">datacube_masked</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">)</span>
<span class="go">Saving F:</span>
</pre></div>
</div>
</dd>
</dl>
<p>igo0024Documentshs_process_demohstoolsWells_rep2_20180628_16h56m_pika_gige_7-mean_800nm_75th.bip</p>
<blockquote>
<div><img alt="../_images/mean_datacube.png" src="../_images/mean_datacube.png" />
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="hs_process.hstools.modify_meta_set">
<code class="sig-name descname">modify_meta_set</code><span class="sig-paren">(</span><em class="sig-param">meta_set</em>, <em class="sig-param">idx</em>, <em class="sig-param">value</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hs_process/utilities.html#hstools.modify_meta_set"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hs_process.hstools.modify_meta_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Modifies metadata &quot;set&quot; (i.e., string representation of a Python set;
common in .hdr files) by converting string to list, then adjusts the
value of an item by its index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>meta_set</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- the string representation of the metadata set</p></li>
<li><p><strong>idx</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- index to be modified; if <code class="docutils literal notranslate"><span class="pre">None</span></code>, the whole meta_set is
returned (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>value</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>, <code class="docutils literal notranslate"><span class="pre">int</span></code>, or <code class="docutils literal notranslate"><span class="pre">str</span></code>) -- value to replace at idx</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>set_str</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>): Modified metadata set string.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Retrieve the <em>&quot;map info&quot; set</em> from the metadata via
<code class="docutils literal notranslate"><span class="pre">hstools.get_meta_set</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">map_info_set</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;map info&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">map_info_set</span>
<span class="go">[&#39;UTM&#39;,</span>
<span class="go"> &#39;1.0&#39;,</span>
<span class="go"> &#39;1.0&#39;,</span>
<span class="go"> &#39;441357.287073&#39;,</span>
<span class="go"> &#39;4855944.7717699995&#39;,</span>
<span class="go"> &#39;0.04&#39;,</span>
<span class="go"> &#39;0.04&#39;,</span>
<span class="go"> &#39;15&#39;,</span>
<span class="go"> &#39;T&#39;,</span>
<span class="go"> &#39;WGS-84&#39;,</span>
<span class="go"> &#39;units  meters&#39;,</span>
<span class="go"> &#39;rotation  0.000&#39;]</span>
</pre></div>
</div>
<p>Modify the value at <em>index position 4</em> from <code class="docutils literal notranslate"><span class="pre">4855944.7717699995</span></code>
to <code class="docutils literal notranslate"><span class="pre">441300.2</span></code> using <code class="docutils literal notranslate"><span class="pre">hstools.modify_meta_set</span></code>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">modify_meta_set</span><span class="p">(</span><span class="n">map_info_set</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">441300.2</span><span class="p">)</span>
<span class="go">&#39;{UTM, 1.0, 1.0, 441357.287073, 441300.2, 0.04, 0.04, 15, T, WGS-84, units  meters, rotation  0.000}&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="hs_process.hstools.plot_histogram">
<code class="sig-name descname">plot_histogram</code><span class="sig-paren">(</span><em class="sig-param">array</em>, <em class="sig-param">fname_fig=None</em>, <em class="sig-param">title=None</em>, <em class="sig-param">xlabel=None</em>, <em class="sig-param">percentile=90</em>, <em class="sig-param">bins=50</em>, <em class="sig-param">fontsize=16</em>, <em class="sig-param">color='#444444'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hs_process/utilities.html#hstools.plot_histogram"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hs_process.hstools.plot_histogram" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots a histogram with the percentile value labeled.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) -- The data array used to create the
histogram for; if <code class="docutils literal notranslate"><span class="pre">array</span></code> is masked, the masked pixels are
excluded from the histogram.</p></li>
<li><p><strong>fname_fig</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>, optional) -- The filename to save the figure to;
if <code class="docutils literal notranslate"><span class="pre">None</span></code>, the figure will not be saved (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>title</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>, optional) -- The plot title (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>xlabel</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>, optional) -- The x-axis label of the histogram
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>percentile</strong> (<code class="docutils literal notranslate"><span class="pre">scalar</span></code>, optional) -- The percentile to label and
illustrate on the histogram; if <code class="docutils literal notranslate"><span class="pre">percentile</span></code> = 90, the
band/spectral index value at the 90th percentile will be
labeled on the plot (default: 90; range: 0-100).</p></li>
<li><p><strong>bins</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, optional) -- Number of histogram bins (default: 50).</p></li>
<li><p><strong>fontsize</strong> (<code class="docutils literal notranslate"><span class="pre">scalar</span></code>) -- Font size of the axes labels. The title and
text annotations will be scaled relatively (default: 16).</p></li>
<li><p><strong>color</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>, optional) -- Color of the histogram columns (default:
&quot;#444444&quot;)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Figure object showing the histogram.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>fig (<code class="docutils literal notranslate"><span class="pre">matplotlib.figure</span></code>)</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Retrieve the image band at <em>800 nm</em> using <code class="docutils literal notranslate"><span class="pre">hstools.get_band</span></code> and
<code class="docutils literal notranslate"><span class="pre">hsio.spyfile.open_memmap</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">band</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_band</span><span class="p">(</span><span class="mi">800</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">open_memmap</span><span class="p">()[:,</span> <span class="p">:,</span> <span class="n">band</span><span class="p">]</span>
</pre></div>
</div>
<p>Create a masked array of all values below the <em>5th percentile</em>
via <code class="docutils literal notranslate"><span class="pre">hstools.mask_array</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">array_mask</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">mask_array</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span> <span class="n">percentile</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Visualize the histogram of the unmasked pixels (i.e., those greater
than the 5th percentile) using <code class="docutils literal notranslate"><span class="pre">hstools.plot_histogram</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Reflectance at 800 nm&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;Reflectance (%)&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">plot_histogram</span><span class="p">(</span><span class="n">array_mask</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">xlabel</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/plot_histogram_800nm.png" src="../_images/plot_histogram_800nm.png" />
</dd></dl>

</dd></dl>

</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2020, Tyler J. Nigon.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.3.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>