<!DOCTYPE html>

<html lang="python">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>hs_process package &#8212; hs_process 0.0.4 documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          hs_process</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="https://github.com/tnigon/hs_process">Github</a></li>
                <li><a href="https://anaconda.org/conda-forge/hs-process">Download</a></li>
                <li><a href="http://www.spectralpython.net/">Spectral Python</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Contents <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">Home</a><ul>
<li class="toctree-l2"><a class="reference internal" href="installation.html">1. Setup and Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_hsio.html">2. Tutorial: <code class="docutils literal notranslate"><span class="pre">hsio</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_hstools.html">3. Tutorial: <code class="docutils literal notranslate"><span class="pre">hstools</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_segment.html">4. Tutorial: <code class="docutils literal notranslate"><span class="pre">segment</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_spec_mod.html">5. Tutorial: <code class="docutils literal notranslate"><span class="pre">spec_mod</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_spatial_mod.html">6. Tutorial: <code class="docutils literal notranslate"><span class="pre">spatial_mod</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_batch.html">7. Tutorial: <code class="docutils literal notranslate"><span class="pre">batch</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="my_hs_process_api.html">8. API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api/hs_process.batch.html">8.1.1. batch</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/hs_process.defaults.html">8.1.2. defaults</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/hs_process.hsio.html">8.1.3. hsio</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/hs_process.hstools.html">8.1.4. hstools</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/hs_process.segment.html">8.1.5. segment</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/hs_process.spatial_mod.html">8.1.6. spatial_mod</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/hs_process.spec_mod.html">8.1.7. spec_mod</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="license.html">9. License</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html">10. Change Log</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">1. Setup and Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_hsio.html">2. Tutorial: <code class="docutils literal notranslate"><span class="pre">hsio</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_hstools.html">3. Tutorial: <code class="docutils literal notranslate"><span class="pre">hstools</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_segment.html">4. Tutorial: <code class="docutils literal notranslate"><span class="pre">segment</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_spec_mod.html">5. Tutorial: <code class="docutils literal notranslate"><span class="pre">spec_mod</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_spatial_mod.html">6. Tutorial: <code class="docutils literal notranslate"><span class="pre">spatial_mod</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_batch.html">7. Tutorial: <code class="docutils literal notranslate"><span class="pre">batch</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="my_hs_process_api.html">8. API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/hs_process.batch.html">8.1.1. batch</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/hs_process.defaults.html">8.1.2. defaults</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/hs_process.hsio.html">8.1.3. hsio</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/hs_process.hstools.html">8.1.4. hstools</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/hs_process.segment.html">8.1.5. segment</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/hs_process.spatial_mod.html">8.1.6. spatial_mod</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/hs_process.spec_mod.html">8.1.7. spec_mod</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="license.html">9. License</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">10. Change Log</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="_sources/hs_process.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">hs_process package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-hs_process.batch">hs_process.batch module</a></li>
<li><a class="reference internal" href="#module-hs_process.segment">hs_process.segment module</a></li>
<li><a class="reference internal" href="#module-hs_process.spatial_mod">hs_process.spatial_mod module</a></li>
<li><a class="reference internal" href="#module-hs_process.spec_mod">hs_process.spec_mod module</a></li>
<li><a class="reference internal" href="#module-hs_process.utilities">hs_process.utilities module</a></li>
<li><a class="reference internal" href="#module-hs_process">Module contents</a></li>
</ul>
</li>
</ul>

<form action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="body col-md-9 content" role="main">
      
  <div class="section" id="hs-process-package">
<h1>hs_process package<a class="headerlink" href="#hs-process-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-hs_process.batch">
<span id="hs-process-batch-module"></span><h2>hs_process.batch module<a class="headerlink" href="#module-hs_process.batch" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="hs_process.batch.batch">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hs_process.batch.</span></code><code class="sig-name descname"><span class="pre">batch</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.bip'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lock</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress_bar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/batch.html#batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.batch.batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for batch processing hyperspectral image data. Makes use of
<a class="reference external" href="hs_process.segment.html">segment</a>, <a class="reference external" href="hs_process.spatial_mod.html">spatial_mod</a>, and <a class="reference external" href="hs_process.spec_mod.html">spec_mod</a> to batch process many
datacubes in a given directory. Supports options to save full
datacubes, geotiff renders, as well as summary statistics and/or
reports for the various tools.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It may be a good idea to review and understand the <a class="reference external" href="hs_process.defaults.html">defaults</a>,
<a class="reference external" href="hs_process.hsio.html">hsio</a>, <a class="reference external" href="hs_process.hstools.html">hstools</a>, <a class="reference external" href="hs_process.segment.html">segment</a>, <a class="reference external" href="hs_process.spatial_mod.html">spatial_mod</a>, and <a class="reference external" href="hs_process.spec_mod.html">spec_mod</a>
classes prior to using the <code class="docutils literal notranslate"><span class="pre">batch</span></code> module.</p>
</div>
<dl class="py method">
<dt id="hs_process.batch.batch.cube_to_spectra">
<code class="sig-name descname"><span class="pre">cube_to_spectra</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bip'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cube_to_spec'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_append</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cube-to-spec'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_geotiff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_interleave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_byteorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/batch.html#batch.cube_to_spectra"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.batch.batch.cube_to_spectra" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the mean and standard deviation for each cube in
<code class="docutils literal notranslate"><span class="pre">fname_list</span></code> and writes the result to a &quot;.spec&quot; file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname_list</strong> (<code class="docutils literal notranslate"><span class="pre">list</span></code>, optional) -- list of filenames to process; if
left to <code class="docutils literal notranslate"><span class="pre">None</span></code>, will look at <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>, <code class="docutils literal notranslate"><span class="pre">search_ext</span></code>, and
<code class="docutils literal notranslate"><span class="pre">dir_level</span></code> parameters for files to process (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>base_dir</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>, optional) -- directory path to search for files to
spectrally clip; if <code class="docutils literal notranslate"><span class="pre">fname_list</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">base_dir</span></code> will
be ignored (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>search_ext</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- file format/extension to search for in all
directories and subdirectories to determine which files to
process; if <code class="docutils literal notranslate"><span class="pre">fname_list</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">search_ext</span></code> will
be ignored (default: 'bip').</p></li>
<li><p><strong>dir_level</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- The number of directory levels to search; if
<code class="docutils literal notranslate"><span class="pre">None</span></code>, searches all directory levels (default: 0).</p></li>
<li><p><strong>base_dir_out</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- directory path to save all processed
spectra; if set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, a folder named according to the
<code class="docutils literal notranslate"><span class="pre">folder_name</span></code> parameter is added to <code class="docutils literal notranslate"><span class="pre">base_dir</span></code></p></li>
<li><p><strong>folder_name</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- folder to add to <code class="docutils literal notranslate"><span class="pre">base_dir_out</span></code> to save all
the processed datacubes (default: 'cube_to_spec').</p></li>
<li><p><strong>name_append</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- name to append to the filename (default:
'cube-to-spec').</p></li>
<li><p><strong>write_geotiff</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- whether to save the masked RGB image as a
geotiff alongside the masked datacube.</p></li>
<li><p><strong>out_XXX</strong> -- Settings for saving the output files can be adjusted here
if desired. They are stored in <code class="docutils literal notranslate"><span class="pre">batch.io.defaults</span></code>, and are
therefore accessible at a high level. See
<code class="docutils literal notranslate"><span class="pre">hsio.set_io_defaults()</span></code> for more information on each of the
settings.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following <code class="docutils literal notranslate"><span class="pre">batch</span></code> example builds on the API example results
of the <a class="reference external" href="hs_process.spatial_mod.html#hs_process.spatial_mod.crop_many_gdf">spatial_mod.crop_many_gdf</a> function. Please complete the
<a class="reference external" href="hs_process.spatial_mod.html#hs_process.spatial_mod.crop_many_gdf">spatial_mod.crop_many_gdf</a> example to be sure your directory
(i.e., <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>) is populated with multiple hyperspectral
datacubes. The following example will be using datacubes located in
the following directory:
<code class="docutils literal notranslate"><span class="pre">F:\nigo0024\Documents\hs_process_demo\spatial_mod\crop_many_gdf</span></code></p>
</div>
<p class="rubric">Example</p>
<p>Load and initialize the <code class="docutils literal notranslate"><span class="pre">batch</span></code> module, checking to be sure the
directory exists.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">batch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;spatial_mod&#39;</span><span class="p">,</span> <span class="s1">&#39;crop_many_gdf&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">base_dir</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span> <span class="o">=</span> <span class="n">batch</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">search_ext</span><span class="o">=</span><span class="s1">&#39;.bip&#39;</span><span class="p">,</span> <span class="n">progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># searches for all files in ``base_dir`` with a &quot;.bip&quot; file extension</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Use <code class="docutils literal notranslate"><span class="pre">batch.cube_to_spectra</span></code> to calculate the <em>mean</em> and <em>standard
deviation</em> across all pixels for each of the datacubes in
<code class="docutils literal notranslate"><span class="pre">base_dir</span></code>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span><span class="o">.</span><span class="n">cube_to_spectra</span><span class="p">(</span><span class="n">base_dir</span><span class="o">=</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">write_geotiff</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">out_force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Processing file 39/40: 100%|██████████| 40/40 [00:03&lt;00:00, 13.28it/s]------------------------------------------------| 0.0%</span>
</pre></div>
</div>
<p>Use <code class="docutils literal notranslate"><span class="pre">seaborn</span></code> to visualize the spectra of plots 1011, 1012, and
1013. Notice how <code class="docutils literal notranslate"><span class="pre">hsbatch.io.name_plot</span></code> is utilized to retrieve
the plot ID, and how the <em>&quot;history&quot;</em> tag is referenced from the
metadata to determine the number of pixels whose reflectance was
averaged to create the mean spectra. Also remember that pixels
across the original input image likely represent a combination of
soil, vegetation, and shadow.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">re</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s1">&#39;cube_to_spec&#39;</span><span class="p">,</span> <span class="s1">&#39;Wells_rep2_20180628_16h56m_pika_gige_7_plot_1011-cube-to-spec-mean.spec&#39;</span><span class="p">),</span>
<span class="go">                  os.path.join(base_dir, &#39;cube_to_spec&#39;, &#39;Wells_rep2_20180628_16h56m_pika_gige_7_plot_1012-cube-to-spec-mean.spec&#39;),</span>
<span class="go">                  os.path.join(base_dir, &#39;cube_to_spec&#39;, &#39;Wells_rep2_20180628_16h56m_pika_gige_7_plot_1013-cube-to-spec-mean.spec&#39;)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">fname</span> <span class="ow">in</span> <span class="n">fname_list</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_spec</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">meta_bands</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">meta_bands</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">data</span> <span class="o">=</span> <span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile_spec</span><span class="o">.</span><span class="n">load</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">hist</span> <span class="o">=</span> <span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile_spec</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;history&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pix_n</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;&lt;pixel number: (.*)&gt;&#39;</span><span class="p">,</span> <span class="n">hist</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Plot &#39;</span><span class="o">+</span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">name_plot</span><span class="o">+</span><span class="s1">&#39; (n=&#39;</span><span class="o">+</span><span class="n">pix_n</span><span class="o">+</span><span class="s1">&#39;)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">else</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Plot &#39;</span><span class="o">+</span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">name_plot</span><span class="o">+</span><span class="s1">&#39; (n=&#39;</span><span class="o">+</span><span class="n">pix_n</span><span class="o">+</span><span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavelength (nm)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Reflectance (%)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;API Example: `batch.cube_to_spectra`&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../img/batch/cube_to_spectra.png" src="../img/batch/cube_to_spectra.png" />
</dd></dl>

<dl class="py method">
<dt id="hs_process.batch.batch.segment_band_math">
<code class="sig-name descname"><span class="pre">segment_band_math</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bip'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'band_math'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_append</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'band-math'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_geotiff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ndi'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wl1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wl2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wl3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">list_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_interleave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_byteorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/batch.html#batch.segment_band_math"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.batch.batch.segment_band_math" title="Permalink to this definition">¶</a></dt>
<dd><p>Batch processing tool to perform band math on multiple datacubes in the
same way. <code class="docutils literal notranslate"><span class="pre">batch.segment_band_math</span></code> is typically used prior to
<code class="docutils literal notranslate"><span class="pre">batch.segment_create_mask</span></code> to generate the images/directory required
for the masking process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- Must be one of &quot;ndi&quot; (normalized difference
index), &quot;ratio&quot; (simple ratio index), &quot;derivative&quot;
(deriviative-type index), or &quot;mcari2&quot; (modified chlorophyll
absorption index2). Indicates what kind of band math should be
performed on the input datacube. The &quot;ndi&quot; method leverages
<code class="docutils literal notranslate"><span class="pre">segment.band_math_ndi()</span></code>, the &quot;ratio&quot; method leverages
<code class="docutils literal notranslate"><span class="pre">segment.band_math_ratio()</span></code>, and the &quot;derivative&quot; method
leverages <code class="docutils literal notranslate"><span class="pre">segment.band_math_derivative()</span></code>. Please see the
<code class="docutils literal notranslate"><span class="pre">segment</span></code> documentation for more information (default:
&quot;ndi&quot;).</p></li>
<li><p><strong>wl1</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the wavelength (or set of
wavelengths) to be used as the first parameter of the
band math index; if <code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all
bands between two wavelength values by calculating the mean
pixel value across all bands in that range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>wl2</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the wavelength (or set of
wavelengths) to be used as the second parameter of the
band math index; if <code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all
bands between two wavelength values by calculating the mean
pixel value across all bands in that range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>b1</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the band (or set of bands) to be
used as the first parameter of the band math index;
if <code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all bands between two band values
by calculating the mean pixel value across all bands in that
range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>b2</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the band (or set of bands) to be
used as the second parameter of the band math
index; if <code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all bands between two band
values by calculating the mean pixel value across all bands in
that range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>list_range</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- Whether bands/wavelengths passed as a list is
interpreted as a range of bands (<code class="docutils literal notranslate"><span class="pre">True</span></code>) or for each individual
band in the list (<code class="docutils literal notranslate"><span class="pre">False</span></code>). If <code class="docutils literal notranslate"><span class="pre">list_range</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>,
<code class="docutils literal notranslate"><span class="pre">b1</span></code>/<code class="docutils literal notranslate"><span class="pre">wl1</span></code> and <code class="docutils literal notranslate"><span class="pre">b2</span></code>/<code class="docutils literal notranslate"><span class="pre">wl2</span></code> should be lists with two items, and
all bands/wavelegths between the two values will be used
(default: <code class="docutils literal notranslate"><span class="pre">True</span></code>).</p></li>
<li><p><strong>plot_out</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- whether to save a histogram of the band math
result (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>).</p></li>
<li><p><strong>write_geotiff</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- whether to save the masked RGB image as a
geotiff alongside the masked datacube.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following <code class="docutils literal notranslate"><span class="pre">batch</span></code> example builds on the API example results
of the <a class="reference external" href="hs_process.spatial_mod.html#hs_process.spatial_mod.crop_many_gdf">spatial_mod.crop_many_gdf</a> function. Please complete the
<a class="reference external" href="hs_process.spatial_mod.html#hs_process.spatial_mod.crop_many_gdf">spatial_mod.crop_many_gdf</a> example to be sure your directory
(i.e., <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>) is populated with multiple hyperspectral
datacubes. The following example will be using datacubes located in
the following directory:
<code class="docutils literal notranslate"><span class="pre">F:\nigo0024\Documents\hs_process_demo\spatial_mod\crop_many_gdf</span></code></p>
</div>
<p class="rubric">Example</p>
<p>Load and initialize the <code class="docutils literal notranslate"><span class="pre">batch</span></code> module, checking to be sure the
directory exists.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">batch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\spatial_mod\crop_many_gdf&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">base_dir</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span> <span class="o">=</span> <span class="n">batch</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">search_ext</span><span class="o">=</span><span class="s1">&#39;.bip&#39;</span><span class="p">)</span>  <span class="c1"># searches for all files in ``base_dir`` with a &quot;.bip&quot; file extension</span>
</pre></div>
</div>
<p>Use <code class="docutils literal notranslate"><span class="pre">batch.segment_band_math</span></code> to compute the MCARI2 (Modified
Chlorophyll Absorption Ratio Index Improved; Haboudane et al.,
2004) spectral index for each of the datacubes in <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>. See
<a class="reference external" href="https://www.harrisgeospatial.com/docs/NarrowbandGreenness.html#Modified3">Harris Geospatial</a> for more information about the MCARI2 spectral
index and references to other spectral indices.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">folder_name</span> <span class="o">=</span> <span class="s1">&#39;band_math_mcari2-800-670-550&#39;</span>  <span class="c1"># folder name can be modified to be more descriptive in what type of band math is being performed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;mcari2&#39;</span>  <span class="c1"># must be one of &quot;ndi&quot;, &quot;ratio&quot;, &quot;derivative&quot;, or &quot;mcari2&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wl1</span> <span class="o">=</span> <span class="mi">800</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wl2</span> <span class="o">=</span> <span class="mi">670</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wl3</span> <span class="o">=</span> <span class="mi">550</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span><span class="o">.</span><span class="n">segment_band_math</span><span class="p">(</span><span class="n">base_dir</span><span class="o">=</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">folder_name</span><span class="o">=</span><span class="n">folder_name</span><span class="p">,</span>
<span class="go">                              name_append=&#39;band-math&#39;, write_geotiff=True,</span>
<span class="go">                              method=method, wl1=wl1, wl2=wl2, wl3=wl3,</span>
<span class="go">                              plot_out=True, out_force=True)</span>
<span class="go">Bands used (``b1``): [198]</span>
<span class="go">Bands used (``b2``): [135]</span>
<span class="go">Bands used (``b3``): [77]</span>
<span class="go">Wavelengths used (``b1``): [799.0016]</span>
<span class="go">Wavelengths used (``b2``): [669.6752]</span>
<span class="go">Wavelengths used (``b3``): [550.6128]</span>
<span class="go">Saving F:\nigo0024\Documents\hs_process_demo\spatial_mod\crop_many_gdfand_math_mcari2-800-670-550\Wells_rep2_20180628_16h56m_pika_gige_7_plot_1011-band-math-mcari2-800-670-550.bip</span>
<span class="gp">...</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">batch.segment_band_math</span></code> creates a new folder in <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>
(in this case the new directory is
<code class="docutils literal notranslate"><span class="pre">F:\nigo0024\Documents\hs_process_demo\spatial_mod\crop_many_gdfand_math_mcari2-800-670-550</span></code>)
which contains several data products. The <strong>first</strong> is
<code class="docutils literal notranslate"><span class="pre">band-math-stats.csv</span></code>: a spreadsheet containing summary
statistics for each of the image cubes that were processed via
<code class="docutils literal notranslate"><span class="pre">batch.segment_band_math</span></code>; stats include <em>pixel count</em>,
<em>mean</em>, <em>standard deviation</em>, <em>median</em>, and <em>percentiles</em> across
all image pixels.</p>
<p><strong>Second</strong> is a <code class="docutils literal notranslate"><span class="pre">geotiff</span></code> file for each of the image cubes after the
band math processing. This can be opened in <em>QGIS</em> to visualize in
a spatial reference system, or can be opened using any software
that supports floating point <em>.tif</em> files.</p>
<img alt="../img/batch/segment_band_math_plot_611-band-math-mcari2-800-670-550_tif.png" src="../img/batch/segment_band_math_plot_611-band-math-mcari2-800-670-550_tif.png" />
<p><strong>Third</strong> is the band math raster saved in the <em>.hdr</em> file format.
Note that the data conained here should be the same as in the
<em>.tif</em> file, so it's a matter of preference as to what may be more
useful. This single band <em>.hdr</em> can also be opend in <em>QGIS</em>.</p>
<p><strong>Fourth</strong> is a histogram of the band math data contained in the
image. The histogram illustrates the 90th percentile value, which
may be useful in the segmentation step (e.g., see
<a class="reference external" href="hs_process.batch.html#hs_process.batch.segment_create_mask">batch.segment_create_mask</a>).</p>
<img alt="../img/batch/segment_band_math_plot_611-band-math-mcari2-800-670-550.png" src="../img/batch/segment_band_math_plot_611-band-math-mcari2-800-670-550.png" />
</dd></dl>

<dl class="py method">
<dt id="hs_process.batch.batch.segment_composite_band">
<code class="sig-name descname"><span class="pre">segment_composite_band</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bip'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'composite_band'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_append</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'composite-band'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_geotiff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wl1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">list_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_interleave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_byteorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/batch.html#batch.segment_composite_band"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.batch.batch.segment_composite_band" title="Permalink to this definition">¶</a></dt>
<dd><p>Batch processing tool to create a composite band on multiple datacubes
in the same way. <code class="docutils literal notranslate"><span class="pre">batch.segment_composite_band</span></code> is typically used
prior to  <code class="docutils literal notranslate"><span class="pre">batch.segment_create_mask</span></code> to generate the
images/directory required for the masking process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wl1</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the wavelength (or set of
wavelengths) to be used as the first parameter of the
band math index; if <code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all
bands between two wavelength values by calculating the mean
pixel value across all bands in that range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>b1</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the band (or set of bands)
to be used as the first parameter of the band math index; if
<code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all bands between two band values
by calculating the mean pixel value across all bands in that
range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>list_range</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- Whether bands/wavelengths passed as a list
is interpreted as a range of bands (<code class="docutils literal notranslate"><span class="pre">True</span></code>) or for each
individual band in the list (<code class="docutils literal notranslate"><span class="pre">False</span></code>). If <code class="docutils literal notranslate"><span class="pre">list_range</span></code> is
<code class="docutils literal notranslate"><span class="pre">True</span></code>, <code class="docutils literal notranslate"><span class="pre">b1</span></code>/<code class="docutils literal notranslate"><span class="pre">wl1</span></code> and <code class="docutils literal notranslate"><span class="pre">b2</span></code>/<code class="docutils literal notranslate"><span class="pre">wl2</span></code> should be lists
with two items, and all bands/wavelegths between the two values
will be used (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>).</p></li>
<li><p><strong>plot_out</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- whether to save a histogram of the band math
result (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>).</p></li>
<li><p><strong>write_geotiff</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- whether to save the masked RGB image as a
geotiff alongside the masked datacube.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hs_process.batch.batch.segment_create_mask">
<code class="sig-name descname"><span class="pre">segment_create_mask</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bip'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mask'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_append</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mask'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_datacube</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_spec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_geotiff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_percentile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_side</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lower'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_interleave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_byteorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/batch.html#batch.segment_create_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.batch.batch.segment_create_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Batch processing tool to create a masked array on many datacubes.
<code class="docutils literal notranslate"><span class="pre">batch.segment_create_mask</span></code> is typically used after
<code class="docutils literal notranslate"><span class="pre">batch.segment_band_math</span></code> to mask all the datacubes in a directory
based on the result of the band math process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mask_thresh</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code> or <code class="docutils literal notranslate"><span class="pre">int</span></code>) -- The value for which to mask the
array; should be used with <code class="docutils literal notranslate"><span class="pre">side</span></code> parameter (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>mask_percentile</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code> or <code class="docutils literal notranslate"><span class="pre">int</span></code>) -- The percentile of pixels to
mask; if <code class="docutils literal notranslate"><span class="pre">percentile``=95</span> <span class="pre">and</span> <span class="pre">``side``='lower',</span> <span class="pre">the</span> <span class="pre">lowest</span> <span class="pre">95%</span> <span class="pre">of</span>
<span class="pre">pixels</span> <span class="pre">will</span> <span class="pre">be</span> <span class="pre">masked</span> <span class="pre">following</span> <span class="pre">the</span> <span class="pre">band</span> <span class="pre">math</span> <span class="pre">operation</span>
<span class="pre">(default:</span> <span class="pre">``None</span></code>; range: 0-100).</p></li>
<li><p><strong>mask_side</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- The side of the threshold for which to apply the
mask. Must be either 'lower', 'upper', 'outside', or <code class="docutils literal notranslate"><span class="pre">None</span></code>;
if 'lower', everything below the threshold will be masked; if
'outside', the <code class="docutils literal notranslate"><span class="pre">thresh</span></code> / <code class="docutils literal notranslate"><span class="pre">percentile</span></code> parameter must be
list-like with two values indicating the lower and upper bounds
- anything outside of these values will be masked out; if
<code class="docutils literal notranslate"><span class="pre">None</span></code>, only the values that exactly match the threshold will
be masked (default: 'lower').</p></li>
<li><p><strong>geotiff</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- whether to save the masked RGB image as a geotiff
alongside the masked datacube.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following <code class="docutils literal notranslate"><span class="pre">batch</span></code> example builds on the API example results
of <a class="reference external" href="hs_process.spatial_mod.html#hs_process.spatial_mod.crop_many_gdf">spatial_mod.crop_many_gdf</a> and <a class="reference external" href="hs_process.batch.html#hs_process.batch.segment_band_math">batch.segment_band_math</a>.
Please complete each of those API examples to be sure your
directories (i.e., <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>, and <code class="docutils literal notranslate"><span class="pre">mask_dir</span></code>) are populated
with image files. The following example will be masking datacubes
located in:
<code class="docutils literal notranslate"><span class="pre">F:\nigo0024\Documents\hs_process_demo\spatial_mod\crop_many_gdf</span></code>
based on MCARI2 images located in:
<code class="docutils literal notranslate"><span class="pre">F:\nigo0024\Documents\hs_process_demo\spatial_mod\crop_many_gdf\band_math_mcari2-800-670-550</span></code></p>
</div>
<p class="rubric">Example</p>
<p>Load and initialize the <code class="docutils literal notranslate"><span class="pre">batch</span></code> module, ensuring <code class="docutils literal notranslate"><span class="pre">base_dir</span></code> is
a valid directory</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">batch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\spatial_mod\crop_many_gdf&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">base_dir</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span> <span class="o">=</span> <span class="n">batch</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">search_ext</span><span class="o">=</span><span class="s1">&#39;.bip&#39;</span><span class="p">)</span>  <span class="c1"># searches for all files in ``base_dir`` with a &quot;.bip&quot; file extension</span>
</pre></div>
</div>
<p>There must be a single-band image that will be used to determine
which datacube pixels are to be masked (determined via the
<code class="docutils literal notranslate"><span class="pre">mask_dir</span></code> parameter). Point to the directory that contains the
MCARI2 images.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mask_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s1">&#39;band_math_mcari2-800-670-550&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">mask_dir</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Indicate how the MCARI2 images should be used to determine which
hyperspectal pixels are to be masked. The available parameters for
controlling this are <code class="docutils literal notranslate"><span class="pre">mask_thresh</span></code>, <code class="docutils literal notranslate"><span class="pre">mask_percentile</span></code>, and
<code class="docutils literal notranslate"><span class="pre">mask_side</span></code>. We will mask out all pixels that fall below the
MCARI2 90th percentile.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mask_percentile</span> <span class="o">=</span> <span class="mi">90</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask_side</span> <span class="o">=</span> <span class="s1">&#39;lower&#39;</span>
</pre></div>
</div>
<p>Finally, indicate the folder to save the masked datacubes and
perform the batch masking via <code class="docutils literal notranslate"><span class="pre">batch.segment_create_mask</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">folder_name</span> <span class="o">=</span> <span class="s1">&#39;mask_mcari2_90th&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span><span class="o">.</span><span class="n">segment_create_mask</span><span class="p">(</span><span class="n">base_dir</span><span class="o">=</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">mask_dir</span><span class="o">=</span><span class="n">mask_dir</span><span class="p">,</span>
<span class="go">                                folder_name=folder_name,</span>
<span class="go">                                name_append=&#39;mask-mcari2-90th&#39;, write_geotiff=True,</span>
<span class="go">                                mask_percentile=mask_percentile,</span>
<span class="go">                                mask_side=mask_side)</span>
<span class="go">Saving F:\nigo0024\Documents\hs_process_demo\spatial_mod\crop_many_gdf\mask_mcari2_90th\Wells_rep2_20180628_16h56m_pika_gige_7_plot_1011-mask-mcari2-90th.bip</span>
<span class="go">Saving F:\nigo0024\Documents\hs_process_demo\spatial_mod\crop_many_gdf\mask_mcari2_90th\Wells_rep2_20180628_16h56m_pika_gige_7_plot_1011-mask-mcari2-90th-spec-mean.spec</span>
<span class="gp">...</span>
</pre></div>
</div>
<img alt="../img/batch/segment_create_mask_inline.png" src="../img/batch/segment_create_mask_inline.png" />
<p><code class="docutils literal notranslate"><span class="pre">batch.segment_create_mask</span></code> creates a new folder in <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>
named according to the <code class="docutils literal notranslate"><span class="pre">folder_name</span></code> parameter
(in this case the new directory is
<code class="docutils literal notranslate"><span class="pre">F:\nigo0024\Documents\hs_process_demo\spatial_mod\crop_many_gdf\mask_mcari2_90th</span></code>)
which contains several data products. The <strong>first</strong> is
<code class="docutils literal notranslate"><span class="pre">mask-stats.csv</span></code>: a spreadsheet containing the band math
threshold value for each image file. In this example, the MCARI2
value corresponding to the 90th percentile is listed.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 32%" />
<col style="width: 32%" />
<col style="width: 35%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>fname</p></th>
<th class="head"><p>plot_id</p></th>
<th class="head"><p>lower-pctl-90</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>...</p></td>
<td><p>1011</p></td>
<td><p>0.83222</p></td>
</tr>
<tr class="row-odd"><td><p>...</p></td>
<td><p>1012</p></td>
<td><p>0.81112</p></td>
</tr>
<tr class="row-even"><td><p>...</p></td>
<td><p>1013</p></td>
<td><p>0.74394</p></td>
</tr>
</tbody>
</table>
<p>...etc.</p>
<p><strong>Second</strong> is a <code class="docutils literal notranslate"><span class="pre">geotiff</span></code> file for each of the image cubes after the
masking procedure. This can be opened in <em>QGIS</em> to visualize in
a spatial reference system, or can be opened using any software
that supports floating point <em>.tif</em> files. The masked pixels are
saved as <code class="docutils literal notranslate"><span class="pre">null</span></code> values and should render transparently.</p>
<img alt="../img/batch/segment_create_mask_geotiff.png" src="../img/batch/segment_create_mask_geotiff.png" />
<p><strong>Third</strong> is the full hyperspectral datacube, also with the masked
pixels saved as <code class="docutils literal notranslate"><span class="pre">null</span></code> values. Note that the only pixels
remaining are the 10% with the highest MCARI2 values.</p>
<img alt="../img/batch/segment_create_mask_datacube.png" src="../img/batch/segment_create_mask_datacube.png" />
<p><strong>Fourth</strong> is the mean spectra across the unmasked datacube pixels.
This is illustrated above by the green line plot (the light green
shadow represents the standard deviation for each band).</p>
</dd></dl>

<dl class="py method">
<dt id="hs_process.batch.batch.spatial_crop">
<code class="sig-name descname"><span class="pre">spatial_crop</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname_sheet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bip'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spatial_crop'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_append</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spatial-crop'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_geotiff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'single'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gdf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_interleave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_byteorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/batch.html#batch.spatial_crop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.batch.batch.spatial_crop" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterates through a spreadsheet that provides necessary information
about how each image should be cropped and how it should be saved.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">gdf</span></code> is passed (a geopandas.GoeDataFrame polygon file), the
cropped images will be shifted to the center of appropriate 'plot_id'
polygon.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname_sheet</strong> (<code class="docutils literal notranslate"><span class="pre">fname</span></code>, <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>, or <code class="docutils literal notranslate"><span class="pre">None</span></code>, optional) -- The filename of the spreadsheed that provides the
necessary information for fine-tuning the batch process
cropping. See below for more information about the required and
optional contents of <code class="docutils literal notranslate"><span class="pre">fname_sheet</span></code> and how to properly format
it. Optionally, <code class="docutils literal notranslate"><span class="pre">fname_sheet</span></code> can be a <code class="docutils literal notranslate"><span class="pre">Pandas.DataFrame</span></code>.
If left to <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">base_dir</span></code> and <code class="docutils literal notranslate"><span class="pre">gdf</span></code> must be passed.</p></li>
<li><p><strong>base_dir</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>, optional) -- directory path to search for files to
spatially crop; if <code class="docutils literal notranslate"><span class="pre">fname_sheet</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>,
<code class="docutils literal notranslate"><span class="pre">base_dir</span></code> will be ignored (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>base_dir_out</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>, optional) -- output directory of the cropped
image (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>folder_name</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>, optional) -- folder to add to <code class="docutils literal notranslate"><span class="pre">base_dir_out</span></code>
to save all the processed datacubes (default: 'spatial_crop').</p></li>
<li><p><strong>name_append</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>, optional) -- name to append to the filename
(default: 'spatial-crop').</p></li>
<li><p><strong>write_geotiff</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>, optional) -- whether to save an RGB image as
a geotiff alongside the cropped datacube.</p></li>
<li><p><strong>method</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>, optional) -- Must be one of &quot;single&quot; or
&quot;many_gdf&quot;. Indicates whether a single plot should be cropped
from the input datacube or if many/multiple plots should be
cropped from the input datacube. The &quot;single&quot; method leverages
<a class="reference external" href="hs_process.spatial_mod.html#hs_process.spatial_mod.crop_single">spatial_mod.crop_single()</a> and the &quot;many_gdf&quot; method
leverages <a class="reference external" href="hs_process.spatial_mod.html#hs_process.spatial_mod.crop_many_gdf">spatial_mod.crop_many_gdf()</a>. Please
see the <code class="docutils literal notranslate"><span class="pre">spatial_mod</span></code> documentation for more information
(default: &quot;single&quot;).</p></li>
<li><p><strong>gdf</strong> (<code class="docutils literal notranslate"><span class="pre">geopandas.GeoDataFrame</span></code>, optional) -- the plot names and
polygon geometery of each of the plots; 'plot_id' must be used as
a column name to identify each of the plots, and should be an
integer.</p></li>
<li><p><strong>out_XXX</strong> -- Settings for saving the output files can be adjusted here
if desired. They are stored in <code class="docutils literal notranslate"><span class="pre">batch.io.defaults</span></code>, and are
therefore accessible at a high level. See
<a class="reference external" href="hs_process.hsio.html#hs_process.hsio.set_io_defaults">hsio.set_io_defaults()</a> for more information on each of the
settings.</p></li>
</ul>
</dd>
</dl>
<p><strong>Tips and Tricks for</strong> <code class="docutils literal notranslate"><span class="pre">fname_sheet</span></code> <strong>when</strong> <code class="docutils literal notranslate"><span class="pre">gdf</span></code> <strong>is not passed</strong></p>
<p>If <code class="docutils literal notranslate"><span class="pre">gdf</span></code> is not passed, <code class="docutils literal notranslate"><span class="pre">fname_sheet</span></code> may have the following
required column headings that correspond to the relevant parameters in
<a class="reference external" href="hs_process.spatial_mod.html#hs_process.spatial_mod.crop_single">spatial_mod.crop_single()</a> and <a class="reference external" href="hs_process.spatial_mod.html#hs_process.spatial_mod.crop_many_gdf">spatial_mod.crop_many_gdf()</a>:</p>
<ol class="arabic simple">
<li><p>&quot;directory&quot;</p></li>
<li><p>&quot;name_short&quot;</p></li>
<li><p>&quot;name_long&quot;</p></li>
<li><p>&quot;ext&quot;</p></li>
<li><p>&quot;pix_e_ul&quot;</p></li>
<li><p>&quot;pix_n_ul&quot;.</p></li>
</ol>
<p>With this minimum input, <code class="docutils literal notranslate"><span class="pre">batch.spatial_crop</span></code> will read in each
image, crop from the upper left pixel (determined as
<code class="docutils literal notranslate"><span class="pre">pix_e_ul</span></code>/<code class="docutils literal notranslate"><span class="pre">pix_n_ul</span></code>) to the lower right pixel calculated
based on <code class="docutils literal notranslate"><span class="pre">crop_e_pix</span></code>/<code class="docutils literal notranslate"><span class="pre">crop_n_pix</span></code> (which is the width of the
cropped area in units of pixels).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">crop_e_pix</span></code> and <code class="docutils literal notranslate"><span class="pre">crop_n_pix</span></code> have default values (see
<a class="reference external" href="hs_process.defaults.html#hs_process.defaults.crop_defaults">defaults.crop_defaults()</a>), but they can also be passed
specifically for each datacube by including appropriate columns in
<code class="docutils literal notranslate"><span class="pre">fname_sheet</span></code> (which takes precedence over
<code class="docutils literal notranslate"><span class="pre">defaults.crop_defaults</span></code>).</p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">fname_sheet</span></code> may also have the following optional column headings:</p>
<ol class="arabic simple">
<li><p>&quot;crop_e_pix&quot;</p></li>
<li><p>&quot;crop_n_pix&quot;</p></li>
<li><p>&quot;crop_e_m&quot;</p></li>
<li><p>&quot;crop_n_m&quot;</p></li>
<li><p>&quot;buf_e_pix&quot;</p></li>
<li><p>&quot;buf_n_pix&quot;</p></li>
<li><p>&quot;buf_e_m&quot;</p></li>
<li><p>&quot;buf_n_m&quot;</p></li>
<li><p>&quot;gdf_shft_e_m&quot;</p></li>
<li><p>&quot;gdf_shft_n_m&quot;</p></li>
<li><p>&quot;plot_id_ref&quot;</p></li>
<li><p>&quot;study&quot;</p></li>
<li><p>&quot;date&quot;</p></li>
</ol>
<p><strong>More</strong> <code class="docutils literal notranslate"><span class="pre">fname_sheet</span></code> <strong>Tips and Tricks</strong></p>
<ol class="arabic simple">
<li><p>These optional inputs passed via <code class="docutils literal notranslate"><span class="pre">fname_sheet</span></code> allow more control
over exactly how the images are to be cropped. For a more detailed
explanation of the information that many of these columns are
intended to contain, see the documentation for
<a class="reference external" href="hs_process.spatial_mod.html#hs_process.spatial_mod.crop_single">spatial_mod.crop_single()</a> and <a class="reference external" href="hs_process.spatial_mod.html#hs_process.spatial_mod.crop_many_gdf">spatial_mod.crop_many_gdf()</a>.
Those parameters not referenced should be apparent in the API
examples and tutorials.</p></li>
<li><p>If the column names are different in <code class="docutils literal notranslate"><span class="pre">fname_sheet</span></code> than described
here, <a class="reference external" href="hs_process.defaults.html#hs_process.defaults.spat_crop_cols">defaults.spat_crop_cols()</a> can be modified to indicate which
columns correspond to the relevant information.</p></li>
<li><p>The <em>date</em> and <em>study</em> columns do not impact how the datacubes are
to be cropped, but if this information exists,
<code class="docutils literal notranslate"><span class="pre">batch.spatial_crop</span></code> adds it to the filename of the cropped
datacube. This can be used to avoid overwriting datacubes with
similar names, and is especially useful when processing imagery from
many dates and/or studies/locations and saving them in the same
directory. If &quot;study&quot;, &quot;date&quot;, and &quot;plot_id&quot; are all passed, this
information is used to formulate the output file name; e.g.,
<em>study_wells_date_20180628_plot_527-spatial-crop.bip</em>. If either
&quot;study&quot; or &quot;date&quot; is missing, the populated variables wil be
appended to the end of the <code class="docutils literal notranslate"><span class="pre">hsio.name_short</span></code> string; e.g.,
<em>plot_9_3_pika_gige_1_plot_527-spatial-crop.bip</em>.</p></li>
<li><p>Any other columns can be added to <code class="docutils literal notranslate"><span class="pre">fname_sheet</span></code>, but
<code class="docutils literal notranslate"><span class="pre">batch.spatial_crop()</span></code> does not use them in any way.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following <code class="docutils literal notranslate"><span class="pre">batch</span></code> example only actually processes <em>a single</em>
hyperspectral image. If more datacubes were present in
<code class="docutils literal notranslate"><span class="pre">base_dir</span></code>, however, <code class="docutils literal notranslate"><span class="pre">batch.spatial_crop</span></code> would process all
datacubes that were available.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This example uses <code class="docutils literal notranslate"><span class="pre">spatial_mod.crop_many_gdf</span></code> to crop many
plots from a datacube using a polygon geometry file describing the
spatial extent of each plot.</p>
</div>
<p class="rubric">Example</p>
<p>Load and initialize the <code class="docutils literal notranslate"><span class="pre">batch</span></code> module, checking to be sure the
directory exists.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">batch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">base_dir</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span> <span class="o">=</span> <span class="n">batch</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">search_ext</span><span class="o">=</span><span class="s1">&#39;.bip&#39;</span><span class="p">,</span> <span class="n">dir_level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="go">                    progress_bar=True)  # searches for all files in ``base_dir`` with a &quot;.bip&quot; file extension</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Load the plot geometry as a <code class="docutils literal notranslate"><span class="pre">geopandas.GeoDataFrame</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fname_gdf</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\plot_bounds.geojson&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">fname_gdf</span><span class="p">)</span>
</pre></div>
</div>
<p>Perform the spatial cropping using the <em>&quot;many_gdf&quot;</em> <cite>method</cite>. Note
that nothing is being passed to <cite>fname_sheet</cite> here, so
<code class="docutils literal notranslate"><span class="pre">batch.spatial_crop</span></code> is simply going to attempt to crop all plots
contained within <cite>gdf</cite> that overlap with any datacubes in
<code class="docutils literal notranslate"><span class="pre">base_dir</span></code>.</p>
<p>Passing <code class="docutils literal notranslate"><span class="pre">fname_sheet</span></code> directly is definitely more flexible for
customization. However, some customization is possible while not
passing <code class="docutils literal notranslate"><span class="pre">fname_sheet</span></code>. In the example below, we set an easting
and northing buffer, as well as limit the number of plots to crop
to 40. These defaults trickle through to
<code class="docutils literal notranslate"><span class="pre">spatial_mod.crop_many_gdf()</span></code>, so by setting them on the
<code class="docutils literal notranslate"><span class="pre">batch</span></code> object, they will be recognized when calculating crop
boundaries from <code class="docutils literal notranslate"><span class="pre">gdf</span></code>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">defaults</span><span class="o">.</span><span class="n">crop_defaults</span><span class="o">.</span><span class="n">buf_e_m</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># Sets buffer in the easting direction (units of meters)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">defaults</span><span class="o">.</span><span class="n">crop_defaults</span><span class="o">.</span><span class="n">buf_n_m</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">defaults</span><span class="o">.</span><span class="n">crop_defaults</span><span class="o">.</span><span class="n">n_plots</span> <span class="o">=</span> <span class="mi">40</span>  <span class="c1"># We can limit the number of plots to process from gdf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span><span class="o">.</span><span class="n">spatial_crop</span><span class="p">(</span><span class="n">base_dir</span><span class="o">=</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;many_gdf&#39;</span><span class="p">,</span>
<span class="go">                         gdf=gdf, out_force=True)</span>
</pre></div>
</div>
<p>Because <code class="docutils literal notranslate"><span class="pre">fname_list</span></code> was passed instead of <code class="docutils literal notranslate"><span class="pre">fname_sheet</span></code>, there is not a way to infer the study name and date. Therefore, &quot;study&quot; and &quot;date&quot; will be omitted from the output file name. If you would like output file names to include &quot;study&quot; and &quot;date&quot;, please pass <code class="docutils literal notranslate"><span class="pre">fname_sheet</span></code> with &quot;study&quot; and &quot;date&quot; columns.</p>
<p>Processing file 39/40: 100%|██████████| 40/40 [00:02&lt;00:00, 17.47it/s]</p>
<img alt="_images/spatial_crop_inline.png" src="_images/spatial_crop_inline.png" />
<p>A new folder was created in <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>
- <code class="docutils literal notranslate"><span class="pre">F:\nigo0024\Documents\hs_process_demo\spatial_crop</span></code> - that
contains the cropped datacubes and the cropped <code class="docutils literal notranslate"><span class="pre">geotiff</span></code> images.
The Plot ID from the <code class="docutils literal notranslate"><span class="pre">gdf</span></code> is used to name each datacube
according to its plot ID. The <code class="docutils literal notranslate"><span class="pre">geotiff</span></code> images can be opened in
<em>QGIS</em> to visualize the images after cropping them.</p>
<img alt="../img/batch/spatial_crop_tifs.png" src="../img/batch/spatial_crop_tifs.png" />
<p>The cropped images were brightened in <em>QGIS</em> to emphasize the
cropped boundaries. The plot boundaries are overlaid for reference
(notice the 2.0 m buffer on the East/West ends and the 0.5 m buffer
on the North/South sides).</p>
</dd></dl>

<dl class="py method">
<dt id="hs_process.batch.batch.spectra_combine">
<code class="sig-name descname"><span class="pre">spectra_combine</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bip'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_interleave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_byteorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/batch.html#batch.spectra_combine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.batch.batch.spectra_combine" title="Permalink to this definition">¶</a></dt>
<dd><p>Batch processing tool to gather all pixels from every image in a
directory, compute the mean and standard deviation, and save as a
single spectra (i.e., a spectra file is equivalent to a single spectral
pixel with no spatial information).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname_list</strong> (<code class="docutils literal notranslate"><span class="pre">list</span></code>, optional) -- list of filenames to process; if
left to <code class="docutils literal notranslate"><span class="pre">None</span></code>, will look at <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>, <code class="docutils literal notranslate"><span class="pre">search_ext</span></code>,
and <code class="docutils literal notranslate"><span class="pre">dir_level</span></code> parameters for files to process (default:
<code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>base_dir</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>, optional) -- directory path to search for files to
spectrally clip; if <code class="docutils literal notranslate"><span class="pre">fname_list</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>,
<code class="docutils literal notranslate"><span class="pre">base_dir</span></code> will be ignored (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>search_ext</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- file format/extension to search for in all
directories and subdirectories to determine which files to
process; if <code class="docutils literal notranslate"><span class="pre">fname_list</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">search_ext</span></code> will
be ignored (default: 'bip').</p></li>
<li><p><strong>dir_level</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- The number of directory levels to search; if
<code class="docutils literal notranslate"><span class="pre">None</span></code>, searches all directory levels (default: 0).</p></li>
<li><p><strong>base_dir_out</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- directory path to save all processed
datacubes; if set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, a folder named according to the
<code class="docutils literal notranslate"><span class="pre">folder_name</span></code> parameter is added to <code class="docutils literal notranslate"><span class="pre">base_dir</span></code> (default:
<code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>out_XXX</strong> -- Settings for saving the output files can be adjusted here
if desired. They are stored in <code class="docutils literal notranslate"><span class="pre">batch.io.defaults,</span> <span class="pre">and</span> <span class="pre">are</span>
<span class="pre">therefore</span> <span class="pre">accessible</span> <span class="pre">at</span> <span class="pre">a</span> <span class="pre">high</span> <span class="pre">level.</span> <span class="pre">See</span>
<span class="pre">``hsio.set_io_defaults()</span></code> for more information on each of the
settings.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following example will load in several small hyperspectral
radiance datacubes <em>(not reflectance)</em> that were previously cropped
manually (via Spectronon software). These datacubes represent the
radiance values of grey reference panels that were placed in the
field to provide data necessary for converting radiance imagery
to reflectance. These particular datacubes were extracted
from several different images captured within ~10 minutes of each
other.</p>
</div>
<p class="rubric">Example</p>
<p>Load and initialize the <code class="docutils literal notranslate"><span class="pre">batch</span></code> module, checking to be sure the
directory exists.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">batch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\cube_ref_panels&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">base_dir</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span> <span class="o">=</span> <span class="n">batch</span><span class="p">(</span><span class="n">base_dir</span><span class="p">)</span>
</pre></div>
</div>
<p>Combine all the <em>radiance</em> datacubes in the directory via
<code class="docutils literal notranslate"><span class="pre">batch.spectra_combine</span></code>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span><span class="o">.</span><span class="n">spectra_combine</span><span class="p">(</span><span class="n">base_dir</span><span class="o">=</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">search_ext</span><span class="o">=</span><span class="s1">&#39;bip&#39;</span><span class="p">,</span>
<span class="go">                            dir_level=0)</span>
<span class="go">Combining datacubes/spectra into a single mean spectra.</span>
<span class="go">Number of input datacubes/spectra: 7</span>
<span class="go">Total number of pixels: 1516</span>
<span class="go">Saving F:\nigo0024\Documents\hs_process_demo\cube_ref_panels\spec_mean_spy.spec</span>
</pre></div>
</div>
<p>Visualize the combined spectra by opening in <em>Spectronon</em>. The
solid line represents the mean radiance spectra across all pixels
and images in <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>, and the lighter, slightly transparent
line represents the standard deviation of the radiance across all
pixels and images in <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>.</p>
<img alt="../img/batch/spectra_combine.png" src="../img/batch/spectra_combine.png" />
<p>Notice the lower signal at the oxygen absorption region (near 770
nm). After converting datacubes to reflectance, it may be
desireable to spectrally clip this region (see
<a class="reference external" href="hs_process.spec_mod.html#hs_process.spec_mod.spectral_clip">spec_mod.spectral_clip()</a>)</p>
</dd></dl>

<dl class="py method">
<dt id="hs_process.batch.batch.spectra_derivative">
<code class="sig-name descname"><span class="pre">spectra_derivative</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spec'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spec_derivative'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_append</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spec-derivative'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_interleave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_byteorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/batch.html#batch.spectra_derivative"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.batch.batch.spectra_derivative" title="Permalink to this definition">¶</a></dt>
<dd><p>Batch processing tool to calculate the numeric spectral derivative for
multiple spectra.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname_list</strong> (<code class="docutils literal notranslate"><span class="pre">list</span></code>, optional) -- list of filenames to process; if
left to <code class="docutils literal notranslate"><span class="pre">None</span></code>, will look at <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>, <code class="docutils literal notranslate"><span class="pre">search_ext</span></code>,
and <code class="docutils literal notranslate"><span class="pre">dir_level</span></code> parameters for files to process (default:
<code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>base_dir</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>, optional) -- directory path to search for files to
process; if <code class="docutils literal notranslate"><span class="pre">fname_list</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">base_dir</span></code> will
be ignored (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>search_ext</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- file format/extension to search for in all
directories and subdirectories to determine which files to
process; if <code class="docutils literal notranslate"><span class="pre">fname_list</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">search_ext</span></code> will
be ignored (default: 'bip').</p></li>
<li><p><strong>dir_level</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- The number of directory levels to search; if
<code class="docutils literal notranslate"><span class="pre">None</span></code>, searches all directory levels (default: 0).</p></li>
<li><p><strong>base_dir_out</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- directory path to save all processed
spectra; if set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, a folder named according to the
<code class="docutils literal notranslate"><span class="pre">folder_name</span></code> parameter is added to <code class="docutils literal notranslate"><span class="pre">base_dir</span></code></p></li>
<li><p><strong>folder_name</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- folder to add to <code class="docutils literal notranslate"><span class="pre">base_dir_out</span></code> to save
all the processed datacubes (default: 'spec_derivative').</p></li>
<li><p><strong>name_append</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- name to append to the filename (default:
'spec-derivative').</p></li>
<li><p><strong>order</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- The order of the derivative (default: 1).</p></li>
<li><p><strong>out_XXX</strong> -- Settings for saving the output files can be adjusted here
if desired. They are stored in <code class="docutils literal notranslate"><span class="pre">batch.io.defaults,</span> <span class="pre">and</span> <span class="pre">are</span>
<span class="pre">therefore</span> <span class="pre">accessible</span> <span class="pre">at</span> <span class="pre">a</span> <span class="pre">high</span> <span class="pre">level.</span> <span class="pre">See</span>
<span class="pre">``hsio.set_io_defaults()</span></code> for more information on each of the
settings.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following <cite>batch</cite> example builds on the API example results
of the <a class="reference external" href="hs_process.batch.html#hs_process.batch.cube_to_spectra">batch.cube_to_spectra</a> function. Please complete
both the <a class="reference external" href="hs_process.spatial_mod.html#hs_process.spatial_mod.crop_many_gdf">spatial_mod.crop_many_gdf</a> and
<a class="reference external" href="hs_process.batch.html#hs_process.batch.cube_to_spectra">batch.cube_to_spectra</a> examples to be sure your directory
(i.e., <cite>base_dir</cite>) is populated with multiple hyperspectral
spectra. The following example will be using spectra located in the
following directory:
<code class="docutils literal notranslate"><span class="pre">F:\nigo0024\Documents\hs_process_demo\spatial_mod\crop_many_gdf\cube_to_spec</span></code></p>
</div>
<p class="rubric">Example</p>
<p>Load and initialize the <code class="docutils literal notranslate"><span class="pre">batch</span></code> module, checking to be sure the
directory exists.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">batch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;spatial_mod&#39;</span><span class="p">,</span> <span class="s1">&#39;crop_many_gdf&#39;</span><span class="p">,</span> <span class="s1">&#39;cube_to_spec&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">base_dir</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span> <span class="o">=</span> <span class="n">batch</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">search_ext</span><span class="o">=</span><span class="s1">&#39;.spec&#39;</span><span class="p">,</span> <span class="n">progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Use <code class="docutils literal notranslate"><span class="pre">batch.spectra_derivative</span></code> to calculate the central finite
difference (i.e., the numeric spectral derivative) for each of the
.spec files in <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">order</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span><span class="o">.</span><span class="n">spectra_derivative</span><span class="p">(</span><span class="n">base_dir</span><span class="o">=</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">out_force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Use seaborn to visualize the derivative spectra of plots 1011,
1012, and 1013.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">re</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s1">&#39;spec_derivative&#39;</span><span class="p">,</span> <span class="s1">&#39;Wells_rep2_20180628_16h56m_pika_gige_7_plot_1011-spec-derivative-order-</span><span class="si">{0}</span><span class="s1">.spec&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">order</span><span class="p">)),</span>
<span class="go">                  os.path.join(base_dir, &#39;spec_derivative&#39;, &#39;Wells_rep2_20180628_16h56m_pika_gige_7_plot_1012-spec-derivative-order-{0}.spec&#39;.format(order)),</span>
<span class="go">                  os.path.join(base_dir, &#39;spec_derivative&#39;, &#39;Wells_rep2_20180628_16h56m_pika_gige_7_plot_1013-spec-derivative-order-{0}.spec&#39;.format(order))]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">fname</span> <span class="ow">in</span> <span class="n">fname_list</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_spec</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">meta_bands</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">meta_bands</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">data</span> <span class="o">=</span> <span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile_spec</span><span class="o">.</span><span class="n">open_memmap</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">hist</span> <span class="o">=</span> <span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile_spec</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;history&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pix_n</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;&lt;pixel number: (?s)(.*)&gt;] -&gt;&#39;</span><span class="p">,</span> <span class="n">hist</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">meta_bands</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Plot &#39;</span><span class="o">+</span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">name_plot</span><span class="o">+</span><span class="s1">&#39; (n=&#39;</span><span class="o">+</span><span class="n">pix_n</span><span class="o">+</span><span class="s1">&#39;)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">else</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Plot &#39;</span><span class="o">+</span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">name_plot</span><span class="o">+</span><span class="s1">&#39; (n=&#39;</span><span class="o">+</span><span class="n">pix_n</span><span class="o">+</span><span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavelength (nm)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Derivative reflectance (%)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;API Example: `batch.spectra_derivative`&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../img/batch/spectra_derivative.png" src="../img/batch/spectra_derivative.png" />
</dd></dl>

<dl class="py method">
<dt id="hs_process.batch.batch.spectra_to_csv">
<code class="sig-name descname"><span class="pre">spectra_to_csv</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spec'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'stats-spectra'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multithread</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/batch.html#batch.spectra_to_csv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.batch.batch.spectra_to_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads all the <code class="docutils literal notranslate"><span class="pre">.spec</span></code> files in a direcory and saves their reflectance
information to a <code class="docutils literal notranslate"><span class="pre">.csv</span></code>. <code class="docutils literal notranslate"><span class="pre">batch.spectra_to_csv</span></code> is identical to
<code class="docutils literal notranslate"><span class="pre">batch.spectra_to_df</span></code> except a <code class="docutils literal notranslate"><span class="pre">.csv</span></code> file is saved rather than
returning a <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname_list</strong> (<code class="docutils literal notranslate"><span class="pre">list</span></code>, optional) -- list of filenames to process; if
left to <code class="docutils literal notranslate"><span class="pre">None</span></code>, will look at <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>, <code class="docutils literal notranslate"><span class="pre">search_ext</span></code>, and
<code class="docutils literal notranslate"><span class="pre">dir_level</span></code> parameters for files to process (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>base_dir</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>, optional) -- directory path to search for files to
spectrally clip; if <code class="docutils literal notranslate"><span class="pre">fname_list</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">base_dir</span></code> will
be ignored (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>search_ext</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- file format/extension to search for in all
directories and subdirectories to determine which files to
process; if <code class="docutils literal notranslate"><span class="pre">fname_list</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">search_ext</span></code> will
be ignored (default: 'bip').</p></li>
<li><p><strong>dir_level</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- The number of directory levels to search; if
<code class="docutils literal notranslate"><span class="pre">None</span></code>, searches all directory levels (default: 0).</p></li>
<li><p><strong>base_dir_out</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- directory path to save all processed
datacubes; if set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, file is saved to <code class="docutils literal notranslate"><span class="pre">base_dir</span></code></p></li>
<li><p><strong>name</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- The output filename (default: &quot;stats-spectra&quot;).</p></li>
<li><p><strong>multithread</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- Whether to leverage multi-thread processing
when reading the .spec files. Setting to <code class="docutils literal notranslate"><span class="pre">True</span></code> should speed
up the time it takes to read all .spec files.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following example builds on the API example results of
<a class="reference external" href="hs_process.batch.html#hs_process.batch.segment_band_math">batch.segment_band_math()</a> and <cite>batch.segment_create_mask()_.
Please complete each of those API examples to be sure your
directory (i.e.,
``F:nigo0024Documentshs_process_demospatial_modcrop_many_gdfmask_mcari2_90th`</cite>)
is populated with image files.</p>
</div>
<p class="rubric">Example</p>
<p>Load and initialize the <code class="docutils literal notranslate"><span class="pre">batch</span></code> module, checking to be sure the
directory exists.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">batch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\spatial_mod\crop_many_gdf\mask_mcari2_90th&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">base_dir</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span> <span class="o">=</span> <span class="n">batch</span><span class="p">(</span><span class="n">base_dir</span><span class="p">)</span>
</pre></div>
</div>
<p>Read all the <code class="docutils literal notranslate"><span class="pre">.spec</span></code> files in <code class="docutils literal notranslate"><span class="pre">base_dir</span></code> and save them to a
<code class="docutils literal notranslate"><span class="pre">.csv</span></code> file.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span><span class="o">.</span><span class="n">spectra_to_csv</span><span class="p">(</span><span class="n">base_dir</span><span class="o">=</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">search_ext</span><span class="o">=</span><span class="s1">&#39;spec&#39;</span><span class="p">,</span>
<span class="go">                           dir_level=0)</span>
<span class="go">Writing mean spectra to a .csv file.</span>
<span class="go">Number of input datacubes/spectra: 40</span>
<span class="go">Output file location: F:\nigo0024\Documents\hs_process_demo\spatial_mod\crop_many_gdf\mask_mcari2_90th\stats-spectra.csv</span>
</pre></div>
</div>
<p>When <code class="docutils literal notranslate"><span class="pre">stats-spectra.csv</span></code> is opened in Microsoft Excel, we can see
that each row is a <code class="docutils literal notranslate"><span class="pre">.spec</span></code> file from a different plot, and each
column is a particular spectral band/wavelength.</p>
<img alt="../img/batch/spectra_to_csv.png" src="../img/batch/spectra_to_csv.png" />
</dd></dl>

<dl class="py method">
<dt id="hs_process.batch.batch.spectra_to_df">
<code class="sig-name descname"><span class="pre">spectra_to_df</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spec'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multithread</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/batch.html#batch.spectra_to_df"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.batch.batch.spectra_to_df" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads all the .spec files in a direcory and returns their data as a
<code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> object. <code class="docutils literal notranslate"><span class="pre">batch.spectra_to_df</span></code> is identical to
<code class="docutils literal notranslate"><span class="pre">batch.spectra_to_csv</span></code> except a <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> is returned
rather than saving a <code class="docutils literal notranslate"><span class="pre">.csv</span></code> file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname_list</strong> (<code class="docutils literal notranslate"><span class="pre">list</span></code>, optional) -- list of filenames to process; if
left to <code class="docutils literal notranslate"><span class="pre">None</span></code>, will look at <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>, <code class="docutils literal notranslate"><span class="pre">search_ext</span></code>, and
<code class="docutils literal notranslate"><span class="pre">dir_level</span></code> parameters for files to process (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>base_dir</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>, optional) -- directory path to search for files to
spectrally clip; if <code class="docutils literal notranslate"><span class="pre">fname_list</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">base_dir</span></code> will
be ignored (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>search_ext</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- file format/extension to search for in all
directories and subdirectories to determine which files to
process; if <code class="docutils literal notranslate"><span class="pre">fname_list</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">search_ext</span></code> will
be ignored (default: 'bip').</p></li>
<li><p><strong>dir_level</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- The number of directory levels to search; if
<code class="docutils literal notranslate"><span class="pre">None</span></code>, searches all directory levels (default: 0).</p></li>
<li><p><strong>multithread</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- Whether to leverage multi-thread processing
when reading the .spec files. Setting to <code class="docutils literal notranslate"><span class="pre">True</span></code> should speed
up the time it takes to read all .spec files.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following example builds on the API example results of
<a class="reference external" href="hs_process.batch.html#hs_process.batch.segment_band_math">batch.segment_band_math()</a> and <cite>batch.segment_create_mask()_.
Please complete each of those API examples to be sure your
directory (i.e.,
``F:nigo0024Documentshs_process_demospatial_modcrop_many_gdfmask_mcari2_90th`</cite>)
is populated with image files.</p>
</div>
<p class="rubric">Example</p>
<p>Load and initialize the <code class="docutils literal notranslate"><span class="pre">batch</span></code> module, checking to be sure the
directory exists.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">batch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\spatial_mod\crop_many_gdf\mask_mcari2_90th&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">base_dir</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span> <span class="o">=</span> <span class="n">batch</span><span class="p">(</span><span class="n">base_dir</span><span class="p">)</span>
</pre></div>
</div>
<p>Read all the <code class="docutils literal notranslate"><span class="pre">.spec</span></code> files in <code class="docutils literal notranslate"><span class="pre">base_dir</span></code> and load them to
<code class="docutils literal notranslate"><span class="pre">df_spec</span></code>, a <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df_spec</span> <span class="o">=</span> <span class="n">hsbatch</span><span class="o">.</span><span class="n">spectra_to_df</span><span class="p">(</span><span class="n">base_dir</span><span class="o">=</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">search_ext</span><span class="o">=</span><span class="s1">&#39;spec&#39;</span><span class="p">,</span>
<span class="go">                                    dir_level=0)</span>
<span class="go">Writing mean spectra to a ``pandas.DataFrame``.</span>
<span class="go">Number of input datacubes/spectra: 40</span>
</pre></div>
</div>
<p>When visualizing <code class="docutils literal notranslate"><span class="pre">df_spe</span></code> in <a class="reference external" href="https://www.spyder-ide.org/">Spyder</a>, we can see that each row
is a <code class="docutils literal notranslate"><span class="pre">.spec</span></code> file from a different plot, and each column is a
particular spectral band.</p>
<img alt="../img/batch/spectra_to_df.png" src="../img/batch/spectra_to_df.png" />
<p>It is somewhat confusing to conceptualize spectral data by band
number (as opposed to the wavelenth it represents).
<code class="docutils literal notranslate"><span class="pre">hs_process.hs_tools.get_band</span></code> can be used to retrieve
spectral data for all plots via indexing by wavelength. Say we need
to access reflectance at 710 nm for each plot.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df_710nm</span> <span class="o">=</span> <span class="n">df_spec</span><span class="p">[[</span><span class="s1">&#39;fname&#39;</span><span class="p">,</span> <span class="s1">&#39;plot_id&#39;</span><span class="p">,</span> <span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_band</span><span class="p">(</span><span class="mi">710</span><span class="p">)]]</span>
</pre></div>
</div>
<img alt="../img/batch/spectra_to_df_710nm.png" src="../img/batch/spectra_to_df_710nm.png" />
</dd></dl>

<dl class="py method">
<dt id="hs_process.batch.batch.spectral_clip">
<code class="sig-name descname"><span class="pre">spectral_clip</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bip'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spec_clip'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_append</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spec-clip'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wl_bands</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[[0,</span> <span class="pre">420],</span> <span class="pre">[760,</span> <span class="pre">776],</span> <span class="pre">[813,</span> <span class="pre">827],</span> <span class="pre">[880,</span> <span class="pre">1000]]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_interleave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_byteorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/batch.html#batch.spectral_clip"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.batch.batch.spectral_clip" title="Permalink to this definition">¶</a></dt>
<dd><p>Batch processing tool to spectrally clip multiple datacubes in the same
way.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname_list</strong> (<code class="docutils literal notranslate"><span class="pre">list</span></code>, optional) -- list of filenames to process; if
left to <code class="docutils literal notranslate"><span class="pre">None</span></code>, will look at <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>, <code class="docutils literal notranslate"><span class="pre">search_ext</span></code>, and
<code class="docutils literal notranslate"><span class="pre">dir_level</span></code> parameters for files to process (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>base_dir</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>, optional) -- directory path to search for files to
spectrally clip; if <code class="docutils literal notranslate"><span class="pre">fname_list</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">base_dir</span></code> will
be ignored (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>search_ext</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- file format/extension to search for in all
directories and subdirectories to determine which files to
process; if <code class="docutils literal notranslate"><span class="pre">fname_list</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">search_ext</span></code> will
be ignored (default: 'bip').</p></li>
<li><p><strong>dir_level</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- The number of directory levels to search; if
<code class="docutils literal notranslate"><span class="pre">None</span></code>, searches all directory levels (default: 0).</p></li>
<li><p><strong>base_dir_out</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- directory path to save all processed
datacubes; if set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, a folder named according to the
<code class="docutils literal notranslate"><span class="pre">folder_name</span></code> parameter is added to <code class="docutils literal notranslate"><span class="pre">base_dir</span></code></p></li>
<li><p><strong>folder_name</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- folder to add to <code class="docutils literal notranslate"><span class="pre">base_dir_out</span></code> to save all
the processed datacubes (default: 'spec-clip').</p></li>
<li><p><strong>name_append</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- name to append to the filename (default:
'spec-clip').</p></li>
<li><p><strong>wl_bands</strong> (<code class="docutils literal notranslate"><span class="pre">list</span></code> or <code class="docutils literal notranslate"><span class="pre">list</span> <span class="pre">of</span> <span class="pre">lists</span></code>) -- minimum and maximum
wavelenths to clip from image; if multiple groups of
wavelengths should be cut, this should be a list of lists. For
example, wl_bands=[760, 776] will clip all bands greater than
760.0 nm and less than 776.0 nm;
wl_bands = [[0, 420], [760, 776], [813, 827], [880, 1000]]
will clip all band less than 420.0 nm, bands greater than 760.0
nm and less than 776.0 nm, bands greater than 813.0 nm and less
than 827.0 nm, and bands greater than 880 nm (default).</p></li>
<li><p><strong>out_XXX</strong> -- Settings for saving the output files can be adjusted here
if desired. They are stored in <code class="docutils literal notranslate"><span class="pre">batch.io.defaults,</span> <span class="pre">and</span> <span class="pre">are</span>
<span class="pre">therefore</span> <span class="pre">accessible</span> <span class="pre">at</span> <span class="pre">a</span> <span class="pre">high</span> <span class="pre">level.</span> <span class="pre">See</span>
<span class="pre">``hsio.set_io_defaults()</span></code> for more information on each of the
settings.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following <code class="docutils literal notranslate"><span class="pre">batch</span></code> example builds on the API example results
of the <a class="reference external" href="hs_process.batch.html#hs_process.batch.spatial_crop">batch.spatial_crop</a> function. Please complete the
<a class="reference external" href="hs_process.batch.html#hs_process.batch.spatial_crop">batch.spatial_crop</a> example to be sure your directory
(i.e., <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>) is populated with multiple hyperspectral
datacubes. The following example will be using datacubes located in
the following directory:
<code class="docutils literal notranslate"><span class="pre">F:\nigo0024\Documents\hs_process_demo\spatial_crop</span></code></p>
</div>
<p class="rubric">Example</p>
<p>Load and initialize the <code class="docutils literal notranslate"><span class="pre">batch</span></code> module, checking to be sure the
directory exists.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">batch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\spatial_crop&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">base_dir</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span> <span class="o">=</span> <span class="n">batch</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">search_ext</span><span class="o">=</span><span class="s1">&#39;.bip&#39;</span><span class="p">,</span> <span class="n">progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># searches for all files in ``base_dir`` with a &quot;.bip&quot; file extension</span>
</pre></div>
</div>
<p>Use <code class="docutils literal notranslate"><span class="pre">batch.spectral_clip</span></code> to clip all spectral bands below
<em>420 nm</em> and above <em>880 nm</em>, as well as the bands near the oxygen
absorption (i.e., <em>760-776 nm</em>) and water absorption
(i.e., <em>813-827 nm</em>) regions.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span><span class="o">.</span><span class="n">spectral_clip</span><span class="p">(</span><span class="n">base_dir</span><span class="o">=</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">folder_name</span><span class="o">=</span><span class="s1">&#39;spec_clip&#39;</span><span class="p">,</span>
<span class="go">                          wl_bands=[[0, 420], [760, 776], [813, 827], [880, 1000]],</span>
<span class="go">                          out_force=True)</span>
<span class="go">Processing 40 files. If this is not what is expected, please check if files have already undergone processing. If existing files should be overwritten, be sure to set the ``out_force`` parameter.</span>
<span class="go">Processing file 39/40: 100%|██████████| 40/40 [00:01&lt;00:00, 26.68it/s]</span>
</pre></div>
</div>
<p>Use <code class="docutils literal notranslate"><span class="pre">seaborn</span></code> to visualize the spectra of a single pixel in one
of the processed images.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s1">&#39;Wells_rep2_20180628_16h56m_pika_gige_7_1011-spatial-crop.bip&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_cube</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spy_mem</span> <span class="o">=</span> <span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">open_memmap</span><span class="p">()</span>  <span class="c1"># datacube before clipping</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">meta_bands</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">meta_bands</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s1">&#39;spec_clip&#39;</span><span class="p">,</span> <span class="s1">&#39;Wells_rep2_20180628_16h56m_pika_gige_7_1011-spec-clip.bip&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_cube</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spy_mem_clip</span> <span class="o">=</span> <span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">open_memmap</span><span class="p">()</span>  <span class="c1"># datacube after clipping</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">meta_bands_clip</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">meta_bands</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">spy_mem</span><span class="p">[</span><span class="mi">26</span><span class="p">][</span><span class="mi">29</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Before spectral clipping&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands_clip</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">spy_mem_clip</span><span class="p">[</span><span class="mi">26</span><span class="p">][</span><span class="mi">29</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;After spectral clipping&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavelength (nm)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Reflectance (%)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;API Example: `batch.spectral_clip`&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../img/batch/spectral_clip_plot.png" src="../img/batch/spectral_clip_plot.png" />
<p>Notice the spectral areas that were clipped, namely the oxygen and
water absorption regions (~770 and ~820 nm, respectively). There
is perhaps a lower <em>signal:noise</em> ratio in these regions, which was
the merit for clipping those bands out.</p>
</dd></dl>

<dl class="py method">
<dt id="hs_process.batch.batch.spectral_mimic">
<code class="sig-name descname"><span class="pre">spectral_mimic</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bip'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spec_mimic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_append</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spec-mimic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sentinel-2a'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_band_response</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_wl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wl_nm'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_wl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'peak'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_interleave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_byteorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/batch.html#batch.spectral_mimic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.batch.batch.spectral_mimic" title="Permalink to this definition">¶</a></dt>
<dd><p>Batch processing tool to spectrally mimic a multispectral sensor for
multiple datacubes in the same way.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname_list</strong> (<code class="docutils literal notranslate"><span class="pre">list</span></code>, optional) -- list of filenames to process; if
left to <code class="docutils literal notranslate"><span class="pre">None</span></code>, will look at <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>, <code class="docutils literal notranslate"><span class="pre">search_ext</span></code>,
and <code class="docutils literal notranslate"><span class="pre">dir_level</span></code> parameters for files to process (default:
<code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>base_dir</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>, optional) -- directory path to search for files to
spectrally resample; if <code class="docutils literal notranslate"><span class="pre">fname_list</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>,
<code class="docutils literal notranslate"><span class="pre">base_dir</span></code> will be ignored (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>search_ext</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- file format/extension to search for in all
directories and subdirectories to determine which files to
process; if <code class="docutils literal notranslate"><span class="pre">fname_list</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">search_ext</span></code> will
be ignored (default: 'bip').</p></li>
<li><p><strong>dir_level</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- The number of directory levels to search; if
<code class="docutils literal notranslate"><span class="pre">None</span></code>, searches all directory levels (default: 0).</p></li>
<li><p><strong>base_dir_out</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- directory path to save all processed
datacubes; if set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, a folder named according to the
<code class="docutils literal notranslate"><span class="pre">folder_name</span></code> parameter is added to <code class="docutils literal notranslate"><span class="pre">base_dir</span></code></p></li>
<li><p><strong>folder_name</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- folder to add to <code class="docutils literal notranslate"><span class="pre">base_dir_out</span></code> to save
all the processed datacubes (default: 'spec_bin').</p></li>
<li><p><strong>name_append</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- name to append to the filename (default:
'spec-bin').</p></li>
<li><p><strong>sensor</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- Should be one of
[&quot;sentera_6x&quot;, &quot;micasense_rededge_3&quot;, &quot;sentinel-2a&quot;,
&quot;sentinel-2b&quot;, &quot;custom&quot;]; if &quot;custom&quot;, <code class="docutils literal notranslate"><span class="pre">df_band_response</span></code>
and <code class="docutils literal notranslate"><span class="pre">col_wl</span></code> must be passed.</p></li>
<li><p><strong>df_band_response</strong> (<code class="docutils literal notranslate"><span class="pre">pd.DataFrame</span></code>) -- A DataFrame that contains the
transmissivity (%) for each sensor band (as columns) mapped to
the continuous wavelength values (as rows). Required if
<code class="docutils literal notranslate"><span class="pre">sensor</span></code> is  &quot;custom&quot;, ignored otherwise.</p></li>
<li><p><strong>col_wl</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- The column of <code class="docutils literal notranslate"><span class="pre">df_band_response</span></code> denoting the
wavlengths (default: 'wl_nm').</p></li>
<li><p><strong>center_wl</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- Indicates how the center wavelength of each
band is determined. If <code class="docutils literal notranslate"><span class="pre">center_wl</span></code> is &quot;peak&quot;, the point at
which transmissivity is at its maximum is used as the center
wavelength. If <code class="docutils literal notranslate"><span class="pre">center_wl</span></code> is &quot;weighted&quot;, the weighted
average is used to compute the center wavelength. Must be one
of [&quot;peak&quot;, &quot;weighted&quot;] (<code class="docutils literal notranslate"><span class="pre">default:</span> <span class="pre">&quot;peak&quot;</span></code>).</p></li>
<li><p><strong>out_XXX</strong> -- Settings for saving the output files can be adjusted here
if desired. They are stored in <code class="docutils literal notranslate"><span class="pre">batch.io.defaults,</span> <span class="pre">and</span> <span class="pre">are</span>
<span class="pre">therefore</span> <span class="pre">accessible</span> <span class="pre">at</span> <span class="pre">a</span> <span class="pre">high</span> <span class="pre">level.</span> <span class="pre">See</span>
<span class="pre">``hsio.set_io_defaults()</span></code> for more information on each of the
settings.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following <code class="docutils literal notranslate"><span class="pre">batch</span></code> example builds on the API example results
of the <a class="reference external" href="hs_process.batch.html#hs_process.batch.spatial_crop">batch.spatial_crop</a> function. Please complete the
<a class="reference external" href="hs_process.batch.html#hs_process.batch.spatial_crop">batch.spatial_crop</a> example to be sure your directory
(i.e., <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>) is populated with multiple hyperspectral
datacubes. The following example will be using datacubes located in
the following directory:
<code class="docutils literal notranslate"><span class="pre">F:\nigo0024\Documents\hs_process_demo\spatial_crop</span></code></p>
</div>
<p class="rubric">Example</p>
<p>Load and initialize the <code class="docutils literal notranslate"><span class="pre">batch</span></code> module, checking to be sure the
directory exists.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">batch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\spatial_crop&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">base_dir</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span> <span class="o">=</span> <span class="n">batch</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">search_ext</span><span class="o">=</span><span class="s1">&#39;.bip&#39;</span><span class="p">,</span> <span class="n">progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># searches for all files in ``base_dir`` with a &quot;.bip&quot; file extension</span>
</pre></div>
</div>
<p>Use <code class="docutils literal notranslate"><span class="pre">batch.spectral_mimic</span></code> to spectrally mimic the Sentinel-2A
multispectral satellite sensor.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span><span class="o">.</span><span class="n">spectral_mimic</span><span class="p">(</span>
<span class="go">    base_dir=base_dir, folder_name=&#39;spec_mimic&#39;,</span>
<span class="go">    name_append=&#39;sentinel-2a&#39;,</span>
<span class="go">    sensor=&#39;sentinel-2a&#39;, center_wl=&#39;weighted&#39;)</span>
<span class="go">Processing 40 files. If existing files should be overwritten, be sure to set the ``out_force`` parameter.</span>
<span class="go">Processing file 39/40: 100%|██████████| 40/40 [00:04&lt;00:00,  8.85it/s]</span>
</pre></div>
</div>
<p>Use <code class="docutils literal notranslate"><span class="pre">seaborn</span></code> to visualize the spectra of a single pixel in one
of the processed images.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s1">&#39;Wells_rep2_20180628_16h56m_pika_gige_7_1011-spatial-crop.bip&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_cube</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spy_mem</span> <span class="o">=</span> <span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">open_memmap</span><span class="p">()</span>  <span class="c1"># datacube before mimicking</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">meta_bands</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">meta_bands</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s1">&#39;spec_mimic&#39;</span><span class="p">,</span> <span class="s1">&#39;Wells_rep2_20180628_16h56m_pika_gige_7_1011-sentinel-2a.bip&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_cube</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spy_mem_sen2a</span> <span class="o">=</span> <span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">open_memmap</span><span class="p">()</span>  <span class="c1"># datacube after mimicking</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">meta_bands_sen2a</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">meta_bands</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">spy_mem</span><span class="p">[</span><span class="mi">26</span><span class="p">][</span><span class="mi">29</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Hyperspectral (Pika II)&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands_sen2a</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">spy_mem_sen2a</span><span class="p">[</span><span class="mi">26</span><span class="p">][</span><span class="mi">29</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sentinel-2A &quot;mimic&quot;&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavelength (nm)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Reflectance (%)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;API Example: `batch.spectral_mimic`&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../img/batch/spectral_mimic_sentinel-2a_plot.png" src="../img/batch/spectral_mimic_sentinel-2a_plot.png" />
</dd></dl>

<dl class="py method">
<dt id="hs_process.batch.batch.spectral_resample">
<code class="sig-name descname"><span class="pre">spectral_resample</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bip'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spec_bin'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_append</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spec-bin'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bandwidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins_n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_interleave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_byteorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/batch.html#batch.spectral_resample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.batch.batch.spectral_resample" title="Permalink to this definition">¶</a></dt>
<dd><p>Batch processing tool to spectrally resample (a.k.a. &quot;bin&quot;) multiple
datacubes in the same way.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname_list</strong> (<code class="docutils literal notranslate"><span class="pre">list</span></code>, optional) -- list of filenames to process; if
left to <code class="docutils literal notranslate"><span class="pre">None</span></code>, will look at <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>, <code class="docutils literal notranslate"><span class="pre">search_ext</span></code>,
and <code class="docutils literal notranslate"><span class="pre">dir_level</span></code> parameters for files to process (default:
<code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>base_dir</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>, optional) -- directory path to search for files to
spectrally resample; if <code class="docutils literal notranslate"><span class="pre">fname_list</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>,
<code class="docutils literal notranslate"><span class="pre">base_dir</span></code> will be ignored (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>search_ext</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- file format/extension to search for in all
directories and subdirectories to determine which files to
process; if <code class="docutils literal notranslate"><span class="pre">fname_list</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">search_ext</span></code> will
be ignored (default: 'bip').</p></li>
<li><p><strong>dir_level</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- The number of directory levels to search; if
<code class="docutils literal notranslate"><span class="pre">None</span></code>, searches all directory levels (default: 0).</p></li>
<li><p><strong>base_dir_out</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- directory path to save all processed
datacubes; if set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, a folder named according to the
<code class="docutils literal notranslate"><span class="pre">folder_name</span></code> parameter is added to <code class="docutils literal notranslate"><span class="pre">base_dir</span></code></p></li>
<li><p><strong>folder_name</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- folder to add to <code class="docutils literal notranslate"><span class="pre">base_dir_out</span></code> to save
all the processed datacubes (default: 'spec_bin').</p></li>
<li><p><strong>name_append</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- name to append to the filename (default:
'spec-bin').</p></li>
<li><p><strong>bandwidth</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code> or <code class="docutils literal notranslate"><span class="pre">int</span></code>) -- The bandwidth of the bands
after spectral resampling is complete (units should be
consistent with that of the .hdr file). Setting <code class="docutils literal notranslate"><span class="pre">bandwidth</span></code>
to 10 will consolidate bands that fall within every 10 nm
interval.</p></li>
<li><p><strong>bins_n</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- The number of bins (i.e., &quot;bands&quot;) to achieve
after spectral resampling is complete. Ignored if <code class="docutils literal notranslate"><span class="pre">bandwidth</span></code>
is not <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>out_XXX</strong> -- Settings for saving the output files can be adjusted here
if desired. They are stored in <code class="docutils literal notranslate"><span class="pre">batch.io.defaults,</span> <span class="pre">and</span> <span class="pre">are</span>
<span class="pre">therefore</span> <span class="pre">accessible</span> <span class="pre">at</span> <span class="pre">a</span> <span class="pre">high</span> <span class="pre">level.</span> <span class="pre">See</span>
<span class="pre">``hsio.set_io_defaults()</span></code> for more information on each of the
settings.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following <code class="docutils literal notranslate"><span class="pre">batch</span></code> example builds on the API example results
of the <a class="reference external" href="hs_process.batch.html#hs_process.batch.spatial_crop">batch.spatial_crop</a> function. Please complete the
<a class="reference external" href="hs_process.batch.html#hs_process.batch.spatial_crop">batch.spatial_crop</a> example to be sure your directory
(i.e., <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>) is populated with multiple hyperspectral
datacubes. The following example will be using datacubes located in
the following directory:
<code class="docutils literal notranslate"><span class="pre">F:\nigo0024\Documents\hs_process_demo\spatial_crop</span></code></p>
</div>
<p class="rubric">Example</p>
<p>Load and initialize the <code class="docutils literal notranslate"><span class="pre">batch</span></code> module, checking to be sure the
directory exists.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">batch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\spatial_crop&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">base_dir</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span> <span class="o">=</span> <span class="n">batch</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">search_ext</span><span class="o">=</span><span class="s1">&#39;.bip&#39;</span><span class="p">,</span> <span class="n">progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># searches for all files in ``base_dir`` with a &quot;.bip&quot; file extension</span>
</pre></div>
</div>
<p>Use <code class="docutils literal notranslate"><span class="pre">batch.spectral_resample</span></code> to bin (&quot;group&quot;) all spectral bands
into 20 nm bandwidth bands (from ~2.3 nm bandwidth originally) on
a per-pixel basis.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span><span class="o">.</span><span class="n">spectral_resample</span><span class="p">(</span>
<span class="go">    base_dir=base_dir, folder_name=&#39;spec_bin&#39;,</span>
<span class="go">    name_append=&#39;spec-bin-20&#39;, bandwidth=20)</span>
<span class="go">Processing 40 files. If existing files should be overwritten, be sure to set the ``out_force`` parameter.</span>
<span class="go">Processing file 39/40: 100%|██████████| 40/40 [00:00&lt;00:00, 48.31it/s]</span>
<span class="gp">...</span>
</pre></div>
</div>
<p>Use <code class="docutils literal notranslate"><span class="pre">seaborn</span></code> to visualize the spectra of a single pixel in one
of the processed images.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s1">&#39;Wells_rep2_20180628_16h56m_pika_gige_7_1011-spatial-crop.bip&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_cube</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spy_mem</span> <span class="o">=</span> <span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">open_memmap</span><span class="p">()</span>  <span class="c1"># datacube before resampling</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">meta_bands</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">meta_bands</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s1">&#39;spec_bin&#39;</span><span class="p">,</span> <span class="s1">&#39;Wells_rep2_20180628_16h56m_pika_gige_7_1011-spec-bin-20.bip&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_cube</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spy_mem_bin</span> <span class="o">=</span> <span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">open_memmap</span><span class="p">()</span>  <span class="c1"># datacube after resampling</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">meta_bands_bin</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">meta_bands</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">spy_mem</span><span class="p">[</span><span class="mi">26</span><span class="p">][</span><span class="mi">29</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Hyperspectral (Pika II)&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands_bin</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">spy_mem_bin</span><span class="p">[</span><span class="mi">26</span><span class="p">][</span><span class="mi">29</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Spectral resample (20 nm)&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavelength (nm)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Reflectance (%)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;API Example: `batch.spectral_resample`&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../img/batch/spectral_resample-20nm_plot.png" src="../img/batch/spectral_resample-20nm_plot.png" />
</dd></dl>

<dl class="py method">
<dt id="hs_process.batch.batch.spectral_smooth">
<code class="sig-name descname"><span class="pre">spectral_smooth</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bip'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spec_smooth'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_append</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spec-smooth'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_interleave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_byteorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/batch.html#batch.spectral_smooth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.batch.batch.spectral_smooth" title="Permalink to this definition">¶</a></dt>
<dd><p>Batch processing tool to spectrally smooth multiple datacubes in the
same way.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname_list</strong> (<code class="docutils literal notranslate"><span class="pre">list</span></code>, optional) -- list of filenames to process; if
left to <code class="docutils literal notranslate"><span class="pre">None</span></code>, will look at <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>, <code class="docutils literal notranslate"><span class="pre">search_ext</span></code>, and
<code class="docutils literal notranslate"><span class="pre">dir_level</span></code> parameters for files to process (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>base_dir</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>, optional) -- directory path to search for files to
spectrally clip; if <code class="docutils literal notranslate"><span class="pre">fname_list</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">base_dir</span></code> will
be ignored (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>search_ext</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- file format/extension to search for in all
directories and subdirectories to determine which files to
process; if <code class="docutils literal notranslate"><span class="pre">fname_list</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">search_ext</span></code> will
be ignored (default: 'bip').</p></li>
<li><p><strong>dir_level</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- The number of directory levels to search; if
<code class="docutils literal notranslate"><span class="pre">None</span></code>, searches all directory levels (default: 0).</p></li>
<li><p><strong>base_dir_out</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- directory path to save all processed
datacubes; if set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, a folder named according to the
<code class="docutils literal notranslate"><span class="pre">folder_name</span></code> parameter is added to <code class="docutils literal notranslate"><span class="pre">base_dir</span></code></p></li>
<li><p><strong>folder_name</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- folder to add to <code class="docutils literal notranslate"><span class="pre">base_dir_out</span></code> to save all
the processed datacubes (default: 'spec-smooth').</p></li>
<li><p><strong>name_append</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- name to append to the filename (default:
'spec-smooth').</p></li>
<li><p><strong>window_size</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- the length of the window; must be an odd
integer number (default: 11).</p></li>
<li><p><strong>order</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- the order of the polynomial used in the filtering;
must be less than <code class="docutils literal notranslate"><span class="pre">window_size</span></code> - 1 (default: 2).</p></li>
<li><p><strong>stats</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- whether to compute some basic descriptive
statistics (mean, st. dev., and coefficient of variation) of
the smoothed data array (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)</p></li>
<li><p><strong>out_XXX</strong> -- Settings for saving the output files can be adjusted here
if desired. They are stored in <code class="docutils literal notranslate"><span class="pre">batch.io.defaults,</span> <span class="pre">and</span> <span class="pre">are</span>
<span class="pre">therefore</span> <span class="pre">accessible</span> <span class="pre">at</span> <span class="pre">a</span> <span class="pre">high</span> <span class="pre">level.</span> <span class="pre">See</span>
<span class="pre">``hsio.set_io_defaults()</span></code> for more information on each of the
settings.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following <code class="docutils literal notranslate"><span class="pre">batch</span></code> example builds on the API example results
of the <a class="reference external" href="hs_process.batch.html#hs_process.batch.spatial_crop">batch.spatial_crop</a> function. Please complete the
<a class="reference external" href="hs_process.batch.html#hs_process.batch.spatial_crop">batch.spatial_crop</a> example to be sure your directory
(i.e., <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>) is populated with multiple hyperspectral
datacubes. The following example will be using datacubes located in
the following directory:
<code class="docutils literal notranslate"><span class="pre">F:\nigo0024\Documents\hs_process_demo\spatial_crop</span></code></p>
</div>
<p class="rubric">Example</p>
<p>Load and initialize the <code class="docutils literal notranslate"><span class="pre">batch</span></code> module, checking to be sure the
directory exists.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">batch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\spatial_crop&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">base_dir</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span> <span class="o">=</span> <span class="n">batch</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">search_ext</span><span class="o">=</span><span class="s1">&#39;.bip&#39;</span><span class="p">)</span>  <span class="c1"># searches for all files in ``base_dir`` with a &quot;.bip&quot; file extension</span>
</pre></div>
</div>
<p>Use <code class="docutils literal notranslate"><span class="pre">batch.spectral_smooth</span></code> to perform a <em>Savitzky-Golay</em>
smoothing operation on each image/pixel in <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>. The
<code class="docutils literal notranslate"><span class="pre">window_size</span></code> and <code class="docutils literal notranslate"><span class="pre">order</span></code> can be adjusted to achieve desired
smoothing results.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span><span class="o">.</span><span class="n">spectral_smooth</span><span class="p">(</span><span class="n">base_dir</span><span class="o">=</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">folder_name</span><span class="o">=</span><span class="s1">&#39;spec_smooth&#39;</span><span class="p">,</span>
<span class="go">                            window_size=11, order=2)</span>
<span class="go">Processing 40 files. If this is not what is expected, please check if files have already undergone processing. If existing files should be overwritten, be sure to set the ``out_force`` parameter.</span>
<span class="go">Spectrally smoothing: F:\nigo0024\Documents\hs_process_demo\spatial_crop\Wells_rep2_20180628_16h56m_pika_gige_7_1011-spatial-crop.bip</span>
<span class="go">Saving F:\nigo0024\Documents\hs_process_demo\spatial_crop\spec_smooth\Wells_rep2_20180628_16h56m_pika_gige_7_1011-spec-smooth.bip</span>
<span class="go">Spectrally smoothing: F:\nigo0024\Documents\hs_process_demo\spatial_crop\Wells_rep2_20180628_16h56m_pika_gige_7_1012-spatial-crop.bip</span>
<span class="go">Saving F:\nigo0024\Documents\hs_process_demo\spatial_crop\spec_smooth\Wells_rep2_20180628_16h56m_pika_gige_7_1012-spec-smooth.bip</span>
<span class="gp">...</span>
</pre></div>
</div>
<p>Use <code class="docutils literal notranslate"><span class="pre">seaborn</span></code> to visualize the spectra of a single pixel in one
of the processed images.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s1">&#39;Wells_rep2_20180628_16h56m_pika_gige_7_1011-spatial-crop.bip&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_cube</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spy_mem</span> <span class="o">=</span> <span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">open_memmap</span><span class="p">()</span>  <span class="c1"># datacube before smoothing</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">meta_bands</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">meta_bands</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s1">&#39;spec_smooth&#39;</span><span class="p">,</span> <span class="s1">&#39;Wells_rep2_20180628_16h56m_pika_gige_7_1011-spec-smooth.bip&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_cube</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spy_mem_clip</span> <span class="o">=</span> <span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">open_memmap</span><span class="p">()</span>  <span class="c1"># datacube after smoothing</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">meta_bands_clip</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">meta_bands</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">spy_mem</span><span class="p">[</span><span class="mi">26</span><span class="p">][</span><span class="mi">29</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Before spectral smoothing&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands_clip</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">spy_mem_clip</span><span class="p">[</span><span class="mi">26</span><span class="p">][</span><span class="mi">29</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;After spectral smoothing&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavelength (nm)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Reflectance (%)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;API Example: `batch.spectral_smooth`&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../img/batch/spectral_smooth_plot.png" src="../img/batch/spectral_smooth_plot.png" />
<p>Notice how the <em>&quot;choppiness&quot;</em> of the spectral curve is lessened
after the smoothing operation. There are spectral regions that
perhaps had a lower <em>signal:noise</em> ratio and did not do particularlly
well at smoothing (i.e., &lt; 410 nm, ~770 nm, and ~820 nm). It may be
wise to perform <code class="docutils literal notranslate"><span class="pre">batch.spectral_smooth</span></code> <em>after</em>
<a class="reference external" href="hs_process.batch.html#hs_process.batch.spectral_clip">batch.spectral_clip</a>.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-hs_process.segment">
<span id="hs-process-segment-module"></span><h2>hs_process.segment module<a class="headerlink" href="#module-hs_process.segment" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="hs_process.segment.segment">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hs_process.segment.</span></code><code class="sig-name descname"><span class="pre">segment</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spyfile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/segment.html#segment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.segment.segment" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for aiding in the segmentation and/or masking of image
data to filter out pixels that are of least interest.</p>
<dl class="py method">
<dt id="hs_process.segment.segment.band_math_derivative">
<code class="sig-name descname"><span class="pre">band_math_derivative</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wl1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wl2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wl3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spyfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">list_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/segment.html#segment.band_math_derivative"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.segment.segment.band_math_derivative" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates a derivative-type spectral index from two input bands
and/or wavelengths. Bands/wavelengths can be input as two individual
bands, two sets of bands (i.e., list of bands), or range of bands
(i.e., list of two bands indicating the lower and upper range).</p>
<dl class="simple">
<dt>Definition:</dt><dd><p>array_der = (<code class="docutils literal notranslate"><span class="pre">wl1</span></code> - <code class="docutils literal notranslate"><span class="pre">wl2</span></code>) / (<code class="docutils literal notranslate"><span class="pre">wl2</span></code> - <code class="docutils literal notranslate"><span class="pre">wl3</span></code>)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wl1</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the wavelength (or set of
wavelengths) to be used as the first parameter of the
derivative index; if <code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all
bands between two wavelength values by calculating the mean
pixel value across all bands in that range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>wl2</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the wavelength (or set of
wavelengths) to be used as the second parameter of the
derivative index; if <code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all
bands between two wavelength values by calculating the mean
pixel value across all bands in that range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>wl3</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the wavelength (or set of
wavelengths) to be used as the third parameter of the
derivative index; if <code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all
bands between two wavelength values by calculating the mean
pixel value across all bands in that range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>b1</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the band (or set of bands) to
be used as the first parameter of the derivative index;
if <code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all bands between two band
values by calculating the mean pixel value across all bands in
that range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>b2</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the band (or set of bands) to
be used as the second parameter of the derivative index; if
<code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all bands between two band values
by calculating the mean pixel value across all bands in that
range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>b3</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the band (or set of bands) to
be used as the third parameter of the derivative index; if
<code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all bands between two band values
by calculating the mean pixel value across all bands in that
range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object or <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) -- The datacube to
process; if <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code>, loads band information
from <code class="docutils literal notranslate"><span class="pre">self.spyfile</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>list_range</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- Whether bands/wavelengths passed as a list
is interpreted as a range of bands (<code class="docutils literal notranslate"><span class="pre">True</span></code>) or for each
individual band in the list (<code class="docutils literal notranslate"><span class="pre">False</span></code>). If <code class="docutils literal notranslate"><span class="pre">list_range</span></code> is
<code class="docutils literal notranslate"><span class="pre">True</span></code>, <code class="docutils literal notranslate"><span class="pre">b1</span></code>/<code class="docutils literal notranslate"><span class="pre">wl1</span></code> and <code class="docutils literal notranslate"><span class="pre">b2</span></code>/<code class="docutils literal notranslate"><span class="pre">wl2</span></code> should be lists
with two items, and all bands/wavelegths between the two values
will be used (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>).</p></li>
<li><p><strong>print_out</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- Whether to print out the actual bands and
wavelengths being used in the NDI calculation (default:
<code class="docutils literal notranslate"><span class="pre">True</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>2-element <code class="docutils literal notranslate"><span class="pre">tuple</span></code> containing</p>
<ul class="simple">
<li><p><strong>array_der</strong> (<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>): Derivative band math array.</p></li>
<li><p><strong>metadata</strong> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>): Modified metadata describing the
derivative array (<code class="docutils literal notranslate"><span class="pre">array_der</span></code>).</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load <code class="docutils literal notranslate"><span class="pre">hsio</span></code> and <code class="docutils literal notranslate"><span class="pre">segment</span></code> modules</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">segment</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_segment</span> <span class="o">=</span> <span class="n">segment</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
</pre></div>
</div>
<p>Calculate the MERIS Terrestrial Chlorophyll Index (MTCI; Dash and
Curran, 2004) via <code class="docutils literal notranslate"><span class="pre">segment.band_math_derivative</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">array_mtci</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">my_segment</span><span class="o">.</span><span class="n">band_math_derivative</span><span class="p">(</span><span class="n">wl1</span><span class="o">=</span><span class="mi">754</span><span class="p">,</span> <span class="n">wl2</span><span class="o">=</span><span class="mi">709</span><span class="p">,</span> <span class="n">wl3</span><span class="o">=</span><span class="mi">681</span><span class="p">,</span> <span class="n">spyfile</span><span class="o">=</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
<span class="go">Band 1: [176]  Band 2: [154]  Band 3: [141]</span>
<span class="go">Wavelength 1: [753.84]  Wavelength 2: [708.6784]  Wavelength 3: [681.992]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">array_mtci</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(617, 1300)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">array_mtci</span><span class="p">)</span>
<span class="go">9.401104</span>
</pre></div>
</div>
<p>Show MTCI image via <code class="docutils literal notranslate"><span class="pre">hsio.show_img</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">show_img</span><span class="p">(</span><span class="n">array_mtci</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../img/segment/mtci.png" src="../img/segment/mtci.png" />
</dd></dl>

<dl class="py method">
<dt id="hs_process.segment.segment.band_math_mcari2">
<code class="sig-name descname"><span class="pre">band_math_mcari2</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wl1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wl2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wl3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spyfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">list_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/segment.html#segment.band_math_mcari2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.segment.segment.band_math_mcari2" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the MCARI2 (Modified Chlorophyll Absorption Ratio Index
Improved; Haboudane et al., 2004) spectral index from three input bands
and/or wavelengths. Bands/wavelengths can be input as two individual
bands, two sets of bands (i.e., list of bands), or range of bands
(i.e., list of two bands indicating the lower and upper range).</p>
<dl class="simple">
<dt>Definition:</dt><dd><p>array_mcari2 = ((1.5 * (2.5 * (<code class="docutils literal notranslate"><span class="pre">wl1</span></code> - <code class="docutils literal notranslate"><span class="pre">wl2</span></code>) - 1.3 * (<code class="docutils literal notranslate"><span class="pre">wl1</span></code> - <code class="docutils literal notranslate"><span class="pre">wl3</span></code>))) / np.sqrt((2 * <code class="docutils literal notranslate"><span class="pre">wl1</span></code> + 1)**2 - (6 * <code class="docutils literal notranslate"><span class="pre">wl1</span></code> - 5 * np.sqrt(<code class="docutils literal notranslate"><span class="pre">wl2</span></code>)) - 0.5))</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wl1</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the wavelength (or set of
wavelengths) to be used as the first parameter of the
MCARI2 index; if <code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all
bands between two wavelength values by calculating the mean
pixel value across all bands in that range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>wl2</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the wavelength (or set of
wavelengths) to be used as the second parameter of the
MCARI2 index; if <code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all
bands between two wavelength values by calculating the mean
pixel value across all bands in that range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>wl3</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the wavelength (or set of
wavelengths) to be used as the third parameter of the
MCARI2 index; if <code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all
bands between two wavelength values by calculating the mean
pixel value across all bands in that range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>b1</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the band (or set of bands) to
be used as the first parameter of the MCARI2 index;
if <code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all bands between two band
values by calculating the mean pixel value across all bands in
that range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>b2</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the band (or set of bands) to
be used as the second parameter of the MCARI2 index; if
<code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all bands between two band values
by calculating the mean pixel value across all bands in that
range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>b3</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the band (or set of bands) to
be used as the third parameter of the MCARI2 index; if
<code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all bands between two band values
by calculating the mean pixel value across all bands in that
range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object or <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) -- The datacube to
process; if <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code>, loads band information
from <code class="docutils literal notranslate"><span class="pre">self.spyfile</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>list_range</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- Whether bands/wavelengths passed as a list
is interpreted as a range of bands (<code class="docutils literal notranslate"><span class="pre">True</span></code>) or for each
individual band in the list (<code class="docutils literal notranslate"><span class="pre">False</span></code>). If <code class="docutils literal notranslate"><span class="pre">list_range</span></code> is
<code class="docutils literal notranslate"><span class="pre">True</span></code>, <code class="docutils literal notranslate"><span class="pre">b1</span></code>/<code class="docutils literal notranslate"><span class="pre">wl1</span></code> and <code class="docutils literal notranslate"><span class="pre">b2</span></code>/<code class="docutils literal notranslate"><span class="pre">wl2</span></code> should be lists
with two items, and all bands/wavelegths between the two values
will be used (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>).</p></li>
<li><p><strong>print_out</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- Whether to print out the actual bands and
wavelengths being used in the NDI calculation (default:
<code class="docutils literal notranslate"><span class="pre">True</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>2-element <code class="docutils literal notranslate"><span class="pre">tuple</span></code> containing</p>
<ul class="simple">
<li><p><strong>array_mcari2</strong> (<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>): MCARI2 spectral index band
math array.</p></li>
<li><p><strong>metadata</strong> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>): Modified metadata describing the
MCARI2 index array (<code class="docutils literal notranslate"><span class="pre">array_mcari2</span></code>).</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load <code class="docutils literal notranslate"><span class="pre">hsio</span></code> and <code class="docutils literal notranslate"><span class="pre">segment</span></code> modules</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">segment</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_segment</span> <span class="o">=</span> <span class="n">segment</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
</pre></div>
</div>
<p>Calculate the MCARI2 spectral index (Haboudane et al., 2004) via
<code class="docutils literal notranslate"><span class="pre">segment.band_math_mcari2</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">array_mcari2</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">my_segment</span><span class="o">.</span><span class="n">band_math_mcari2</span><span class="p">(</span><span class="n">wl1</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">wl2</span><span class="o">=</span><span class="mi">670</span><span class="p">,</span> <span class="n">wl3</span><span class="o">=</span><span class="mi">550</span><span class="p">,</span> <span class="n">spyfile</span><span class="o">=</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
<span class="go">Band 1: [198]  Band 2: [135]  Band 3: [77]</span>
<span class="go">Wavelength 1: [799.0016]  Wavelength 2: [669.6752]  Wavelength 3: [550.6128]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">array_mcari2</span><span class="p">)</span>
<span class="go">0.57376945</span>
</pre></div>
</div>
<p>Show MCARI2 image via <code class="docutils literal notranslate"><span class="pre">hsio.show_img</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">show_img</span><span class="p">(</span><span class="n">array_mcari2</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../img/segment/mcari2.png" src="../img/segment/mcari2.png" />
</dd></dl>

<dl class="py method">
<dt id="hs_process.segment.segment.band_math_ndi">
<code class="sig-name descname"><span class="pre">band_math_ndi</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wl1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wl2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spyfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">list_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/segment.html#segment.band_math_ndi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.segment.segment.band_math_ndi" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates a normalized difference spectral index from two input bands
and/or wavelengths. Bands/wavelengths can be input as two individual
bands, two sets of bands (i.e., list of bands), or range of bands
(i.e., list of two bands indicating the lower and upper range).</p>
<dl class="simple">
<dt>Definition:</dt><dd><p>array_ndi = (<code class="docutils literal notranslate"><span class="pre">wl1</span></code> - <code class="docutils literal notranslate"><span class="pre">wl2</span></code>) / (<code class="docutils literal notranslate"><span class="pre">wl1</span></code> + <code class="docutils literal notranslate"><span class="pre">wl2</span></code>)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wl1</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the wavelength (or set of
wavelengths) to be used as the first parameter of the
normalized difference index; if <code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all
bands between two wavelength values by calculating the mean
pixel value across all bands in that range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>wl2</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the wavelength (or set of
wavelengths) to be used as the second parameter of the
normalized difference index; if <code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all
bands between two wavelength values by calculating the mean
pixel value across all bands in that range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>b1</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the band (or set of bands) to be
used as the first parameter of the normalized difference index;
if <code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all bands between two band values
by calculating the mean pixel value across all bands in that
range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>b2</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the band (or set of bands) to be
used as the second parameter of the normalized difference
index; if <code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all bands between two band
values by calculating the mean pixel value across all bands in
that range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object or <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) -- The datacube to
process; if <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code>, loads band information from
<code class="docutils literal notranslate"><span class="pre">self.spyfile</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>list_range</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- Whether bands/wavelengths passed as a list is
interpreted as a range of bands (<code class="docutils literal notranslate"><span class="pre">True</span></code>) or for each individual
band in the list (<code class="docutils literal notranslate"><span class="pre">False</span></code>). If <code class="docutils literal notranslate"><span class="pre">list_range</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>,
<code class="docutils literal notranslate"><span class="pre">b1</span></code>/<code class="docutils literal notranslate"><span class="pre">wl1</span></code> and <code class="docutils literal notranslate"><span class="pre">b2</span></code>/<code class="docutils literal notranslate"><span class="pre">wl2</span></code> should be lists with two items, and
all bands/wavelegths between the two values will be used
(default: <code class="docutils literal notranslate"><span class="pre">True</span></code>).</p></li>
<li><p><strong>print_out</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- Whether to print out the actual bands and
wavelengths being used in the NDI calculation (default:
<code class="docutils literal notranslate"><span class="pre">True</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>2-element <code class="docutils literal notranslate"><span class="pre">tuple</span></code> containing</p>
<ul class="simple">
<li><p><strong>array_ndi</strong> (<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>): Normalized difference band
math array.</p></li>
<li><p><strong>metadata</strong> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>): Modified metadata describing the
normalized difference array (<code class="docutils literal notranslate"><span class="pre">array_ndi</span></code>).</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load <code class="docutils literal notranslate"><span class="pre">hsio</span></code> and <code class="docutils literal notranslate"><span class="pre">segment</span></code> modules</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">segment</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_segment</span> <span class="o">=</span> <span class="n">segment</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
</pre></div>
</div>
<p>Calculate the Normalized difference vegetation index using 10 nm
bands centered at 800 nm and 680 nm via <code class="docutils literal notranslate"><span class="pre">segment.band_math_ndi</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">array_ndvi</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">my_segment</span><span class="o">.</span><span class="n">band_math_ndi</span><span class="p">(</span><span class="n">wl1</span><span class="o">=</span><span class="p">[</span><span class="mi">795</span><span class="p">,</span> <span class="mi">805</span><span class="p">],</span> <span class="n">wl2</span><span class="o">=</span><span class="p">[</span><span class="mi">675</span><span class="p">,</span> <span class="mi">685</span><span class="p">],</span> <span class="n">spyfile</span><span class="o">=</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
<span class="go">Effective NDI: (800 - 680) / 800 + 680)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">array_ndvi</span><span class="p">)</span>
<span class="go">0.8184888</span>
</pre></div>
</div>
<p>Show NDVI image via <code class="docutils literal notranslate"><span class="pre">hsio.show_img</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">show_img</span><span class="p">(</span><span class="n">array_ndvi</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../img/segment/ndvi.png" src="../img/segment/ndvi.png" />
</dd></dl>

<dl class="py method">
<dt id="hs_process.segment.segment.band_math_ratio">
<code class="sig-name descname"><span class="pre">band_math_ratio</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wl1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wl2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spyfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">list_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/segment.html#segment.band_math_ratio"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.segment.segment.band_math_ratio" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates a simple ratio spectral index from two input band and/or
wavelengths. Bands/wavelengths can be input as two individual bands,
two sets of bands (i.e., list of bands), or a range of bands (i.e.,
list of two bands indicating the lower and upper range).</p>
<dl class="simple">
<dt>Definition:</dt><dd><p>array_ratio = (<code class="docutils literal notranslate"><span class="pre">wl1</span></code>/<code class="docutils literal notranslate"><span class="pre">wl2</span></code>)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wl1</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the wavelength (or set of
wavelengths) to be used as the first parameter of the
ratio index; if <code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all
bands between two wavelength values by calculating the mean
pixel value across all bands in that range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>wl2</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the wavelength (or set of
wavelengths) to be used as the second parameter of the
ratio index; if <code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all
bands between two wavelength values by calculating the mean
pixel value across all bands in that range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>b1</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the band (or set of bands) to
be used as the first parameter (numerator) of the ratio index;
if <code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all bands between two band
values by calculating the mean pixel value across all bands in
that range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>b2</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the bands (or set of bands)
to be used as the second parameter (denominator) of the ratio
index; if <code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all bands between two
bands values by calculating the mean pixel value across all
bands in that range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object or <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) -- The datacube to
process; if <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code>, loads band information
from <code class="docutils literal notranslate"><span class="pre">self.spyfile</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>list_range</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- Whether a band passed as a list is
interpreted as a range of bands (<code class="docutils literal notranslate"><span class="pre">True</span></code>) or for each
individual band in the list (<code class="docutils literal notranslate"><span class="pre">False</span></code>). If <code class="docutils literal notranslate"><span class="pre">list_range</span></code> is
<code class="docutils literal notranslate"><span class="pre">True</span></code>, <code class="docutils literal notranslate"><span class="pre">b1</span></code>/<code class="docutils literal notranslate"><span class="pre">wl1</span></code> and <code class="docutils literal notranslate"><span class="pre">b2</span></code>/<code class="docutils literal notranslate"><span class="pre">wl2</span></code> should be lists
with two items, and all bands/wavelegths between the two values
will be used (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>).</p></li>
<li><p><strong>print_out</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- Whether to print out the actual bands and
wavelengths being used in the NDI calculation (default:
<code class="docutils literal notranslate"><span class="pre">True</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>2-element <code class="docutils literal notranslate"><span class="pre">tuple</span></code> containing</p>
<ul class="simple">
<li><p><strong>array_ratio</strong> (<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>): Ratio band math array.</p></li>
<li><p><strong>metadata</strong> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>): Modified metadata describing the
ratio array (<code class="docutils literal notranslate"><span class="pre">array_ratio</span></code>).</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load <code class="docutils literal notranslate"><span class="pre">hsio</span></code> and <code class="docutils literal notranslate"><span class="pre">segment</span></code> modules</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">segment</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_segment</span> <span class="o">=</span> <span class="n">segment</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
</pre></div>
</div>
<p>Calculate a red/near-infrared band ratio using a range of bands
(i.e., mimicking a broadband sensor) via
<code class="docutils literal notranslate"><span class="pre">segment.band_math_ratio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">array_ratio</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">my_segment</span><span class="o">.</span><span class="n">band_math_ratio</span><span class="p">(</span><span class="n">wl1</span><span class="o">=</span><span class="p">[</span><span class="mi">630</span><span class="p">,</span> <span class="mi">690</span><span class="p">],</span> <span class="n">wl2</span><span class="o">=</span><span class="p">[</span><span class="mi">800</span><span class="p">,</span> <span class="mi">860</span><span class="p">],</span> <span class="n">list_range</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Effective band ratio: (659/830)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">array_ratio</span><span class="p">)</span>
<span class="go">0.10981177</span>
</pre></div>
</div>
<p>Notice that 29 spectral bands were consolidated (i.e., averaged) to
mimic a single broad band. We can take the mean of two bands by
changing <code class="docutils literal notranslate"><span class="pre">list_range</span></code> to <code class="docutils literal notranslate"><span class="pre">False</span></code>, and this slightly changes the
result.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">array_ratio</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">my_segment</span><span class="o">.</span><span class="n">band_math_ratio</span><span class="p">(</span><span class="n">wl1</span><span class="o">=</span><span class="p">[</span><span class="mi">630</span><span class="p">,</span> <span class="mi">690</span><span class="p">],</span> <span class="n">wl2</span><span class="o">=</span><span class="p">[</span><span class="mi">800</span><span class="p">,</span> <span class="mi">860</span><span class="p">],</span> <span class="n">list_range</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">Effective band ratio: (660/830)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">array_ratio</span><span class="p">)</span>
<span class="go">0.113607444</span>
</pre></div>
</div>
<p>Show the red/near-infrared ratio image via <code class="docutils literal notranslate"><span class="pre">hsio.show_img</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">show_img</span><span class="p">(</span><span class="n">array_ratio</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../img/segment/ratio_r_nir.png" src="../img/segment/ratio_r_nir.png" />
</dd></dl>

<dl class="py method">
<dt id="hs_process.segment.segment.composite_band">
<code class="sig-name descname"><span class="pre">composite_band</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wl1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spyfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">list_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/segment.html#segment.composite_band"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.segment.segment.composite_band" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates a composite band from a range of bands or wavelengths.
Bands/wavelengths can be input as individual bands, a set of bands
(i.e., list of bands), or a range of bands (i.e., list of two bands
indicating the lower and upper range).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wl1</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the wavelength (or set of
wavelengths) to consolidate; if <code class="docutils literal notranslate"><span class="pre">list</span></code>, then all wavelengths
between two wavelength values are consolidated by calculating
the mean pixel value across all wavelengths in that range
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>b1</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the band (or set of
bands) to consolidate; if <code class="docutils literal notranslate"><span class="pre">list</span></code>, then all bands
between two band values are consolidated by calculating
the mean pixel value across all bands in that range (default:
<code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object or <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) -- The datacube to
process; if <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code>, loads band information
from <code class="docutils literal notranslate"><span class="pre">self.spyfile</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>list_range</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- Whether a band passed as a list is
interpreted as a range of bands (<code class="docutils literal notranslate"><span class="pre">True</span></code>) or for each
individual band in the list (<code class="docutils literal notranslate"><span class="pre">False</span></code>). If <code class="docutils literal notranslate"><span class="pre">list_range</span></code> is
<code class="docutils literal notranslate"><span class="pre">True</span></code>, <code class="docutils literal notranslate"><span class="pre">b1</span></code>/<code class="docutils literal notranslate"><span class="pre">wl1</span></code> and <code class="docutils literal notranslate"><span class="pre">b2</span></code>/<code class="docutils literal notranslate"><span class="pre">wl2</span></code> should be lists
with two items, and all bands/wavelegths between the two values
will be used (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>).</p></li>
<li><p><strong>print_out</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- Whether to print out the actual bands and
wavelengths being used in the NDI calculation (default:
<code class="docutils literal notranslate"><span class="pre">True</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>2-element <code class="docutils literal notranslate"><span class="pre">tuple</span></code> containing</p>
<ul class="simple">
<li><p><strong>array_b1</strong> (<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>): Consolidated array.</p></li>
<li><p><strong>metadata</strong> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>): Modified metadata describing the
consolidated array (<code class="docutils literal notranslate"><span class="pre">array_b1</span></code>).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hs_process.segment.segment.load_spyfile">
<code class="sig-name descname"><span class="pre">load_spyfile</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spyfile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/segment.html#segment.load_spyfile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.segment.segment.load_spyfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a <code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> (Spectral Python object) for data access and/or
manipulation by the <code class="docutils literal notranslate"><span class="pre">hstools</span></code> class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object) -- The datacube being accessed and/or
manipulated.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load <code class="docutils literal notranslate"><span class="pre">hsio</span></code> and <code class="docutils literal notranslate"><span class="pre">segment</span></code> modules</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">segment</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_segment</span> <span class="o">=</span> <span class="n">segment</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
</pre></div>
</div>
<p>Load datacube  via <code class="docutils literal notranslate"><span class="pre">segment.load_spyfile</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">my_segment</span><span class="o">.</span><span class="n">load_spyfile</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_segment</span><span class="o">.</span><span class="n">spyfile</span>
<span class="go">Data Source:   &#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip&#39;</span>
<span class="go">    # Rows:            617</span>
<span class="go">    # Samples:        1300</span>
<span class="go">    # Bands:           240</span>
<span class="go">    Interleave:        BIP</span>
<span class="go">    Quantization:  32 bits</span>
<span class="go">    Data format:   float32</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-hs_process.spatial_mod">
<span id="hs-process-spatial-mod-module"></span><h2>hs_process.spatial_mod module<a class="headerlink" href="#module-hs_process.spatial_mod" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="hs_process.spatial_mod.spatial_mod">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hs_process.spatial_mod.</span></code><code class="sig-name descname"><span class="pre">spatial_mod</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spyfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gdf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/spatial_mod.html#spatial_mod"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.spatial_mod.spatial_mod" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for manipulating data within the spatial domain
(e.g., cropping a datacube by a geographical boundary).</p>
<dl class="py method">
<dt id="hs_process.spatial_mod.spatial_mod.crop_many_gdf">
<code class="sig-name descname"><span class="pre">crop_many_gdf</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spyfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gdf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/spatial_mod.html#spatial_mod.crop_many_gdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.spatial_mod.spatial_mod.crop_many_gdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Crops many plots from a single image by comparing the image to a
polygon file (<code class="docutils literal notranslate"><span class="pre">geopandas.GoeDataFrame</span></code>) that contains plot
information and geometry of plot boundaries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object, optional) -- The datacube to crop; if
<code class="docutils literal notranslate"><span class="pre">None</span></code>, loads datacube and band information from
<code class="docutils literal notranslate"><span class="pre">spatial_mod.spyfile</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>gdf</strong> (<code class="docutils literal notranslate"><span class="pre">geopandas.GeoDataFrame</span></code>, optional) -- the plot IDs and
polygon geometery of each of the plots; 'plot_id' must be used as
a column name to identify each of the plots, and should be an
integer; if <code class="docutils literal notranslate"><span class="pre">None</span></code>, loads geodataframe from
<code class="docutils literal notranslate"><span class="pre">spatial_mod.gdf</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>kwargs</strong> -- <p>Can be any of the keys in self.defaults.crop_defaults:
plot_id_ref (<code class="docutils literal notranslate"><span class="pre">int</span></code>, optional): the plot ID of the reference plot.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">plot_id_ref</span></code> is required if passing <code class="docutils literal notranslate"><span class="pre">pix_e_ul</span></code>,
<code class="docutils literal notranslate"><span class="pre">pix_n_ul</span></code>, or <code class="docutils literal notranslate"><span class="pre">n_plots</span></code> because it is used as the
reference point for any of the adjustments/modifications
dictated by said parameters. <code class="docutils literal notranslate"><span class="pre">plot_id_ref</span></code> must be present in
the <code class="docutils literal notranslate"><span class="pre">gdf</span></code>, and the extent of <code class="docutils literal notranslate"><span class="pre">plot_id_ref</span></code> must intersect
the extent of the datacube (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
</div></blockquote>
<dl class="simple">
<dt>pix_e_ul (<code class="docutils literal notranslate"><span class="pre">int</span></code>, optional): upper left pixel column (easting) of</dt><dd><p><code class="docutils literal notranslate"><span class="pre">plot_id_ref</span></code>; this is used to calculate the offset between
the GeoDataFrame geometry and the approximate image
georeference error (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
</dd>
<dt>pix_n_ul (<code class="docutils literal notranslate"><span class="pre">int</span></code>, optional): upper left pixel row (northing) of</dt><dd><p><code class="docutils literal notranslate"><span class="pre">plot_id_ref</span></code>; this is used to calculate the offset between
the GeoDataFrame geometry and the approximate image
georeference error (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
</dd>
<dt>crop_e_m (<code class="docutils literal notranslate"><span class="pre">float</span></code>, optional): length of each row (easting</dt><dd><p>direction) of the cropped image in map units (e.g., meters;
default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
</dd>
<dt>crop_n_m (<code class="docutils literal notranslate"><span class="pre">float</span></code>, optional): length of each column (northing</dt><dd><p>direction) of the cropped image in map units (e.g., meters;
default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p>
</dd>
<dt>crop_e_pix (<code class="docutils literal notranslate"><span class="pre">int</span></code>, optional): number of pixels in each row in the</dt><dd><p>cropped image (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
</dd>
<dt>crop_n_pix (<code class="docutils literal notranslate"><span class="pre">int</span></code>, optional): number of pixels in each column in</dt><dd><p>the cropped image (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
</dd>
<dt>buf_e_m (<code class="docutils literal notranslate"><span class="pre">float</span></code>, optional): The buffer distance in the easting</dt><dd><p>direction (in map units; e.g., meters) to be applied after
calculating the original crop area; the buffer is considered
after <code class="docutils literal notranslate"><span class="pre">crop_X_m</span></code> / <code class="docutils literal notranslate"><span class="pre">crop_X_pix</span></code>. A positive value will
reduce the size of <code class="docutils literal notranslate"><span class="pre">crop_X_m</span></code> / <code class="docutils literal notranslate"><span class="pre">crop_X_pix</span></code>, and a
negative value will increase it (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
</dd>
<dt>buf_n_m (<code class="docutils literal notranslate"><span class="pre">float</span></code>, optional): The buffer distance in the northing</dt><dd><p>direction (in map units; e.g., meters) to be applied after
calculating the original crop area; the buffer is considered
after <code class="docutils literal notranslate"><span class="pre">crop_X_m</span></code> / <code class="docutils literal notranslate"><span class="pre">crop_X_pix</span></code>. A positive value will
reduce the size of <code class="docutils literal notranslate"><span class="pre">crop_X_m</span></code> / <code class="docutils literal notranslate"><span class="pre">crop_X_pix</span></code>, and a
negative value will increase it (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
</dd>
<dt>buf_e_pix (<code class="docutils literal notranslate"><span class="pre">int</span></code>, optional): The buffer distance in the easting</dt><dd><p>direction (in pixel units) to be applied after calculating the
original crop area (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
</dd>
<dt>buf_n_pix (<code class="docutils literal notranslate"><span class="pre">int</span></code>, optional): The buffer distance in the northing</dt><dd><p>direction (in pixel units) to be applied after calculating the
original crop area (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
</dd>
<dt>gdf_shft_e_m (<code class="docutils literal notranslate"><span class="pre">float</span></code>): The distance to shift the cropped</dt><dd><p>datacube from the upper left/NW plot corner in the east
direction (negative value will shift to the west). Only
relevent when <code class="docutils literal notranslate"><span class="pre">gdf</span></code> is passed. This shift is applied after
the offset is applied from buf_X (default: 0.0).</p>
</dd>
<dt>gdf_shft_n_m (<code class="docutils literal notranslate"><span class="pre">float</span></code>): The distance to shift the cropped</dt><dd><p>datacube from the upper left/NW plot corner in the north
direction (negative value will shift to the south). Only
relevent when <code class="docutils literal notranslate"><span class="pre">gdf</span></code> is passed. This shift is applied after
the offset is applied from buf_X (default: 0.0).</p>
</dd>
<dt>gdf_shft_e_pix (<code class="docutils literal notranslate"><span class="pre">int</span></code>): The pixel units to shift the cropped</dt><dd><p>datacube from the upper left/NW plot corner in the east
direction (negative value will shift to the west). Only
relevent when <code class="docutils literal notranslate"><span class="pre">gdf</span></code> is passed. This shift is applied after
the offset is applied from buf_X (default: 0.0).</p>
</dd>
<dt>gdf_shft_n_pix (<code class="docutils literal notranslate"><span class="pre">int</span></code>): The pixel units to shift the cropped</dt><dd><p>datacube from the upper left/NW plot corner in the north
direction (negative value will shift to the south). Only
relevent when <code class="docutils literal notranslate"><span class="pre">gdf</span></code> is passed. This shift is applied after
the offset is applied from buf_X (default: 0.0).</p>
</dd>
<dt>n_plots (<code class="docutils literal notranslate"><span class="pre">int</span></code>, optional): number of plots to crop, starting with</dt><dd><p><code class="docutils literal notranslate"><span class="pre">plot_id_ref</span></code> and moving from West to East and North to
South. This can be used to limit the number of cropped plots
(default; <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>df_plots</strong> (<code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>) -- data for
which to crop each plot; includes 'plot_id_ref', 'pix_e_ul', and
'pix_n_ul' columns. This data can be passed to
<code class="docutils literal notranslate"><span class="pre">spatial_mod.crop_single</span></code> to perform the actual cropping.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <code class="docutils literal notranslate"><span class="pre">pix_e_ul</span></code> or <code class="docutils literal notranslate"><span class="pre">pix_n_ul</span></code> are passed, the pixel offset from
the northwest corner of <code class="docutils literal notranslate"><span class="pre">plot_id_ref</span></code> will be calculated. This
offset is then applied to all plots within the extent of the image
to systematically shift the actual upper left pixel locations for
each plot, effectively shifting the easting and/or northing
of the upper left pixel of the hyperspectral datacube to match that
of the <code class="docutils literal notranslate"><span class="pre">gdf</span></code>. If the shift should only apply to a select number
of plots, <code class="docutils literal notranslate"><span class="pre">n_plots</span></code> can be passed to restrict the number of plots
that are processed.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Either the pixel coordinate or the map unit coordinate should be
passed for <code class="docutils literal notranslate"><span class="pre">crop_X_Y</span></code> and <code class="docutils literal notranslate"><span class="pre">buf_X_Y</span></code> in each direction (i.e.,
easting and northing). Do not pass both.</p>
</div>
<p class="rubric">Example</p>
<p>Load the <code class="docutils literal notranslate"><span class="pre">hsio</span></code> and <code class="docutils literal notranslate"><span class="pre">spatial_mod</span></code> modules</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">spatial_mod</span>
</pre></div>
</div>
<p>Read datacube and spatial plot boundaries</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7_nohist-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fname_gdf</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\plot_bounds.geojson&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">fname_gdf</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_spatial_mod</span> <span class="o">=</span> <span class="n">spatial_mod</span><span class="p">(</span>
<span class="go">        io.spyfile, base_dir=io.base_dir, name_short=io.name_short,</span>
<span class="go">        name_long=io.name_long)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dir_out</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">base_dir</span><span class="p">,</span> <span class="s1">&#39;spatial_mod&#39;</span><span class="p">,</span> <span class="s1">&#39;crop_many_gdf&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">name_append</span> <span class="o">=</span> <span class="s1">&#39;-crop-many-gdf&#39;</span>
</pre></div>
</div>
<p>Get instructions on how plots should be cropped via
<code class="docutils literal notranslate"><span class="pre">spatial_mod.crop_many_gdf()</span></code>; note that a <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>
is returned with information describing how each plot should be
cropped.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df_plots</span> <span class="o">=</span> <span class="n">my_spatial_mod</span><span class="o">.</span><span class="n">crop_many_gdf</span><span class="p">(</span><span class="n">spyfile</span><span class="o">=</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">,</span> <span class="n">gdf</span><span class="o">=</span><span class="n">gdf</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_plots</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">    plot_id_ref  pix_e_ul  pix_n_ul  crop_e_pix  crop_n_pix</span>
<span class="go">0          1018       478         0         229          76</span>
<span class="go">1           918       707         0         229          76</span>
<span class="go">2           818       936         0         229          76</span>
<span class="go">3           718      1165         0         229          76</span>
<span class="go">4           618      1394         0         229          76</span>
<span class="gp">...</span>
</pre></div>
</div>
<p>Use the data from the first row of df_plots to crop a single plot
from the original image (uses spatial_mod.crop_single)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pix_e_ul</span><span class="o">=</span><span class="mi">113</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pix_n_ul</span><span class="o">=</span><span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crop_e_pix</span><span class="o">=</span><span class="mi">229</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crop_n_pix</span><span class="o">=</span><span class="mi">75</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_id_ref</span><span class="o">=</span><span class="mi">1018</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array_crop</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">my_spatial_mod</span><span class="o">.</span><span class="n">crop_single</span><span class="p">(</span>
<span class="go">        pix_e_ul=pix_e_ul, pix_n_ul=pix_n_ul, crop_e_pix=crop_e_pix, crop_n_pix=crop_n_pix,</span>
<span class="go">        spyfile=io.spyfile, plot_id_ref=plot_id_ref)</span>
</pre></div>
</div>
<p>Save the cropped datacube and geotiff to a new directory</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fname_out</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_out</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">name_short</span> <span class="o">+</span> <span class="s1">&#39;_plot_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mi">1018</span><span class="p">)</span> <span class="o">+</span> <span class="n">name_append</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">io</span><span class="o">.</span><span class="n">defaults</span><span class="o">.</span><span class="n">envi_write</span><span class="o">.</span><span class="n">interleave</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_out_tif</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_out</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">name_short</span> <span class="o">+</span> <span class="s1">&#39;_plot_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mi">1018</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.tif&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">write_cube</span><span class="p">(</span><span class="n">fname_out</span><span class="p">,</span> <span class="n">array_crop</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">write_tif</span><span class="p">(</span><span class="n">fname_out_tif</span><span class="p">,</span> <span class="n">spyfile</span><span class="o">=</span><span class="n">array_crop</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">)</span>
<span class="go">Saving F:\nigo0024\Documents\hs_process_demo\spatial_mod\crop_many_gdf\Wells_rep2_20180628_16h56m_pika_gige_7_plot_1018-crop-many-gdf.bip</span>
<span class="go">Either `projection_out` is `None` or `geotransform_out` is `None` (or both are). Retrieving projection and geotransform information by loading `hsio.fname_in` via GDAL. Be sure this is appropriate for the data you are trying to write.</span>
</pre></div>
</div>
<p>Using a for loop, use <code class="docutils literal notranslate"><span class="pre">spatial_mod.crop_single</span></code> and
<code class="docutils literal notranslate"><span class="pre">hsio.write_cube</span></code> to crop by plot and save cropped datacubes to
file</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df_plots</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">io</span><span class="o">.</span><span class="n">read_cube</span><span class="p">(</span><span class="n">fname_in</span><span class="p">,</span> <span class="n">name_long</span><span class="o">=</span><span class="n">io</span><span class="o">.</span><span class="n">name_long</span><span class="p">,</span>
<span class="go">                     name_plot=row[&#39;plot_id_ref&#39;],</span>
<span class="go">                     name_short=io.name_short)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">my_spatial_mod</span><span class="o">.</span><span class="n">load_spyfile</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">array_crop</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">my_spatial_mod</span><span class="o">.</span><span class="n">crop_single</span><span class="p">(</span>
<span class="go">                pix_e_ul=row[&#39;pix_e_ul&#39;], pix_n_ul=row[&#39;pix_n_ul&#39;],</span>
<span class="go">                crop_e_pix=row[&#39;crop_e_pix&#39;], crop_n_pix=row[&#39;crop_n_pix&#39;],</span>
<span class="go">                buf_e_m=2.0, buf_n_m=0.75,</span>
<span class="go">                plot_id_ref=row[&#39;plot_id_ref&#39;])</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">fname_out</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_out</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">name_short</span> <span class="o">+</span> <span class="s1">&#39;_plot_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;plot_id_ref&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="n">name_append</span> <span class="o">+</span> <span class="s1">&#39;.bip.hdr&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">fname_out_tif</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_out</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">name_short</span> <span class="o">+</span> <span class="s1">&#39;_plot_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;plot_id_ref&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;.tif&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">io</span><span class="o">.</span><span class="n">write_cube</span><span class="p">(</span><span class="n">fname_out</span><span class="p">,</span> <span class="n">array_crop</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># force=True to overwrite the plot_1018 image</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">io</span><span class="o">.</span><span class="n">write_tif</span><span class="p">(</span><span class="n">fname_out_tif</span><span class="p">,</span> <span class="n">spyfile</span><span class="o">=</span><span class="n">array_crop</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">)</span>
<span class="go">Saving F:\nigo0024\Documents\hs_process_demo\crop_many_gdf\Wells_rep2_20180628_16h56m_pika_gige_7_plot_1018.bip</span>
<span class="go">Saving F:\nigo0024\Documents\hs_process_demo\crop_many_gdf\Wells_rep2_20180628_16h56m_pika_gige_7_plot_918.bip</span>
<span class="go">Saving F:\nigo0024\Documents\hs_process_demo\crop_many_gdf\Wells_rep2_20180628_16h56m_pika_gige_7_plot_818.bip</span>
<span class="go">Saving F:\nigo0024\Documents\hs_process_demo\crop_many_gdf\Wells_rep2_20180628_16h56m_pika_gige_7_plot_718.bip</span>
<span class="go">Saving F:\nigo0024\Documents\hs_process_demo\crop_many_gdf\Wells_rep2_20180628_16h56m_pika_gige_7_plot_618.bip</span>
<span class="go">Saving F:\nigo0024\Documents\hs_process_demo\crop_many_gdf\Wells_rep2_20180628_16h56m_pika_gige_7_plot_1017.bip</span>
<span class="go">Saving F:\nigo0024\Documents\hs_process_demo\crop_many_gdf\Wells_rep2_20180628_16h56m_pika_gige_7_plot_917.bip</span>
<span class="go">Saving F:\nigo0024\Documents\hs_process_demo\crop_many_gdf\Wells_rep2_20180628_16h56m_pika_gige_7_plot_817.bip</span>
<span class="go">Saving F:\nigo0024\Documents\hs_process_demo\crop_many_gdf\Wells_rep2_20180628_16h56m_pika_gige_7_plot_717.bip</span>
<span class="go">Saving F:\nigo0024\Documents\hs_process_demo\crop_many_gdf\Wells_rep2_20180628_16h56m_pika_gige_7_plot_617.bip</span>
<span class="gp">...</span>
</pre></div>
</div>
<p>Open cropped geotiff images in QGIS to visualize the extent of the
cropped images compared to the original datacube and the plot
boundaries (the full extent image is darkened and displayed in the
background:</p>
<img alt="../img/spatial_mod/crop_many_gdf_qgis.png" src="../img/spatial_mod/crop_many_gdf_qgis.png" />
</dd></dl>

<dl class="py method">
<dt id="hs_process.spatial_mod.spatial_mod.crop_single">
<code class="sig-name descname"><span class="pre">crop_single</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pix_e_ul</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pix_n_ul</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop_e_pix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop_n_pix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop_e_m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop_n_m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buf_e_pix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buf_n_pix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buf_e_m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buf_n_m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spyfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_id_ref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gdf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gdf_shft_e_pix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gdf_shft_n_pix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gdf_shft_e_m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gdf_shft_n_m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_append</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spatial-crop-single'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/spatial_mod.html#spatial_mod.crop_single"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.spatial_mod.spatial_mod.crop_single" title="Permalink to this definition">¶</a></dt>
<dd><p>Crops a single plot from an image. If <code class="docutils literal notranslate"><span class="pre">plot_id_ref</span></code> and <code class="docutils literal notranslate"><span class="pre">gdf</span></code> are
explicitly passed (i.e., they will not be loaded from <code class="docutils literal notranslate"><span class="pre">spatial_mod</span></code>
class), the &quot;map info&quot; tag in the metadata will be adjusted to center
the cropped area within the appropriate plot geometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pix_e_ul</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, optional) -- upper left pixel column (easting) to
begin cropping (default: 0).</p></li>
<li><p><strong>pix_n_ul</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, optional) -- upper left pixel row (northing) to
begin cropping (default: 0).</p></li>
<li><p><strong>crop_e_m</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>, optional) -- length of each row (easting
direction) of the cropped image in map units (e.g., meters;
default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>crop_n_m</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>, optional) -- length of each column (northing
direction) of the cropped image in map units (e.g., meters;
default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
<li><p><strong>crop_e_pix</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, optional) -- number of pixels in each row in the
cropped image (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>crop_n_pix</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, optional) -- number of pixels in each column in
the cropped image (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>buf_e_m</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>, optional) -- The buffer distance in the easting
direction (in map units; e.g., meters) to be applied after
calculating the original crop area; the buffer is considered
after <code class="docutils literal notranslate"><span class="pre">crop_X_m</span></code> / <code class="docutils literal notranslate"><span class="pre">crop_X_pix</span></code>. A positive value will
reduce the size of <code class="docutils literal notranslate"><span class="pre">crop_X_m</span></code> / <code class="docutils literal notranslate"><span class="pre">crop_X_pix</span></code>, and a
negative value will increase it (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>buf_n_m</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>, optional) -- The buffer distance in the northing
direction (in map units; e.g., meters) to be applied after
calculating the original crop area; the buffer is considered
after <code class="docutils literal notranslate"><span class="pre">crop_X_m</span></code> / <code class="docutils literal notranslate"><span class="pre">crop_X_pix</span></code>. A positive value will
reduce the size of <code class="docutils literal notranslate"><span class="pre">crop_X_m</span></code> / <code class="docutils literal notranslate"><span class="pre">crop_X_pix</span></code>, and a
negative value will increase it (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>buf_e_pix</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, optional) -- The buffer distance in the easting
direction (in pixel units) to be applied after calculating the
original crop area (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>buf_n_pix</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, optional) -- The buffer distance in the northing
direction (in pixel units) to be applied after calculating the
original crop area (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object or <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) -- The datacube to
crop; if <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code>, loads band information from
<code class="docutils literal notranslate"><span class="pre">self.spyfile</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>plot_id_ref</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- the plot ID of the area to be cropped
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>gdf</strong> (<code class="docutils literal notranslate"><span class="pre">geopandas.GeoDataFrame</span></code>) -- the plot names and polygon
geometery of each of the plots; 'plot_id' must be used as a column
name to identify each of the plots, and should be an integer.</p></li>
<li><p><strong>gdf_shft_e_m</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>) -- The distance to shift the cropped
datacube from the upper left/NW plot corner in the east
direction (negative value will shift to the west). Only
relevent when <code class="docutils literal notranslate"><span class="pre">gdf</span></code> is passed. This shift is applied after
the offset is applied from buf_X (default: 0.0).</p></li>
<li><p><strong>gdf_shft_n_m</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>) -- The distance to shift the cropped
datacube from the upper left/NW plot corner in the north
direction (negative value will shift to the south). Only
relevent when <code class="docutils literal notranslate"><span class="pre">gdf</span></code> is passed. This shift is applied after
the offset is applied from buf_X (default: 0.0).</p></li>
<li><p><strong>gdf_shft_e_pix</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- The pixel units to shift the cropped
datacube from the upper left/NW plot corner in the east
direction (negative value will shift to the west). Only
relevent when <code class="docutils literal notranslate"><span class="pre">gdf</span></code> is passed. This shift is applied after
the offset is applied from buf_X (default: 0.0).</p></li>
<li><p><strong>gdf_shft_n_pix</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- The pixel units to shift the cropped
datacube from the upper left/NW plot corner in the north
direction (negative value will shift to the south). Only
relevent when <code class="docutils literal notranslate"><span class="pre">gdf</span></code> is passed. This shift is applied after
the offset is applied from buf_X (default: 0.0).</p></li>
<li><p><strong>name_append</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- NOT YET SUPPORTED; name to append to the
filename (default: 'spatial-crop-single').</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>2-element <code class="docutils literal notranslate"><span class="pre">tuple</span></code> containing</p>
<ul class="simple">
<li><p><strong>array_crop</strong> (<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>): Cropped datacube.</p></li>
<li><p><strong>metadata</strong> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>): Modified metadata describing the cropped
hyperspectral datacube (<code class="docutils literal notranslate"><span class="pre">array_crop</span></code>).</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize the <code class="docutils literal notranslate"><span class="pre">hsio</span></code> and <code class="docutils literal notranslate"><span class="pre">spatial_mod</span></code> modules</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">spatial_mod</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_spatial_mod</span> <span class="o">=</span> <span class="n">spatial_mod</span><span class="p">(</span>
<span class="go">        io.spyfile, base_dir=io.base_dir, name_short=io.name_short,</span>
<span class="go">        name_long=io.name_long)</span>
</pre></div>
</div>
<p>Crop an area with a width (easting) <em>200 pixels</em> and a height
(northing) of <em>50 pixels</em>, with a northwest/upper left origin at
the <em>342nd column</em> (easting) and <em>75th row</em> (northing).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pix_e_ul</span> <span class="o">=</span> <span class="mi">342</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pix_n_ul</span> <span class="o">=</span> <span class="mi">75</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array_crop</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">my_spatial_mod</span><span class="o">.</span><span class="n">crop_single</span><span class="p">(</span><span class="n">pix_e_ul</span><span class="p">,</span> <span class="n">pix_n_ul</span><span class="p">,</span> <span class="n">crop_e_pix</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">crop_n_pix</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
<p>Save as a geotiff using <code class="docutils literal notranslate"><span class="pre">io.write_tif</span></code>, then load into QGIS to
visualize.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fname_tif</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\spatial_mod\crop_single\crop_single.tif&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">write_tif</span><span class="p">(</span><span class="n">fname_tif</span><span class="p">,</span> <span class="n">array_crop</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">)</span>
<span class="go">Either `projection_out` is `None` or `geotransform_out` is `None` (or both are). Retrieving projection and geotransform information by loading `hsio.fname_in` via GDAL. Be sure this is appropriate for the data you are trying to write.</span>
</pre></div>
</div>
<p>Open cropped geotiff image in QGIS to visualize the extent of the
cropped image compared to the original datacube and the plot
boundaries (the full extent image is darkened and displayed in the
background):</p>
<img alt="../img/spatial_mod/crop_single_qgis.png" src="../img/spatial_mod/crop_single_qgis.png" />
</dd></dl>

<dl class="py method">
<dt id="hs_process.spatial_mod.spatial_mod.load_spyfile">
<code class="sig-name descname"><span class="pre">load_spyfile</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spyfile</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/spatial_mod.html#spatial_mod.load_spyfile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.spatial_mod.spatial_mod.load_spyfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a <code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> (Spectral Python object) for data access and/or
manipulation by the <code class="docutils literal notranslate"><span class="pre">hstools</span></code> class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object) -- The datacube being accessed and/or
manipulated.</p></li>
<li><p><strong>base_dir</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- to be used by the plot gdf attribute data.</p></li>
<li><p><strong>name_short</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- to be used by the plot gdf attribute data.</p></li>
<li><p><strong>name_long</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- to be used by the plot gdf attribute data.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize the <code class="docutils literal notranslate"><span class="pre">hsio</span></code> and <code class="docutils literal notranslate"><span class="pre">spatial_mod</span></code> modules</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">spatial_mod</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_spatial_mod</span> <span class="o">=</span> <span class="n">spatial_mod</span><span class="p">(</span>
<span class="go">        io.spyfile, base_dir=io.base_dir, name_short=io.name_short,</span>
<span class="go">        name_long=io.name_long)</span>
</pre></div>
</div>
<p>Load datacube using <code class="docutils literal notranslate"><span class="pre">spatial_mod.load_spyfile</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">my_spatial_mod</span><span class="o">.</span><span class="n">load_spyfile</span><span class="p">(</span>
<span class="go">        io.spyfile, base_dir=io.base_dir, name_short=io.name_short,</span>
<span class="go">        name_long=io.name_long)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_spatial_mod</span><span class="o">.</span><span class="n">spyfile</span>
<span class="go">Data Source:   &#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip&#39;</span>
<span class="go">    # Rows:            617</span>
<span class="go">    # Samples:        1300</span>
<span class="go">    # Bands:           240</span>
<span class="go">    Interleave:        BIP</span>
<span class="go">    Quantization:  32 bits</span>
<span class="go">    Data format:   float32</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-hs_process.spec_mod">
<span id="hs-process-spec-mod-module"></span><h2>hs_process.spec_mod module<a class="headerlink" href="#module-hs_process.spec_mod" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="hs_process.spec_mod.spec_mod">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hs_process.spec_mod.</span></code><code class="sig-name descname"><span class="pre">spec_mod</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spyfile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/spec_mod.html#spec_mod"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.spec_mod.spec_mod" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for manipulating data within the spectral domain, which
is usually pixel-based.</p>
<dl class="py method">
<dt id="hs_process.spec_mod.spec_mod.load_spyfile">
<code class="sig-name descname"><span class="pre">load_spyfile</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spyfile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/spec_mod.html#spec_mod.load_spyfile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.spec_mod.spec_mod.load_spyfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a <code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> (Spectral Python object) for data access and/or
manipulation by the <code class="docutils literal notranslate"><span class="pre">hstools</span></code> class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object) -- The datacube being accessed and/or
manipulated.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize the <code class="docutils literal notranslate"><span class="pre">hsio</span></code> and <code class="docutils literal notranslate"><span class="pre">spec_mod</span></code> modules</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">spec_mod</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_spec_mod</span> <span class="o">=</span> <span class="n">spec_mod</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
</pre></div>
</div>
<p>Load datacube</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">my_spec_mod</span><span class="o">.</span><span class="n">load_spyfile</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_spec_mod</span><span class="o">.</span><span class="n">spyfile</span>
<span class="go">Data Source:   &#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip&#39;</span>
<span class="go">    # Rows:            617</span>
<span class="go">    # Samples:        1300</span>
<span class="go">    # Bands:           240</span>
<span class="go">    Interleave:        BIP</span>
<span class="go">    Quantization:  32 bits</span>
<span class="go">    Data format:   float32</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hs_process.spec_mod.spec_mod.spec_derivative">
<code class="sig-name descname"><span class="pre">spec_derivative</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spyfile_spec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/spec_mod.html#spec_mod.spec_derivative"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.spec_mod.spec_mod.spec_derivative" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the numeric derivative spectra from spyfile_spec.</p>
<p>The derivavative spectra is calculated as the slope (rise over run) of
the input spectra, and is normalized by the wavelength unit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spyfile_spec</strong> -- The spectral spyfile object to calculate the
derivative for.</p></li>
<li><p><strong>order</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- The order of the derivative (default: 1).</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">spec_mod</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_hdr_spec</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;Wells_rep2_20180628_16h56m_pika_gige_7_plot_611-cube-to-spec-mean.spec.hdr&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">read_spec</span><span class="p">(</span><span class="n">fname_hdr_spec</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_spec_mod</span> <span class="o">=</span> <span class="n">spec_mod</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile_spec</span><span class="p">)</span>
</pre></div>
</div>
<p>Calculate the numeric derivative.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">spec_dydx</span><span class="p">,</span> <span class="n">metadata_dydx</span> <span class="o">=</span> <span class="n">my_spec_mod</span><span class="o">.</span><span class="n">spec_derivative</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">write_spec</span><span class="p">(</span><span class="s1">&#39;spec_derivative_order-1.spec.hdr&#39;</span><span class="p">,</span> <span class="n">spec_dydx</span><span class="p">,</span> <span class="n">df_std</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata_dydx</span><span class="p">)</span>
</pre></div>
</div>
<p>Plot the numeric derivative spectra and compare against the original spectra.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;ticks&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wl_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">metadata_dydx</span><span class="p">[</span><span class="s1">&#39;wavelength&#39;</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_ref</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">spyfile_spec</span><span class="o">.</span><span class="n">open_memmap</span><span class="p">()[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,:]</span><span class="o">*</span><span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">wl_x</span><span class="p">,</span> <span class="n">y_ref</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">wl_x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">wl_x</span><span class="p">,</span> <span class="n">spec_dydx</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,:]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavelength (nm)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Reflectance (%)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Reflectance derivative (%)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;API Example: `hstools.spec_derivative`&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hs_process.spec_mod.spec_mod.spectral_clip">
<code class="sig-name descname"><span class="pre">spectral_clip</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wl_bands</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[[0,</span> <span class="pre">420],</span> <span class="pre">[760,</span> <span class="pre">776],</span> <span class="pre">[813,</span> <span class="pre">827],</span> <span class="pre">[880,</span> <span class="pre">1000]]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spyfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/spec_mod.html#spec_mod.spectral_clip"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.spec_mod.spec_mod.spectral_clip" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes/clips designated wavelength bands from the hyperspectral
datacube.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wl_bands</strong> (<code class="docutils literal notranslate"><span class="pre">list</span></code> or <code class="docutils literal notranslate"><span class="pre">list</span></code> of <code class="docutils literal notranslate"><span class="pre">lists</span></code>) -- minimum and maximum
wavelenths to clip from image; if multiple groups of
wavelengths should be cut, this should be a list of lists. For
example, wl_bands=[760, 776] will clip all bands greater than
760.0 nm and less than 776.0 nm;
wl_bands = [[0, 420], [760, 776], [813, 827], [880, 1000]]
will clip all band less than 420.0 nm, bands greater than 760.0
nm and less than 776.0 nm, bands greater than 813.0 nm and less
than 827.0 nm, and bands greater than 880 nm (default).</p></li>
<li><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object or <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) -- The data cube to
clip; if <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code>, loads band information
from <code class="docutils literal notranslate"><span class="pre">spec_mod.spyfile</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>2-element <code class="docutils literal notranslate"><span class="pre">tuple</span></code> containing</p>
<ul class="simple">
<li><p><strong>array_clip</strong> (<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>): Clipped datacube.</p></li>
<li><p><strong>metadata</strong> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>): Modified metadata describing the clipped
hyperspectral datacube (<code class="docutils literal notranslate"><span class="pre">array_clip</span></code>).</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code> and <code class="docutils literal notranslate"><span class="pre">spec_mod</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">spec_mod</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_hdr</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">read_cube</span><span class="p">(</span><span class="n">fname_hdr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_spec_mod</span> <span class="o">=</span> <span class="n">spec_mod</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
</pre></div>
</div>
<p>Using <code class="docutils literal notranslate"><span class="pre">spec_mod.spectral_clip</span></code>, clip all spectral bands below
<em>420 nm</em> and above <em>880 nm</em>, as well as the bands near the oxygen
absorption (i.e., <em>760-776 nm</em>) and water absorption
(i.e., <em>813-827 nm</em>) regions.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">array_clip</span><span class="p">,</span> <span class="n">metadata_clip</span> <span class="o">=</span> <span class="n">my_spec_mod</span><span class="o">.</span><span class="n">spectral_clip</span><span class="p">(</span>
<span class="go">        wl_bands=[[0, 420], [760, 776], [813, 827], [880, 1000]])</span>
</pre></div>
</div>
<p>Plot the spectra of the unclippe hyperspectral image and compare to that of the clipped image for a single pixel.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ast</span> <span class="kn">import</span> <span class="n">literal_eval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spy_hs</span> <span class="o">=</span> <span class="n">my_spec_mod</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">open_memmap</span><span class="p">()</span>  <span class="c1"># datacube before smoothing</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">meta_bands</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">meta_bands</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">meta_bands_clip</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">literal_eval</span><span class="p">(</span><span class="n">metadata_clip</span><span class="p">[</span><span class="s1">&#39;wavelength&#39;</span><span class="p">])])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">spy_hs</span><span class="p">[</span><span class="mi">200</span><span class="p">][</span><span class="mi">800</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Before spectral clipping&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands_clip</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">array_clip</span><span class="p">[</span><span class="mi">200</span><span class="p">][</span><span class="mi">800</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;After spectral clipping&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavelength (nm)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Reflectance (%)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;API Example: `spec_mod.spectral_clip`&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../img/spec_mod/spectral_clip.png" src="../img/spec_mod/spectral_clip.png" />
</dd></dl>

<dl class="py method">
<dt id="hs_process.spec_mod.spec_mod.spectral_mimic">
<code class="sig-name descname"><span class="pre">spectral_mimic</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sensor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sentinel-2a'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_band_response</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_wl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wl_nm'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_wl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'peak'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spyfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/spec_mod.html#spec_mod.spectral_mimic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.spec_mod.spec_mod.spectral_mimic" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Mimics the response of a multispectral sensor based on transmissivity
of sensor bands across a range of wavelength values by calculating its
weighted average response and interpolating the hyperspectral response.</p>
<dl>
<dt>Parameters:</dt><dd><dl class="simple">
<dt>sensor (<code class="docutils literal notranslate"><span class="pre">str</span></code>): Should be one of</dt><dd><p>[&quot;sentera_6x&quot;, &quot;micasense_rededge_3&quot;, &quot;sentinel-2a&quot;,
&quot;sentinel-2b&quot;, &quot;custom&quot;]; if &quot;custom&quot;, <code class="docutils literal notranslate"><span class="pre">df_band_response</span></code>
and <code class="docutils literal notranslate"><span class="pre">col_wl</span></code> must be passed.</p>
</dd>
<dt>df_band_response (<code class="docutils literal notranslate"><span class="pre">pd.DataFrame</span></code>): A DataFrame that contains the</dt><dd><p>transmissivity (%) for each sensor band (as columns) mapped to
the continuous wavelength values (as rows). Required if
<code class="docutils literal notranslate"><span class="pre">sensor</span></code> is  &quot;custom&quot;, ignored otherwise.</p>
</dd>
<dt>col_wl (<code class="docutils literal notranslate"><span class="pre">str</span></code>): The column of <code class="docutils literal notranslate"><span class="pre">df_band_response</span></code> denoting the</dt><dd><p>wavlengths (default: 'wl_nm').</p>
</dd>
<dt>center_wl (<code class="docutils literal notranslate"><span class="pre">str</span></code>): Indicates how the center wavelength of each</dt><dd><p>band is determined. If <code class="docutils literal notranslate"><span class="pre">center_wl</span></code> is &quot;peak&quot;, the point at
which transmissivity is at its maximum is used as the center
wavelength. If <code class="docutils literal notranslate"><span class="pre">center_wl</span></code> is &quot;weighted&quot;, the weighted
average is used to compute the center wavelength. Must be one
of [&quot;peak&quot;, &quot;weighted&quot;] (<code class="docutils literal notranslate"><span class="pre">default:</span> <span class="pre">&quot;peak&quot;</span></code>).</p>
</dd>
<dt>spyfile (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object): The datacube being accessed and/or</dt><dd><p>manipulated.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>2-element <code class="docutils literal notranslate"><span class="pre">tuple</span></code> containing</p>
<ul class="simple">
<li><p><strong>array_multi</strong> (<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>): Mimicked datacube.</p></li>
<li><p><strong>metadata</strong> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>): Modified metadata describing the
mimicked spectral array (<code class="docutils literal notranslate"><span class="pre">array_multi</span></code>).</p></li>
</ul>
</dd>
<dt>Example:</dt><dd><p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code> and <code class="docutils literal notranslate"><span class="pre">spec_mod</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">spec_mod</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_hdr</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data_dir2</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;G:\BBE\AGROBOT\Shared Work\hs_process_results\data</span>
</pre></div>
</div>
</dd>
</dl>
</div></blockquote>
<dl>
<dt>ef_closest_panelcrop_plot'</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fname_hdr</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir2</span><span class="p">,</span> <span class="s1">&#39;study_aerffield_date_20190708_plot_5110-crop-plot.bip.hdr&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">open_memmap</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">read_cube</span><span class="p">(</span><span class="n">fname_hdr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_spec_mod</span> <span class="o">=</span> <span class="n">spec_mod</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
</pre></div>
</div>
<p>Use spec_mod.spectral_mimic to mimic the Sentinel-2A spectral
response function.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">array_s2a</span><span class="p">,</span> <span class="n">metadata_s2a</span> <span class="o">=</span> <span class="n">my_spec_mod</span><span class="o">.</span><span class="n">spectral_mimic</span><span class="p">(</span><span class="n">sensor</span><span class="o">=</span><span class="s1">&#39;sentinel-2a&#39;</span><span class="p">,</span> <span class="n">center_wl</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Plot the mean spectral response of the hyperspectral image to that
of the mimicked Sentinel-2A image bands (mean calculated across the
entire image).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ast</span> <span class="kn">import</span> <span class="n">literal_eval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spy_hs</span> <span class="o">=</span> <span class="n">my_spec_mod</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">open_memmap</span><span class="p">()</span>  <span class="c1"># datacube before smoothing</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">meta_bands</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">meta_bands</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">meta_bands_s2a</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">literal_eval</span><span class="p">(</span><span class="n">metadata_s2a</span><span class="p">[</span><span class="s1">&#39;wavelength&#39;</span><span class="p">])])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">spy_hs</span><span class="p">[</span><span class="mi">200</span><span class="p">][</span><span class="mi">800</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Hyperspectral (Pika II)&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands_s2a</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">array_s2a</span><span class="p">[</span><span class="mi">200</span><span class="p">][</span><span class="mi">800</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sentinel-2A &quot;mimic&quot;&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavelength (nm)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Reflectance (%)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;API Example: `spec_mod.spectral_mimic`&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../img/spec_mod/spectral_mimic_sentinel-2a.png" src="../img/spec_mod/spectral_mimic_sentinel-2a.png" />
<p>Use spec_mod.spectral_mimic to mimic the Sentera 6x spectral configuration and compare to both hyperspectral and Sentinel-2A.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">array_6x</span><span class="p">,</span> <span class="n">metadata_6x</span> <span class="o">=</span> <span class="n">my_spec_mod</span><span class="o">.</span><span class="n">spectral_mimic</span><span class="p">(</span><span class="n">sensor</span><span class="o">=</span><span class="s1">&#39;sentera_6x&#39;</span><span class="p">,</span> <span class="n">center_wl</span><span class="o">=</span><span class="s1">&#39;peak&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">meta_bands_6x</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">literal_eval</span><span class="p">(</span><span class="n">metadata_6x</span><span class="p">[</span><span class="s1">&#39;wavelength&#39;</span><span class="p">])])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">spy_hs</span><span class="p">[</span><span class="mi">200</span><span class="p">][</span><span class="mi">800</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Hyperspectral (Pika II)&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands_s2a</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">array_s2a</span><span class="p">[</span><span class="mi">200</span><span class="p">][</span><span class="mi">800</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sentinel-2A &quot;mimic&quot;&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands_6x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">array_6x</span><span class="p">[</span><span class="mi">200</span><span class="p">][</span><span class="mi">800</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sentera 6X &quot;mimic&quot;&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavelength (nm)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Reflectance (%)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;API Example: `spec_mod.spectral_mimic`&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../img/spec_mod/spectral_mimic_6x.png" src="../img/spec_mod/spectral_mimic_6x.png" />
<p>And finally, mimic the Micasense RedEdge-MX and compare to hyperspectral, Sentinel-2A, and Sentera 6X.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">array_re3</span><span class="p">,</span> <span class="n">metadata_re3</span> <span class="o">=</span> <span class="n">my_spec_mod</span><span class="o">.</span><span class="n">spectral_mimic</span><span class="p">(</span><span class="n">sensor</span><span class="o">=</span><span class="s1">&#39;micasense_rededge_3&#39;</span><span class="p">,</span> <span class="n">center_wl</span><span class="o">=</span><span class="s1">&#39;peak&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">meta_bands_re3</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">literal_eval</span><span class="p">(</span><span class="n">metadata_re3</span><span class="p">[</span><span class="s1">&#39;wavelength&#39;</span><span class="p">])])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">spy_hs</span><span class="p">[</span><span class="mi">200</span><span class="p">][</span><span class="mi">800</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Hyperspectral (Pika II)&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands_s2a</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">array_s2a</span><span class="p">[</span><span class="mi">200</span><span class="p">][</span><span class="mi">800</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sentinel-2A &quot;mimic&quot;&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands_6x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">array_6x</span><span class="p">[</span><span class="mi">200</span><span class="p">][</span><span class="mi">800</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sentera 6X &quot;mimic&quot;&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands_re3</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">array_re3</span><span class="p">[</span><span class="mi">200</span><span class="p">][</span><span class="mi">800</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Micasense RedEdge 3 &quot;mimic&quot;&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavelength (nm)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Reflectance (%)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;API Example: `spec_mod.spectral_mimic`&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../img/spec_mod/spectral_mimic_re.png" src="../img/spec_mod/spectral_mimic_re.png" />
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hs_process.spec_mod.spec_mod.spectral_resample">
<code class="sig-name descname"><span class="pre">spectral_resample</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bandwidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins_n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spyfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/spec_mod.html#spec_mod.spectral_resample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.spec_mod.spec_mod.spectral_resample" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Performs pixel-wise resampling of spectral bands via binning</dt><dd><dl class="simple">
<dt>(calculates the mean across all bands within each <code class="docutils literal notranslate"><span class="pre">bandwidth</span></code></dt><dd><p>region for each image pixel).</p>
</dd>
</dl>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bandwidth</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code> or <code class="docutils literal notranslate"><span class="pre">int</span></code>) -- The bandwidth of the bands
after spectral resampling is complete (units should be
consistent with that of the .hdr file). Setting <code class="docutils literal notranslate"><span class="pre">bandwidth</span></code>
to 10 will consolidate bands that fall within every 10 nm
interval.</p></li>
<li><p><strong>bins_n</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- The number of bins (i.e., &quot;bands&quot;) to achieve
after spectral resampling is complete. Ignored if <code class="docutils literal notranslate"><span class="pre">bandwidth</span></code>
is not <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object) -- The datacube being accessed and/or
manipulated.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>2-element <code class="docutils literal notranslate"><span class="pre">tuple</span></code> containing</p>
<ul class="simple">
<li><p><strong>array_bin</strong> (<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>): Binned datacube.</p></li>
<li><p><strong>metadata</strong> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>): Modified metadata describing the
binned spectral array (<code class="docutils literal notranslate"><span class="pre">array_bin</span></code>).</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code> and <code class="docutils literal notranslate"><span class="pre">spec_mod</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">spec_mod</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_hdr</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">read_cube</span><span class="p">(</span><span class="n">fname_hdr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_spec_mod</span> <span class="o">=</span> <span class="n">spec_mod</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
</pre></div>
</div>
<p>Use spec_mod.spectral_resample to &quot;bin&quot; the datacube to bands with
20 nm bandwidths.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">array_bin</span><span class="p">,</span> <span class="n">metadata_bin</span> <span class="o">=</span> <span class="n">my_spec_mod</span><span class="o">.</span><span class="n">spectral_resample</span><span class="p">(</span><span class="n">bandwidth</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
<p>Plot the mean spectral response of the hyperspectral image to that
of the binned image bands (mean calculated across the entire image).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ast</span> <span class="kn">import</span> <span class="n">literal_eval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spy_hs</span> <span class="o">=</span> <span class="n">my_spec_mod</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">open_memmap</span><span class="p">()</span>  <span class="c1"># datacube before smoothing</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">meta_bands</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">meta_bands</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">meta_bands_bin</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">literal_eval</span><span class="p">(</span><span class="n">metadata_bin</span><span class="p">[</span><span class="s1">&#39;wavelength&#39;</span><span class="p">])])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">spy_hs</span><span class="p">[</span><span class="mi">200</span><span class="p">][</span><span class="mi">800</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Hyperspectral (Pika II)&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands_bin</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">array_bin</span><span class="p">[</span><span class="mi">200</span><span class="p">][</span><span class="mi">800</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Spectral resample (20 nm)&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavelength (nm)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Reflectance (%)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;API Example: `spec_mod.spectral_resample`&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../img/spec_mod/spectral_resample.png" src="../img/spec_mod/spectral_resample.png" />
</dd></dl>

<dl class="py method">
<dt id="hs_process.spec_mod.spec_mod.spectral_smooth">
<code class="sig-name descname"><span class="pre">spectral_smooth</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spyfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/spec_mod.html#spec_mod.spectral_smooth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.spec_mod.spec_mod.spectral_smooth" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs Savitzky-Golay smoothing on the spectral domain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>window_size</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- the length of the window; must be an odd
integer number (default: 11).</p></li>
<li><p><strong>order</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- the order of the polynomial used in the filtering;
must be less than <code class="docutils literal notranslate"><span class="pre">window_size</span></code> - 1 (default: 2).</p></li>
<li><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object or <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) -- The data cube to
clip; if <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code>, loads band information
from <code class="docutils literal notranslate"><span class="pre">spec_mod.spyfile</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>2-element <code class="docutils literal notranslate"><span class="pre">tuple</span></code> containing</p>
<ul class="simple">
<li><p><strong>array_smooth</strong> (<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>): Clipped datacube.</p></li>
<li><p><strong>metadata</strong> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>): Modified metadata describing the smoothed
hyperspectral datacube (<code class="docutils literal notranslate"><span class="pre">array_smooth</span></code>).</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Because the smoothing operation is performed for every pixel
individually, this function may take several minutes for large
images.</p>
</div>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code> and <code class="docutils literal notranslate"><span class="pre">spec_mod</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">spec_mod</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_hdr</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">read_cube</span><span class="p">(</span><span class="n">fname_hdr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_spec_mod</span> <span class="o">=</span> <span class="n">spec_mod</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
</pre></div>
</div>
<p>Use <code class="docutils literal notranslate"><span class="pre">spec_mod.spectral_smooth</span></code> to perform a <em>Savitzky-Golay</em>
smoothing operation across the hyperspectral spectral signature.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">array_smooth</span><span class="p">,</span> <span class="n">metadata_smooth</span> <span class="o">=</span> <span class="n">my_spec_mod</span><span class="o">.</span><span class="n">spectral_smooth</span><span class="p">(</span>
<span class="go">        window_size=11, order=2)</span>
</pre></div>
</div>
<p>Plot the spectra of an individual pixel to visualize the result of the smoothing procedure.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spy_hs</span> <span class="o">=</span> <span class="n">my_spec_mod</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">open_memmap</span><span class="p">()</span>  <span class="c1"># datacube before smoothing</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">meta_bands</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">meta_bands</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">meta_bands_smooth</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">metadata_smooth</span><span class="p">[</span><span class="s1">&#39;wavelength&#39;</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">spy_hs</span><span class="p">[</span><span class="mi">200</span><span class="p">][</span><span class="mi">800</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Before spectral smoothing&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands_smooth</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">array_smooth</span><span class="p">[</span><span class="mi">200</span><span class="p">][</span><span class="mi">800</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;After spectral smoothing&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavelength (nm)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Reflectance (%)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;API Example: `spec_mod.spectral_smooth`&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../img/spec_mod/spectral_smooth.png" src="../img/spec_mod/spectral_smooth.png" />
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-hs_process.utilities">
<span id="hs-process-utilities-module"></span><h2>hs_process.utilities module<a class="headerlink" href="#module-hs_process.utilities" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="hs_process.utilities.defaults">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hs_process.utilities.</span></code><code class="sig-name descname"><span class="pre">defaults</span></code><a class="reference internal" href="_modules/hs_process/utilities.html#defaults"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.utilities.defaults" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class containing default values and/or settings for various
<code class="docutils literal notranslate"><span class="pre">hs_process</span></code> tools/functions.</p>
<dl class="py attribute">
<dt id="hs_process.utilities.defaults.crop_defaults">
<code class="sig-name descname"><span class="pre">crop_defaults</span></code><a class="headerlink" href="#hs_process.utilities.defaults.crop_defaults" title="Permalink to this definition">¶</a></dt>
<dd><p>Default values for performing spatial cropping on images. <code class="docutils literal notranslate"><span class="pre">crop_defaults</span></code>
is referenced by the <code class="docutils literal notranslate"><span class="pre">spatial_mod.crop_single()</span></code> function to get default
values if various user-parameters are not passed or are left to <code class="docutils literal notranslate"><span class="pre">None</span></code>.
In this way, <code class="docutils literal notranslate"><span class="pre">defaults.crop_defaults</span></code> can be modified once by the user to
avoid having to pass the same parameter(s) repeatedly if executing
<code class="docutils literal notranslate"><span class="pre">spatial_mod.crop_single()</span></code> many times, such as in a for loop.</p>
<dl class="py attribute">
<dt id="hs_process.utilities.defaults.crop_defaults.directory">
<code class="sig-prename descclassname"><span class="pre">crop_defaults.</span></code><code class="sig-name descname"><span class="pre">directory</span></code><a class="headerlink" href="#hs_process.utilities.defaults.crop_defaults.directory" title="Permalink to this definition">¶</a></dt>
<dd><p>File directory of the input image
to be cropped (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.utilities.defaults.crop_defaults.name_short">
<code class="sig-prename descclassname"><span class="pre">crop_defaults.</span></code><code class="sig-name descname"><span class="pre">name_short</span></code><a class="headerlink" href="#hs_process.utilities.defaults.crop_defaults.name_short" title="Permalink to this definition">¶</a></dt>
<dd><p>Part of the datacube name that is
generally not repeated across many datacubes captured at the
same time. In the <code class="docutils literal notranslate"><span class="pre">name_long</span></code> example above,
<code class="docutils literal notranslate"><span class="pre">name_short</span></code> = &quot;plot_101_pika_gige_2&quot;. The part of the
filename that is <code class="docutils literal notranslate"><span class="pre">name_short</span></code> should end with a dash (but
should not include that dash as it belongs to <code class="docutils literal notranslate"><span class="pre">name_long</span></code>;
default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.utilities.defaults.crop_defaults.name_long">
<code class="sig-prename descclassname"><span class="pre">crop_defaults.</span></code><code class="sig-name descname"><span class="pre">name_long</span></code><a class="headerlink" href="#hs_process.utilities.defaults.crop_defaults.name_long" title="Permalink to this definition">¶</a></dt>
<dd><p>Part of the datacube name that tends
to be long and is repeated across many datacubes captured at
the same time. This is an artifact of Resonon/Spectronon
software, and may be desireable to shorten and/or make more
informative. For example, a datacube may have the following name:
<em>&quot;plot_101_pika_gige_2-Radiance From Raw Data-Georectify Airborne Datacube-Reflectance from Radiance Data and Measured Reference Spectrum.bip&quot;</em>
and another datacube captured in the same campaign may be named:
<em>&quot;plot_102_pika_gige_1-Radiance From Raw Data-Georectify Airborne Datacube-Reflectance from Radiance Data and Measured Reference Spectrum.bip&quot;</em>
<code class="docutils literal notranslate"><span class="pre">name_long</span></code> should refer to everything after the first dash
(including the first dash) up to the file extension (&quot;.bip&quot;):
<code class="docutils literal notranslate"><span class="pre">name_long</span></code> = <em>&quot;-Radiance From Raw Data-Georectify Airborne Datacube-Reflectance from Radiance Data and Measured Reference Spectrum&quot;</em>
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.utilities.defaults.crop_defaults.ext">
<code class="sig-prename descclassname"><span class="pre">crop_defaults.</span></code><code class="sig-name descname"><span class="pre">ext</span></code><a class="headerlink" href="#hs_process.utilities.defaults.crop_defaults.ext" title="Permalink to this definition">¶</a></dt>
<dd><p>File extension to save the cropped image
(default: 'bip').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.utilities.defaults.crop_defaults.pix_e_ul">
<code class="sig-prename descclassname"><span class="pre">crop_defaults.</span></code><code class="sig-name descname"><span class="pre">pix_e_ul</span></code><a class="headerlink" href="#hs_process.utilities.defaults.crop_defaults.pix_e_ul" title="Permalink to this definition">¶</a></dt>
<dd><p>upper left pixel column (easting) to
begin cropping (default: 0).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">int</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.utilities.defaults.crop_defaults.pix_n_ul">
<code class="sig-prename descclassname"><span class="pre">crop_defaults.</span></code><code class="sig-name descname"><span class="pre">pix_n_ul</span></code><a class="headerlink" href="#hs_process.utilities.defaults.crop_defaults.pix_n_ul" title="Permalink to this definition">¶</a></dt>
<dd><p>upper left pixel row (northing) to
begin cropping (default: 0).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">int</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.utilities.defaults.crop_defaults.buf_e_pix">
<code class="sig-prename descclassname"><span class="pre">crop_defaults.</span></code><code class="sig-name descname"><span class="pre">buf_e_pix</span></code><a class="headerlink" href="#hs_process.utilities.defaults.crop_defaults.buf_e_pix" title="Permalink to this definition">¶</a></dt>
<dd><p>The buffer distance in the easting
direction (in pixel units) to be applied after calculating the
original crop area (default: 0).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">int</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.utilities.defaults.crop_defaults.buf_n_pix">
<code class="sig-prename descclassname"><span class="pre">crop_defaults.</span></code><code class="sig-name descname"><span class="pre">buf_n_pix</span></code><a class="headerlink" href="#hs_process.utilities.defaults.crop_defaults.buf_n_pix" title="Permalink to this definition">¶</a></dt>
<dd><p>The buffer distance in the northing
direction (in pixel units) to be applied after calculating the
original crop area (default: 0).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">int</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.utilities.defaults.crop_defaults.buf_e_m">
<code class="sig-prename descclassname"><span class="pre">crop_defaults.</span></code><code class="sig-name descname"><span class="pre">buf_e_m</span></code><a class="headerlink" href="#hs_process.utilities.defaults.crop_defaults.buf_e_m" title="Permalink to this definition">¶</a></dt>
<dd><p>The buffer distance in the easting
direction (in map units; e.g., meters) to be applied after
calculating the original crop area; the buffer is considered
after <code class="docutils literal notranslate"><span class="pre">crop_X_m</span></code>/<code class="docutils literal notranslate"><span class="pre">crop_X_pix</span></code>. A positive value will
reduce the size of <code class="docutils literal notranslate"><span class="pre">crop_X_m</span></code>/<code class="docutils literal notranslate"><span class="pre">crop_X_pix</span></code>, and a
negative value will increase it (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.utilities.defaults.crop_defaults.buf_n_m">
<code class="sig-prename descclassname"><span class="pre">crop_defaults.</span></code><code class="sig-name descname"><span class="pre">buf_n_m</span></code><a class="headerlink" href="#hs_process.utilities.defaults.crop_defaults.buf_n_m" title="Permalink to this definition">¶</a></dt>
<dd><p>The buffer distance in the northing
direction (in map units; e.g., meters) to be applied after
calculating the original crop area; the buffer is considered
after <code class="docutils literal notranslate"><span class="pre">crop_X_m</span></code>/<code class="docutils literal notranslate"><span class="pre">crop_X_pix</span></code>. A positive value will
reduce the size of <code class="docutils literal notranslate"><span class="pre">crop_X_m</span></code>/<code class="docutils literal notranslate"><span class="pre">crop_X_pix</span></code>, and a
negative value will increase it (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.utilities.defaults.crop_defaults.crop_e_pix">
<code class="sig-prename descclassname"><span class="pre">crop_defaults.</span></code><code class="sig-name descname"><span class="pre">crop_e_pix</span></code><a class="headerlink" href="#hs_process.utilities.defaults.crop_defaults.crop_e_pix" title="Permalink to this definition">¶</a></dt>
<dd><p>number of pixels in each row in the
cropped image (default: 90).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">int</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.utilities.defaults.crop_defaults.crop_n_pix">
<code class="sig-prename descclassname"><span class="pre">crop_defaults.</span></code><code class="sig-name descname"><span class="pre">crop_n_pix</span></code><a class="headerlink" href="#hs_process.utilities.defaults.crop_defaults.crop_n_pix" title="Permalink to this definition">¶</a></dt>
<dd><p>number of pixels in each column in
the cropped image (default: 120).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">int</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.utilities.defaults.crop_defaults.crop_e_m">
<code class="sig-prename descclassname"><span class="pre">crop_defaults.</span></code><code class="sig-name descname"><span class="pre">crop_e_m</span></code><a class="headerlink" href="#hs_process.utilities.defaults.crop_defaults.crop_e_m" title="Permalink to this definition">¶</a></dt>
<dd><p>length of each row (easting
direction) of the cropped image in map units (e.g., meters;
default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.utilities.defaults.crop_defaults.crop_n_m">
<code class="sig-prename descclassname"><span class="pre">crop_defaults.</span></code><code class="sig-name descname"><span class="pre">crop_n_m</span></code><a class="headerlink" href="#hs_process.utilities.defaults.crop_defaults.crop_n_m" title="Permalink to this definition">¶</a></dt>
<dd><p>length of each column (northing
direction) of the cropped image in map units (e.g., meters;
default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.utilities.defaults.crop_defaults.plot_id_ref">
<code class="sig-prename descclassname"><span class="pre">crop_defaults.</span></code><code class="sig-name descname"><span class="pre">plot_id_ref</span></code><a class="headerlink" href="#hs_process.utilities.defaults.crop_defaults.plot_id_ref" title="Permalink to this definition">¶</a></dt>
<dd><p>the plot ID of the area to be cropped
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">int</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py attribute">
<dt id="hs_process.utilities.defaults.envi_write">
<code class="sig-name descname"><span class="pre">envi_write</span></code><a class="headerlink" href="#hs_process.utilities.defaults.envi_write" title="Permalink to this definition">¶</a></dt>
<dd><p>Attributes for writing ENVI datacubes to file, following the convention of
the <a class="reference external" href="http://www.spectralpython.net/">Spectral Python</a> <a class="reference external" href="http://www.spectralpython.net/class_func_ref.html#spectral.io.envi.save_image">envi.save_image()</a> parameter options for writing
an ENVI datacube to file.</p>
<dl class="py attribute">
<dt id="hs_process.utilities.defaults.envi_write.dtype">
<code class="sig-prename descclassname"><span class="pre">envi_write.</span></code><code class="sig-name descname"><span class="pre">dtype</span></code><a class="headerlink" href="#hs_process.utilities.defaults.envi_write.dtype" title="Permalink to this definition">¶</a></dt>
<dd><p>The data type with which
to store the image. For example, to store the image in 16-bit
unsigned integer format, the argument could be any of
<code class="docutils literal notranslate"><span class="pre">numpy.uint16</span></code>, <code class="docutils literal notranslate"><span class="pre">'u2'</span></code>, <code class="docutils literal notranslate"><span class="pre">'uint16'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'H'</span></code> (default:
<code class="docutils literal notranslate"><span class="pre">np.float32</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">numpy.dtype</span></code> or <code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.utilities.defaults.envi_write.force">
<code class="sig-prename descclassname"><span class="pre">envi_write.</span></code><code class="sig-name descname"><span class="pre">force</span></code><a class="headerlink" href="#hs_process.utilities.defaults.envi_write.force" title="Permalink to this definition">¶</a></dt>
<dd><p>If <code class="docutils literal notranslate"><span class="pre">hdr_file</span></code> or its associated image
file exist, <code class="docutils literal notranslate"><span class="pre">force=True</span></code> will overwrite the files; otherwise, an
exception will be raised if either file exists (default:
<code class="docutils literal notranslate"><span class="pre">False</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.utilities.defaults.envi_write.ext">
<code class="sig-prename descclassname"><span class="pre">envi_write.</span></code><code class="sig-name descname"><span class="pre">ext</span></code><a class="headerlink" href="#hs_process.utilities.defaults.envi_write.ext" title="Permalink to this definition">¶</a></dt>
<dd><p>The extension to use for saving the image
file; if not specified, a default extension is determined based on
the <code class="docutils literal notranslate"><span class="pre">interleave</span></code>. For example, if <code class="docutils literal notranslate"><span class="pre">interleave``='bip',</span> <span class="pre">then</span>
<span class="pre">``ext</span></code> is set to 'bip' as well. If <code class="docutils literal notranslate"><span class="pre">ext</span></code> is an empty string, the
image file will have the same name as the .hdr, but without the
'.hdr' extension (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.utilities.defaults.envi_write.interleave">
<code class="sig-prename descclassname"><span class="pre">envi_write.</span></code><code class="sig-name descname"><span class="pre">interleave</span></code><a class="headerlink" href="#hs_process.utilities.defaults.envi_write.interleave" title="Permalink to this definition">¶</a></dt>
<dd><p>The band interleave format to use for
writing the file; <code class="docutils literal notranslate"><span class="pre">interleave</span></code> should be one of 'bil', 'bip', or
'bsq' (default: 'bip').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.utilities.defaults.envi_write.byteorder">
<code class="sig-prename descclassname"><span class="pre">envi_write.</span></code><code class="sig-name descname"><span class="pre">byteorder</span></code><a class="headerlink" href="#hs_process.utilities.defaults.envi_write.byteorder" title="Permalink to this definition">¶</a></dt>
<dd><p>Specifies the byte order
(endian-ness) of the data as written to disk. For little endian,
this value should be either 0 or 'little'. For big endian, it
should be either 1 or 'big'. If not specified, native byte order
will be used (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">int</span></code> or <code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py attribute">
<dt id="hs_process.utilities.defaults.spat_crop_cols">
<code class="sig-name descname"><span class="pre">spat_crop_cols</span></code><a class="headerlink" href="#hs_process.utilities.defaults.spat_crop_cols" title="Permalink to this definition">¶</a></dt>
<dd><p>Default column names for performing batch spatial cropping on
images. Useful when batch processing images via <a class="reference external" href="hs_process.batch.html#hs_process.batch.spatial_crop">batch.spatial_crop()</a>.
<code class="docutils literal notranslate"><span class="pre">batch.spatial_crop()</span></code> takes a parameter <code class="docutils literal notranslate"><span class="pre">fname_sheet</span></code>, which can be a
filename to a spreadsheet or a <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>.
<code class="docutils literal notranslate"><span class="pre">defaults.spat_crop_cols</span></code> should be modified if the column names in
<code class="docutils literal notranslate"><span class="pre">fname_sheet</span></code> are different than what is expected (see documentation for
<a class="reference external" href="hs_process.batch.html#hs_process.batch.spatial_crop">batch.spatial_crop()</a> to know the expected column names).</p>
<dl class="py attribute">
<dt id="hs_process.utilities.defaults.spat_crop_cols.directory">
<code class="sig-prename descclassname"><span class="pre">spat_crop_cols.</span></code><code class="sig-name descname"><span class="pre">directory</span></code><a class="headerlink" href="#hs_process.utilities.defaults.spat_crop_cols.directory" title="Permalink to this definition">¶</a></dt>
<dd><p>column name for input directory
(default: 'directory').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.utilities.defaults.spat_crop_cols.fname">
<code class="sig-prename descclassname"><span class="pre">spat_crop_cols.</span></code><code class="sig-name descname"><span class="pre">fname</span></code><a class="headerlink" href="#hs_process.utilities.defaults.spat_crop_cols.fname" title="Permalink to this definition">¶</a></dt>
<dd><p>column name for input fname
(default: 'fname').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.utilities.defaults.spat_crop_cols.name_short">
<code class="sig-prename descclassname"><span class="pre">spat_crop_cols.</span></code><code class="sig-name descname"><span class="pre">name_short</span></code><a class="headerlink" href="#hs_process.utilities.defaults.spat_crop_cols.name_short" title="Permalink to this definition">¶</a></dt>
<dd><p>column name for input image's
<code class="docutils literal notranslate"><span class="pre">name_short</span></code> (default: 'name_short').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.utilities.defaults.spat_crop_cols.name_long">
<code class="sig-prename descclassname"><span class="pre">spat_crop_cols.</span></code><code class="sig-name descname"><span class="pre">name_long</span></code><a class="headerlink" href="#hs_process.utilities.defaults.spat_crop_cols.name_long" title="Permalink to this definition">¶</a></dt>
<dd><p>column name for input image's
<code class="docutils literal notranslate"><span class="pre">name_long</span></code> (default: 'name_long').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.utilities.defaults.spat_crop_cols.ext">
<code class="sig-prename descclassname"><span class="pre">spat_crop_cols.</span></code><code class="sig-name descname"><span class="pre">ext</span></code><a class="headerlink" href="#hs_process.utilities.defaults.spat_crop_cols.ext" title="Permalink to this definition">¶</a></dt>
<dd><p>column name for file extension of input
image (default: 'ext').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.utilities.defaults.spat_crop_cols.pix_e_ul">
<code class="sig-prename descclassname"><span class="pre">spat_crop_cols.</span></code><code class="sig-name descname"><span class="pre">pix_e_ul</span></code><a class="headerlink" href="#hs_process.utilities.defaults.spat_crop_cols.pix_e_ul" title="Permalink to this definition">¶</a></dt>
<dd><p>column name for <code class="docutils literal notranslate"><span class="pre">pix_e_ul</span></code>
(default: 'pix_e_ul').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.utilities.defaults.spat_crop_cols.pix_n_ul">
<code class="sig-prename descclassname"><span class="pre">spat_crop_cols.</span></code><code class="sig-name descname"><span class="pre">pix_n_ul</span></code><a class="headerlink" href="#hs_process.utilities.defaults.spat_crop_cols.pix_n_ul" title="Permalink to this definition">¶</a></dt>
<dd><p>column name for <code class="docutils literal notranslate"><span class="pre">pix_n_ul</span></code>
(default: 'pix_n_ul').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.utilities.defaults.spat_crop_cols.alley_size_e_pix">
<code class="sig-prename descclassname"><span class="pre">spat_crop_cols.</span></code><code class="sig-name descname"><span class="pre">alley_size_e_pix</span></code><a class="headerlink" href="#hs_process.utilities.defaults.spat_crop_cols.alley_size_e_pix" title="Permalink to this definition">¶</a></dt>
<dd><p>column name for
<code class="docutils literal notranslate"><span class="pre">alley_size_e_pix</span></code> (default: 'alley_size_e_pix').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.utilities.defaults.spat_crop_cols.alley_size_n_pix">
<code class="sig-prename descclassname"><span class="pre">spat_crop_cols.</span></code><code class="sig-name descname"><span class="pre">alley_size_n_pix</span></code><a class="headerlink" href="#hs_process.utilities.defaults.spat_crop_cols.alley_size_n_pix" title="Permalink to this definition">¶</a></dt>
<dd><p>column name for
<code class="docutils literal notranslate"><span class="pre">alley_size_n_pix</span></code> (default: 'alley_size_n_pix').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.utilities.defaults.spat_crop_cols.alley_size_e_m">
<code class="sig-prename descclassname"><span class="pre">spat_crop_cols.</span></code><code class="sig-name descname"><span class="pre">alley_size_e_m</span></code><a class="headerlink" href="#hs_process.utilities.defaults.spat_crop_cols.alley_size_e_m" title="Permalink to this definition">¶</a></dt>
<dd><p>column name for
<code class="docutils literal notranslate"><span class="pre">alley_size_e_m</span></code> (default: 'alley_size_e_m').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.utilities.defaults.spat_crop_cols.alley_size_n_m">
<code class="sig-prename descclassname"><span class="pre">spat_crop_cols.</span></code><code class="sig-name descname"><span class="pre">alley_size_n_m</span></code><a class="headerlink" href="#hs_process.utilities.defaults.spat_crop_cols.alley_size_n_m" title="Permalink to this definition">¶</a></dt>
<dd><p>column name for
<code class="docutils literal notranslate"><span class="pre">alley_size_n_m</span></code> (default: 'alley_size_n_m').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.utilities.defaults.spat_crop_cols.buf_e_pix">
<code class="sig-prename descclassname"><span class="pre">spat_crop_cols.</span></code><code class="sig-name descname"><span class="pre">buf_e_pix</span></code><a class="headerlink" href="#hs_process.utilities.defaults.spat_crop_cols.buf_e_pix" title="Permalink to this definition">¶</a></dt>
<dd><p>column name for <code class="docutils literal notranslate"><span class="pre">buf_e_pix</span></code>
(default: 'buf_e_pix').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.utilities.defaults.spat_crop_cols.buf_n_pix">
<code class="sig-prename descclassname"><span class="pre">spat_crop_cols.</span></code><code class="sig-name descname"><span class="pre">buf_n_pix</span></code><a class="headerlink" href="#hs_process.utilities.defaults.spat_crop_cols.buf_n_pix" title="Permalink to this definition">¶</a></dt>
<dd><p>column name for <code class="docutils literal notranslate"><span class="pre">buf_n_pix</span></code>
(default: 'buf_n_pix').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.utilities.defaults.spat_crop_cols.buf_e_m">
<code class="sig-prename descclassname"><span class="pre">spat_crop_cols.</span></code><code class="sig-name descname"><span class="pre">buf_e_m</span></code><a class="headerlink" href="#hs_process.utilities.defaults.spat_crop_cols.buf_e_m" title="Permalink to this definition">¶</a></dt>
<dd><p>column name for <code class="docutils literal notranslate"><span class="pre">buf_e_m</span></code> (default:
'buf_e_m').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.utilities.defaults.spat_crop_cols.buf_n_m">
<code class="sig-prename descclassname"><span class="pre">spat_crop_cols.</span></code><code class="sig-name descname"><span class="pre">buf_n_m</span></code><a class="headerlink" href="#hs_process.utilities.defaults.spat_crop_cols.buf_n_m" title="Permalink to this definition">¶</a></dt>
<dd><p>column name for <code class="docutils literal notranslate"><span class="pre">buf_n_m</span></code> (default:
'buf_n_m').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.utilities.defaults.spat_crop_cols.crop_e_pix">
<code class="sig-prename descclassname"><span class="pre">spat_crop_cols.</span></code><code class="sig-name descname"><span class="pre">crop_e_pix</span></code><a class="headerlink" href="#hs_process.utilities.defaults.spat_crop_cols.crop_e_pix" title="Permalink to this definition">¶</a></dt>
<dd><p>column name for <code class="docutils literal notranslate"><span class="pre">crop_e_pix</span></code>
(default: 'crop_e_pix').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.utilities.defaults.spat_crop_cols.crop_n_pix">
<code class="sig-prename descclassname"><span class="pre">spat_crop_cols.</span></code><code class="sig-name descname"><span class="pre">crop_n_pix</span></code><a class="headerlink" href="#hs_process.utilities.defaults.spat_crop_cols.crop_n_pix" title="Permalink to this definition">¶</a></dt>
<dd><p>column name for <code class="docutils literal notranslate"><span class="pre">crop_n_pix</span></code>
(default: 'crop_n_pix').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.utilities.defaults.spat_crop_cols.crop_e_m">
<code class="sig-prename descclassname"><span class="pre">spat_crop_cols.</span></code><code class="sig-name descname"><span class="pre">crop_e_m</span></code><a class="headerlink" href="#hs_process.utilities.defaults.spat_crop_cols.crop_e_m" title="Permalink to this definition">¶</a></dt>
<dd><p>column name for <code class="docutils literal notranslate"><span class="pre">crop_e_m</span></code>
(default: 'crop_e_m').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.utilities.defaults.spat_crop_cols.crop_n_m">
<code class="sig-prename descclassname"><span class="pre">spat_crop_cols.</span></code><code class="sig-name descname"><span class="pre">crop_n_m</span></code><a class="headerlink" href="#hs_process.utilities.defaults.spat_crop_cols.crop_n_m" title="Permalink to this definition">¶</a></dt>
<dd><p>column name for <code class="docutils literal notranslate"><span class="pre">crop_n_m</span></code>
(default: 'crop_n_m').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.utilities.defaults.spat_crop_cols.plot_id_ref">
<code class="sig-prename descclassname"><span class="pre">spat_crop_cols.</span></code><code class="sig-name descname"><span class="pre">plot_id_ref</span></code><a class="headerlink" href="#hs_process.utilities.defaults.spat_crop_cols.plot_id_ref" title="Permalink to this definition">¶</a></dt>
<dd><p>column name for <code class="docutils literal notranslate"><span class="pre">plot_id</span></code>
(default: 'crop_n_pix').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.utilities.defaults.spat_crop_cols.n_plots_x">
<code class="sig-prename descclassname"><span class="pre">spat_crop_cols.</span></code><code class="sig-name descname"><span class="pre">n_plots_x</span></code><a class="headerlink" href="#hs_process.utilities.defaults.spat_crop_cols.n_plots_x" title="Permalink to this definition">¶</a></dt>
<dd><p>column name for <code class="docutils literal notranslate"><span class="pre">n_plots_x</span></code>
(default: 'n_plots_x').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.utilities.defaults.spat_crop_cols.n_plots_y">
<code class="sig-prename descclassname"><span class="pre">spat_crop_cols.</span></code><code class="sig-name descname"><span class="pre">n_plots_y</span></code><a class="headerlink" href="#hs_process.utilities.defaults.spat_crop_cols.n_plots_y" title="Permalink to this definition">¶</a></dt>
<dd><p>column name for <code class="docutils literal notranslate"><span class="pre">n_plots_y</span></code>
(default: 'n_plots_y').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.utilities.defaults.spat_crop_cols.n_plots">
<code class="sig-prename descclassname"><span class="pre">spat_crop_cols.</span></code><code class="sig-name descname"><span class="pre">n_plots</span></code><a class="headerlink" href="#hs_process.utilities.defaults.spat_crop_cols.n_plots" title="Permalink to this definition">¶</a></dt>
<dd><p>column name for <code class="docutils literal notranslate"><span class="pre">n_plots</span></code>
(default: 'n_plots').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="hs_process.utilities.hsio">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hs_process.utilities.</span></code><code class="sig-name descname"><span class="pre">hsio</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname_in</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_long</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_short</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">str_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'plot_'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">individual_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname_hdr_spec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hsio"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.utilities.hsio" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for reading and writing hyperspectral data files, as well as
accessing, interpreting, and modifying its associated metadata. With a
hyperspectral data file loaded via <code class="docutils literal notranslate"><span class="pre">hsio</span></code>, there is simple
functionality to display the datacube image as a multi-band render, as
well as for saving a datacube as a 3-band geotiff. <code class="docutils literal notranslate"><span class="pre">hsio</span></code> relies
heavily on the <a class="reference external" href="http://www.spectralpython.net/">Spectral Python</a> package.</p>
<dl class="py method">
<dt id="hs_process.utilities.hsio.read_cube">
<code class="sig-name descname"><span class="pre">read_cube</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname_hdr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_long</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_short</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">individual_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hsio.read_cube"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.utilities.hsio.read_cube" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads in a hyperspectral datacube using the <a class="reference external" href="http://www.spectralpython.net/">Spectral Python</a> package.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname_hdr</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- filename of datacube to be read (default:
<code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>overwrite</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- Whether to overwrite any of the previous
user-passed variables, including <code class="docutils literal notranslate"><span class="pre">name_long</span></code>, <code class="docutils literal notranslate"><span class="pre">name_plot</span></code>,
and <code class="docutils literal notranslate"><span class="pre">name_short</span></code>. If variables are already set and
<code class="docutils literal notranslate"><span class="pre">overwrite</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, they will remain the same. If
variables are set and <code class="docutils literal notranslate"><span class="pre">overwrite</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, they will be
overwritten based on typcial file naming conventions of
Resonon/Spectronon software. Any of the user-passed variables
(e.g., <code class="docutils literal notranslate"><span class="pre">name_long</span></code>, etc.) will overwrite those that were set
previously whether <code class="docutils literal notranslate"><span class="pre">overwrite</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code>
(default: <code class="docutils literal notranslate"><span class="pre">False</span></code>).</p></li>
<li><p><strong>name_long</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- Spectronon processing appends processing names
to the filenames; this indicates those processing names that
are repetitive and can be deleted from the filename following
processing (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>name_short</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- The base name of the image file (see note
above about <code class="docutils literal notranslate"><span class="pre">name_long</span></code>; default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>name_plot</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- numeric text that describes the plot number
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>individual_plot</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- Indicates whether image (and its
filename) is for an individual plot (<code class="docutils literal notranslate"><span class="pre">True</span></code>), or for many
plots (<code class="docutils literal notranslate"><span class="pre">False</span></code>; default: <code class="docutils literal notranslate"><span class="pre">False</span></code>).</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">hs_process</span></code> will search for <code class="docutils literal notranslate"><span class="pre">name_long</span></code>, <code class="docutils literal notranslate"><span class="pre">name_plot</span></code>, and
<code class="docutils literal notranslate"><span class="pre">name_short</span></code> based on typical file naming behavior of Resonon/
Spectronon software. If any of these parameters are passed by the
user, however, that will take precedence over &quot;searching the
typical file nameing behavior&quot;.</p>
</div>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_hdr</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">()</span>  <span class="c1"># initialize an instance of the hsio class (note there are no required parameters)</span>
</pre></div>
</div>
<p>Load datacube using <code class="docutils literal notranslate"><span class="pre">hsio.read_cube</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">read_cube</span><span class="p">(</span><span class="n">fname_hdr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span>
<span class="go">Data Source:   &#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip&#39;</span>
<span class="go">    # Rows:            617</span>
<span class="go">    # Samples:        1300</span>
<span class="go">    # Bands:           240</span>
<span class="go">    Interleave:        BIP</span>
<span class="go">    Quantization:  32 bits</span>
<span class="go">    Data format:   float32</span>
</pre></div>
</div>
<p>Check <code class="docutils literal notranslate"><span class="pre">name_long</span></code>, <code class="docutils literal notranslate"><span class="pre">name_short</span></code>, and <code class="docutils literal notranslate"><span class="pre">name_plot</span></code> values derived from the filename</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">name_long</span>
<span class="go">&#39;-Convert Radiance Cube to Reflectance from Measured Reference Spectrum&#39;</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">name_plot</span>
<span class="go">&#39;7&#39;</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">name_short</span>
<span class="go">&#39;Wells_rep2_20180628_16h56m_pika_gige_7&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hs_process.utilities.hsio.read_spec">
<code class="sig-name descname"><span class="pre">read_spec</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname_hdr_spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_long</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_short</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hsio.read_spec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.utilities.hsio.read_spec" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads in a hyperspectral spectrum file using the using the <a class="reference external" href="http://www.spectralpython.net/">Spectral
Python</a> package.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fname_hdr_spec</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- filename of spectra to be read.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_hdr</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7_plot_611-cube-to-spec-mean.spec.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">()</span>  <span class="c1"># initialize an instance of the hsio class (note there are no required parameters)</span>
</pre></div>
</div>
<p>Load datacube using <code class="docutils literal notranslate"><span class="pre">hsio.read_spec</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">read_spec</span><span class="p">(</span><span class="n">fname_hdr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">spyfile_spec</span>
<span class="go">Data Source:   &#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7_plot_611-cube-to-spec-mean.spec&#39;</span>
<span class="go">    # Rows:              1</span>
<span class="go">    # Samples:           1</span>
<span class="go">    # Bands:           240</span>
<span class="go">    Interleave:        BIP</span>
<span class="go">    Quantization:  32 bits</span>
<span class="go">    Data format:   float32</span>
</pre></div>
</div>
<p>Check <code class="docutils literal notranslate"><span class="pre">name_long</span></code>, <code class="docutils literal notranslate"><span class="pre">name_short</span></code>, and <code class="docutils literal notranslate"><span class="pre">name_plot</span></code> values derived from the filename</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">name_long</span>
<span class="go">&#39;-cube-to-spec-mean&#39;</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">name_short</span>
<span class="go">&#39;Wells_rep2_20180628_16h56m_pika_gige_7_plot_611&#39;</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">name_plot</span>
<span class="go">&#39;611&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hs_process.utilities.hsio.set_io_defaults">
<code class="sig-name descname"><span class="pre">set_io_defaults</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interleave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">byteorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hsio.set_io_defaults"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.utilities.hsio.set_io_defaults" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets any of the ENVI file writing parameters to <code class="docutils literal notranslate"><span class="pre">hsio</span></code>; if any
parameter is left unchanged from its default, it will remain as-is
(i.e., it will not be set).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dtype</strong> (<code class="docutils literal notranslate"><span class="pre">numpy.dtype</span></code> or <code class="docutils literal notranslate"><span class="pre">str</span></code>) -- The data type with which to store
the image. For example, to store the image in 16-bit unsigned
integer format, the argument could be any of numpy.uint16,
'u2', 'uint16', or 'H' (default=``False``).</p></li>
<li><p><strong>force</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- If <code class="docutils literal notranslate"><span class="pre">hdr_file</span></code> or its associated image file exist,
<code class="docutils literal notranslate"><span class="pre">force=True</span></code> will overwrite the files; otherwise, an exception
will be raised if either file exists (default=``None``).</p></li>
<li><p><strong>ext</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- The extension to use for saving the image file; if not
specified, a default extension is determined based on the
<code class="docutils literal notranslate"><span class="pre">interleave</span></code>. For example, if <code class="docutils literal notranslate"><span class="pre">interleave``='bip',</span> <span class="pre">then</span> <span class="pre">``ext</span></code> is
set to 'bip' as well. If <code class="docutils literal notranslate"><span class="pre">ext</span></code> is an empty string, the image
file will have the same name as the .hdr, but without the
'.hdr' extension (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>).</p></li>
<li><p><strong>interleave</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- The band interleave format to use for writing
the file; <code class="docutils literal notranslate"><span class="pre">interleave</span></code> should be one of 'bil', 'bip', or 'bsq'
(default=``False``).</p></li>
<li><p><strong>byteorder</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code> or <code class="docutils literal notranslate"><span class="pre">str</span></code>) -- Specifies the byte order (endian-ness)
of the data as written to disk. For little endian, this value
should be either 0 or 'little'. For big endian, it should be
either 1 or 'big'. If not specified, native byte order will be
used (default=``False``).</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">()</span>  <span class="c1"># initialize an instance of the hsio class</span>
</pre></div>
</div>
<p>Check <code class="docutils literal notranslate"><span class="pre">defaults.envi_write</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">defaults</span><span class="o">.</span><span class="n">envi_write</span>
<span class="go">{&#39;dtype&#39;: numpy.float32,</span>
<span class="go"> &#39;force&#39;: False,</span>
<span class="go"> &#39;ext&#39;: &#39;&#39;,</span>
<span class="go"> &#39;interleave&#39;: &#39;bip&#39;,</span>
<span class="go"> &#39;byteorder&#39;: 0}</span>
</pre></div>
</div>
<p>Modify <code class="docutils literal notranslate"><span class="pre">force</span></code> parameter and recheck <code class="docutils literal notranslate"><span class="pre">defaults.envi_write</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">set_io_defaults</span><span class="p">(</span><span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">defaults</span><span class="o">.</span><span class="n">envi_write</span>
<span class="go">{&#39;dtype&#39;: numpy.float32,</span>
<span class="go"> &#39;force&#39;: True,</span>
<span class="go"> &#39;ext&#39;: &#39;&#39;,</span>
<span class="go"> &#39;interleave&#39;: &#39;bip&#39;,</span>
<span class="go"> &#39;byteorder&#39;: 0}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hs_process.utilities.hsio.show_img">
<code class="sig-name descname"><span class="pre">show_img</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spyfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band_r</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">120</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band_g</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">76</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band_b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'viridis'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inline</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hsio.show_img"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.utilities.hsio.show_img" title="Permalink to this definition">¶</a></dt>
<dd><p>Displays a datacube as a 3-band RGB image using <a class="reference external" href="https://matplotlib.org/3.1.1/api/_as_gen/matplotlib.pyplot.imshow.html#">Matplotlib</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object or <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) -- The data cube to
display; if <code class="docutils literal notranslate"><span class="pre">None</span></code>, loads from <code class="docutils literal notranslate"><span class="pre">self.spyfile</span></code> (default:
<code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>band_r</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- Band to display on the red channel (default: 120)</p></li>
<li><p><strong>band_g</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- Band to display on the green channel (default:
76)</p></li>
<li><p><strong>band_b</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- Band to display on the blue channel (default: 32)</p></li>
<li><p><strong>vmin/vmax</strong> (<code class="docutils literal notranslate"><span class="pre">scalar</span></code>, optional) -- The data range that the colormap
covers. By default, the colormap covers the complete value
range of the supplied data (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>cmap</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- The Colormap instance or registered colormap name
used to map scalar data to colors. This parameter is ignored
for RGB(A) data (default: &quot;viridis&quot;).</p></li>
<li><p><strong>cbar</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- Whether to include a colorbar in the image
(default: <code class="docutils literal notranslate"><span class="pre">True</span></code>).</p></li>
<li><p><strong>inline</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- If <code class="docutils literal notranslate"><span class="pre">True</span></code>, displays in the IPython console;
else displays in a pop-out window (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>).</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <cite>inline</cite> parameter points to the <cite>hsio.show_img</cite> function, and
is only expected to work in an IPython console (not intended to be
used in a normal Python console).</p>
</div>
<p class="rubric">Example</p>
<p>Load <code class="docutils literal notranslate"><span class="pre">hsio</span></code> and <code class="docutils literal notranslate"><span class="pre">spatial_mod</span></code> modules</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span> <span class="c1"># load hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">spatial_mod</span> <span class="c1"># load spatial mod</span>
</pre></div>
</div>
<p>Load the datacube using <code class="docutils literal notranslate"><span class="pre">hsio.read_cube</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fname_hdr</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">()</span>  <span class="c1"># initialize an instance of the hsio class</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">read_cube</span><span class="p">(</span><span class="n">fname_hdr</span><span class="p">)</span>
</pre></div>
</div>
<p>Perform simple spatial cropping via <code class="docutils literal notranslate"><span class="pre">spatial_mod.crop_single</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">my_spatial_mod</span> <span class="o">=</span> <span class="n">spatial_mod</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>  <span class="c1"># initialize spatial_mod instance to crop the image</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array_crop</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">my_spatial_mod</span><span class="o">.</span><span class="n">crop_single</span><span class="p">(</span><span class="n">pix_e_ul</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">pix_n_ul</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">crop_e_m</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">crop_n_m</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>Show an RGB render of the cropped image using <code class="docutils literal notranslate"><span class="pre">hsio.show_img</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">show_img</span><span class="p">(</span><span class="n">array_crop</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../img/utilities/show_img.png" src="../img/utilities/show_img.png" />
</dd></dl>

<dl class="py method">
<dt id="hs_process.utilities.hsio.write_cube">
<code class="sig-name descname"><span class="pre">write_cube</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname_hdr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spyfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interleave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">byteorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hsio.write_cube"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.utilities.hsio.write_cube" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper function that accesses the <a class="reference external" href="http://www.spectralpython.net/">Spectral Python</a> package to save a
datacube to file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname_hdr</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- Output header file path (with the '.hdr'
extension).</p></li>
<li><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object or <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) -- The hyperspectral
datacube to save. If <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, then metadata (<code class="docutils literal notranslate"><span class="pre">dict</span></code>)
should also be passed.</p></li>
<li><p><strong>metadata</strong> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>) -- Metadata to write to the ENVI .hdr file
describing the hyperspectral data cube being saved. If
<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object is passed to <code class="docutils literal notranslate"><span class="pre">spyfile</span></code>, <code class="docutils literal notranslate"><span class="pre">metadata</span></code> will
overwrite any existing metadata stored by the <code class="docutils literal notranslate"><span class="pre">SpyFile</span></code>
object (default=None).</p></li>
<li><p><strong>dtype</strong> (<code class="docutils literal notranslate"><span class="pre">numpy.dtype</span></code> or <code class="docutils literal notranslate"><span class="pre">str</span></code>) -- The data type with which to
store the image. For example, to store the image in 16-bit
unsigned integer format, the argument could be any of
numpy.uint16, 'u2', 'uint16', or 'H' (default=np.float32).</p></li>
<li><p><strong>force</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- If <code class="docutils literal notranslate"><span class="pre">hdr_file</span></code> or its associated image file
exist, <code class="docutils literal notranslate"><span class="pre">force=True</span></code> will overwrite the files; otherwise, an
exception will be raised if either file exists (default=False).</p></li>
<li><p><strong>ext</strong> (<code class="docutils literal notranslate"><span class="pre">None</span></code> or <code class="docutils literal notranslate"><span class="pre">str</span></code>) -- The extension to use for saving the
image file. If not specified or if set to an empty string
(e.g., <code class="docutils literal notranslate"><span class="pre">ext=''</span></code>), a default extension is determined using the
same name as <code class="docutils literal notranslate"><span class="pre">fname_hdr</span></code>, except without the &quot;.hdr&quot;
extension. If <code class="docutils literal notranslate"><span class="pre">fname_hdr</span></code> is provided without the
&quot;non-.hdr&quot; extension (e.g., &quot;bip&quot;), then the extension is
determined from the <code class="docutils literal notranslate"><span class="pre">interleave</span></code> parameter. For example, if
<code class="docutils literal notranslate"><span class="pre">interleave``='bip',</span> <span class="pre">then</span> <span class="pre">``ext</span></code> is set to 'bip' as well. Use
of <code class="docutils literal notranslate"><span class="pre">ext</span></code> is not recommended; instead, just set
<code class="docutils literal notranslate"><span class="pre">fname_hdr</span></code> with the correct extension or use
<code class="docutils literal notranslate"><span class="pre">interleave</span></code> to set the extension (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>;
determined from <code class="docutils literal notranslate"><span class="pre">fname_hdr</span></code> or <code class="docutils literal notranslate"><span class="pre">interleave</span></code>).</p></li>
<li><p><strong>interleave</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- The band interleave format to use for writing
the file; <code class="docutils literal notranslate"><span class="pre">interleave</span></code> should be one of 'bil', 'bip', or
'bsq' (default='bip').</p></li>
<li><p><strong>byteorder</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code> or <code class="docutils literal notranslate"><span class="pre">str</span></code>) -- Specifies the byte order
(endian-ness) of the data as written to disk. For little
endian, this value should be either 0 or 'little'. For big
endian, it should be either 1 or 'big'. If not specified,
native byte order will be used (default=None).</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <code class="docutils literal notranslate"><span class="pre">dtype</span></code>, <code class="docutils literal notranslate"><span class="pre">force</span></code>, <code class="docutils literal notranslate"><span class="pre">ext</span></code>, <code class="docutils literal notranslate"><span class="pre">interleave</span></code>, and <code class="docutils literal notranslate"><span class="pre">byteorder</span></code> are not
passed, default values will be pulled from <code class="docutils literal notranslate"><span class="pre">hsio.defaults</span></code>. Thus,
<code class="docutils literal notranslate"><span class="pre">hsio.defaults</span></code> can be modified prior to calling
<code class="docutils literal notranslate"><span class="pre">hsio.write_cube()</span></code> to avoid having to pass each of thes parameters
in the <code class="docutils literal notranslate"><span class="pre">hsio.write_cube()</span></code> function (see the
<code class="docutils literal notranslate"><span class="pre">hsio.set_io_defaults()</span></code> function for support on setting these
defaults and for more information on the parameters). Each of these
parameters are passed directly to the Spectral Python
<code class="docutils literal notranslate"><span class="pre">envi.save_image()</span></code> function. For more information, please refer to
the Spectral Python documentation.</p>
</div>
<p class="rubric">Example</p>
<p>Load <code class="docutils literal notranslate"><span class="pre">hsio</span></code> and <code class="docutils literal notranslate"><span class="pre">spatial_mod</span></code> modules</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pathlib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>  <span class="c1"># load hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">spatial_mod</span>  <span class="c1"># load spatial mod</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_hdr_in</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">()</span>  <span class="c1"># initialize the hsio class</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">read_cube</span><span class="p">(</span><span class="n">fname_hdr_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Perform simple spatial cropping via <code class="docutils literal notranslate"><span class="pre">spatial_mod.crop_single</span></code> to generate a new datacube.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">my_spatial_mod</span> <span class="o">=</span> <span class="n">spatial_mod</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>  <span class="c1"># initialize spatial_mod instance to crop the image</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array_crop</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">my_spatial_mod</span><span class="o">.</span><span class="n">crop_single</span><span class="p">(</span><span class="n">pix_e_ul</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">pix_n_ul</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">crop_e_m</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">crop_n_m</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>Save the datacube using <code class="docutils literal notranslate"><span class="pre">hsio.write_cube</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fname_hdr</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;hsio&#39;</span><span class="p">,</span> <span class="s1">&#39;Wells_rep2_20180628_16h56m_pika_gige_7-hsio-write-cube-cropped.bip.hdr&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">fname_hdr</span><span class="p">))</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">write_cube</span><span class="p">(</span><span class="n">fname_hdr</span><span class="p">,</span> <span class="n">array_crop</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Load the datacube into Spectronon for visualization</p>
<img alt="../img/utilities/write_cube.png" src="../img/utilities/write_cube.png" />
</dd></dl>

<dl class="py method">
<dt id="hs_process.utilities.hsio.write_spec">
<code class="sig-name descname"><span class="pre">write_spec</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname_hdr_spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interleave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">byteorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hsio.write_spec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.utilities.hsio.write_spec" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Wrapper function that accesses the <a class="reference external" href="http://www.spectralpython.net/">Spectral Python</a> package to save a
single spectra to file.</p>
<dl>
<dt>Parameters:</dt><dd><dl class="simple">
<dt>fname_hdr_spec (<code class="docutils literal notranslate"><span class="pre">str</span></code>): Output header file path (with the '.hdr'</dt><dd><p>extension). If the extension is explicitely specified in
<code class="docutils literal notranslate"><span class="pre">fname_hdr_spec</span></code> and the <code class="docutils literal notranslate"><span class="pre">ext</span></code> parameter is also specified,
<code class="docutils literal notranslate"><span class="pre">fname_hdr_spec</span></code> will be modified to conform to the extension
set using the <code class="docutils literal notranslate"><span class="pre">ext</span></code> parameter.</p>
</dd>
<dt>df_mean (<code class="docutils literal notranslate"><span class="pre">pandas.Series</span></code> or <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>): Mean spectra,</dt><dd><p>stored as a df row, where columns are the bands.</p>
</dd>
<dt>df_std (<code class="docutils literal notranslate"><span class="pre">pandas.Series</span></code> or <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, optional): Standard</dt><dd><p>deviation of each spectra, stored as a df row, where columns
are the bands. This will be saved to the .hdr file.</p>
</dd>
<dt>dtype (<code class="docutils literal notranslate"><span class="pre">numpy.dtype</span></code> or <code class="docutils literal notranslate"><span class="pre">str</span></code>): The data type with which to</dt><dd><p>store the image. For example, to store the image in 16-bit
unsigned integer format, the argument could be any of
numpy.uint16, 'u2', 'uint16', or 'H' (default=np.float32).</p>
</dd>
<dt>force (<code class="docutils literal notranslate"><span class="pre">bool</span></code>): If <code class="docutils literal notranslate"><span class="pre">hdr_file</span></code> or its associated image file</dt><dd><p>exist, <code class="docutils literal notranslate"><span class="pre">force=True</span></code> will overwrite the files; otherwise, an
exception will be raised if either file exists (default=False).</p>
</dd>
<dt>ext (<code class="docutils literal notranslate"><span class="pre">None</span></code> or <code class="docutils literal notranslate"><span class="pre">str</span></code>): The extension to use for saving the</dt><dd><p>image file. If not specified or if set to an empty string
(e.g., <code class="docutils literal notranslate"><span class="pre">ext=''</span></code>), a default extension is determined using the
same name as <code class="docutils literal notranslate"><span class="pre">fname_hdr_spec</span></code>, except without the &quot;.hdr&quot;
extension. If <code class="docutils literal notranslate"><span class="pre">fname_hdr_spec</span></code> is provided without the
&quot;non-.hdr&quot; extension (e.g., &quot;bip&quot;), then the extension is
determined from the <code class="docutils literal notranslate"><span class="pre">interleave</span></code> parameter. For example, if
<code class="docutils literal notranslate"><span class="pre">interleave``='bip',</span> <span class="pre">then</span> <span class="pre">``ext</span></code> is set to 'bip' as well. Use
of <code class="docutils literal notranslate"><span class="pre">ext</span></code> is not recommended; instead, just set
<code class="docutils literal notranslate"><span class="pre">fname_hdr_spec</span></code> with the correct extension or use
<code class="docutils literal notranslate"><span class="pre">interleave</span></code> to set the extension (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>;
determined from <code class="docutils literal notranslate"><span class="pre">fname_hdr_spec</span></code> or <code class="docutils literal notranslate"><span class="pre">interleave</span></code>).</p>
</dd>
<dt>interleave (<code class="docutils literal notranslate"><span class="pre">str</span></code>): The band interleave format to use for writing</dt><dd><p>the file; <code class="docutils literal notranslate"><span class="pre">interleave</span></code> should be one of 'bil', 'bip', or
'bsq' (default='bip').</p>
</dd>
<dt>byteorder (<code class="docutils literal notranslate"><span class="pre">int</span></code> or <code class="docutils literal notranslate"><span class="pre">str</span></code>): Specifies the byte order</dt><dd><p>(endian-ness) of the data as written to disk. For little
endian, this value should be either 0 or 'little'. For big
endian, it should be either 1 or 'big'. If not specified,
native byte order will be used (default=None).</p>
</dd>
<dt>metadata (<code class="docutils literal notranslate"><span class="pre">dict</span></code>): Metadata to write to the ENVI .hdr file</dt><dd><p>describing the spectra being saved; if <code class="docutils literal notranslate"><span class="pre">None</span></code>, will try to
pull metadata template from <code class="docutils literal notranslate"><span class="pre">hsio.spyfile_spec.metadata</span></code> or
<code class="docutils literal notranslate"><span class="pre">hsio.spyfile.metadata</span></code> (default=None).</p>
</dd>
</dl>
</dd>
<dt>Example:</dt><dd><p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span> <span class="c1"># load hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_hdr_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">()</span>  <span class="c1"># initialize the hsio class (note there are no required parameters)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">read_cube</span><span class="p">(</span><span class="n">fname_hdr_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Calculate spectral mean via <code class="docutils literal notranslate"><span class="pre">hstools.mean_datacube</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">spec_mean</span><span class="p">,</span> <span class="n">spec_std</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">mean_datacube</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_hdr_spec</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\hsio\Wells_rep2_20180628_16h56m_pika_gige_7-mean.spec.hdr&#39;</span>
</pre></div>
</div>
<p>Save the new spectra to file via <code class="docutils literal notranslate"><span class="pre">hsio.write_spec</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">write_spec</span><span class="p">(</span><span class="n">fname_hdr_spec</span><span class="p">,</span> <span class="n">spec_mean</span><span class="p">,</span> <span class="n">spec_std</span><span class="p">)</span>
<span class="go">Saving F:</span>
</pre></div>
</div>
</dd>
</dl>
</div></blockquote>
<p>igo0024Documentshs_process_demohsioWells_rep2_20180628_16h56m_pika_gige_7-mean.spec</p>
<blockquote>
<div><blockquote>
<div><p>Open <em>Wells_rep2_20180628_16h56m_pika_gige_7-mean.spec</em> in <em>Spectronon</em> for visualization</p>
<img alt="../img/utilities/write_spec.png" src="../img/utilities/write_spec.png" />
</div></blockquote>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="hs_process.utilities.hsio.write_tif">
<code class="sig-name descname"><span class="pre">write_tif</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname_tif</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spyfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname_in</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">projection_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geotransform_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_img</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hsio.write_tif"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.utilities.hsio.write_tif" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper function that accesses the <a class="reference external" href="https://pypi.org/project/GDAL/">GDAL Python package</a> to save a
small datacube subset (i.e., three bands or less) to file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname_tif</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- Output image file path (with the '.tif'
extension).</p></li>
<li><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object or <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, optional) -- The
data cube to save. If <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, then metadata
(<code class="docutils literal notranslate"><span class="pre">dict</span></code>) should also be passed. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, uses
hsio.spyfile (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>metadata</strong> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>) -- Metadata information; if <code class="docutils literal notranslate"><span class="pre">geotransform_out</span></code>
is not passed, &quot;map info&quot; is accessed from <code class="docutils literal notranslate"><span class="pre">metadata</span></code> and
<code class="docutils literal notranslate"><span class="pre">geotransform_out</span></code> is created from that &quot;map info&quot;.</p></li>
<li><p><strong>fname_in</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>, optional) -- The filename of the image datacube to
be read in initially. This is potentially useful if
<code class="docutils literal notranslate"><span class="pre">projection_out</span></code> and/or <code class="docutils literal notranslate"><span class="pre">geotransform_out</span></code> are not passed
and a <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> is passed as the <code class="docutils literal notranslate"><span class="pre">spyfile</span></code> - in this
case, <code class="docutils literal notranslate"><span class="pre">write_tif()</span></code> uses <code class="docutils literal notranslate"><span class="pre">fname_in</span></code> to load the
<code class="docutils literal notranslate"><span class="pre">fname_in</span></code> datacube via GDAL, which can in turn be used to
load the projection or geotransform information for the output
geotiff (default: None).</p></li>
<li><p><strong>projection_out</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- The GDAL projection to use while writing
the geotiff. Applied using
gdal.driver.dataset.SetProjection() (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>;
<code class="docutils literal notranslate"><span class="pre">hsio.projection_out</span></code>)</p></li>
<li><p><strong>geotransform_out</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- The GDAL geotransform to use while
writing the geotiff. Applied using
gdal.driver.dataset.SetGeoTransform() (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>;
<code class="docutils literal notranslate"><span class="pre">hsio.geotransform_out</span></code>)</p></li>
<li><p><strong>show_img</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code> or <code class="docutils literal notranslate"><span class="pre">str</span></code>) -- Whether to display a render of the
image being saved as a geotiff. Must be <code class="docutils literal notranslate"><span class="pre">False</span></code> (does not
display the image), &quot;inline&quot; (displays the image inline using
the IPython console), or &quot;popout&quot; (displays the image in a
pop-out window; default: &quot;inline&quot;).</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>  <span class="c1"># load hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_hdr_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">()</span>  <span class="c1"># initialize the hsio class</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">read_cube</span><span class="p">(</span><span class="n">fname_hdr_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Save an RGB render of the datacube to file via <code class="docutils literal notranslate"><span class="pre">hsio.write_tif</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fname_tif</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\hsio\Wells_rep2_20180628_16h56m_pika_gige_7.tif&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">write_tif</span><span class="p">(</span><span class="n">fname_tif</span><span class="p">,</span> <span class="n">spyfile</span><span class="o">=</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">,</span> <span class="n">fname_in</span><span class="o">=</span><span class="n">fname_hdr_in</span><span class="p">)</span>
<span class="go">Either `projection_out` is `None` or `geotransform_out` is `None` (or both are). Retrieving projection and geotransform information by loading `hsio.fname_in` via GDAL. Be sure this is appropriate for the data you are trying to write.</span>
<span class="go">Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).</span>
</pre></div>
</div>
<img alt="../img/utilities/write_tif.png" src="../img/utilities/write_tif.png" />
<p>Open <em>Wells_rep2_20180628_16h56m_pika_gige_7.tif</em> in <em>QGIS</em> with the plot boundaries overlaid</p>
<img alt="../img/utilities/write_tif_qgis.png" src="../img/utilities/write_tif_qgis.png" />
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="hs_process.utilities.hstools">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hs_process.utilities.</span></code><code class="sig-name descname"><span class="pre">hstools</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spyfile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hstools"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.utilities.hstools" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Basic tools for manipulating Spyfiles and accessing their metadata.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object) -- The datacube being accessed and/or
manipulated.</p>
</dd>
</dl>
<dl class="py method">
<dt id="hs_process.utilities.hstools.clean_md_sets">
<code class="sig-name descname"><span class="pre">clean_md_sets</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hstools.clean_md_sets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.utilities.hstools.clean_md_sets" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts metadata items that are expressed as a list to be expressed as
a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>metadata</strong> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>, optional) -- Metadata dictionary to clean</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>metadata_out</strong> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>) -- Cleaned metadata dictionary.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">dict</span></code></p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Create sample metadata with &quot;wavelength&quot; expressed as a list of strings</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;samples&#39;</span><span class="p">:</span> <span class="mi">1300</span><span class="p">,</span>
<span class="go">                &#39;lines&#39;: 617,</span>
<span class="go">                &#39;bands&#39;: 4,</span>
<span class="go">                &#39;file type&#39;: &#39;ENVI Standard&#39;,</span>
<span class="go">                &#39;wavelength&#39;: [&#39;394.6&#39;, &#39;396.6528&#39;, &#39;398.7056&#39;,</span>
<span class="go">                &#39;400.7584&#39;]}</span>
</pre></div>
</div>
<p>Clean metadata using <code class="docutils literal notranslate"><span class="pre">hstools.clean_md_sets</span></code>. Notice how
wavelength is now expressed as a <code class="docutils literal notranslate"><span class="pre">str</span></code> representation of a
<code class="docutils literal notranslate"><span class="pre">dict</span></code>, which is required for properly writing the metadata to
the .hdr file via <a class="reference external" href="http://www.spectralpython.net/class_func_ref.html#spectral.io.envi.save_image">save_image()</a> in Spectral Python.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">clean_md_sets</span><span class="p">(</span><span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">)</span>
<span class="go">{&#39;samples&#39;: 1300,</span>
<span class="go"> &#39;lines&#39;: 617,</span>
<span class="go"> &#39;bands&#39;: 4,</span>
<span class="go"> &#39;file type&#39;: &#39;ENVI Standard&#39;,</span>
<span class="go"> &#39;wavelength&#39;: &#39;{394.6, 396.6528, 398.7056, 400.7584}&#39;}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hs_process.utilities.hstools.del_meta_item">
<code class="sig-name descname"><span class="pre">del_meta_item</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metadata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hstools.del_meta_item"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.utilities.hstools.del_meta_item" title="Permalink to this definition">¶</a></dt>
<dd><p>Deletes metadata item from SpyFile object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metadata</strong> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>) -- dictionary of the metadata</p></li>
<li><p><strong>key</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- dictionary key to delete</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>metadata</strong> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>) -- Dictionary containing the modified
metadata.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">dict</span></code></p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Create sample metadata</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;samples&#39;</span><span class="p">:</span> <span class="mi">1300</span><span class="p">,</span>
<span class="go">                &#39;lines&#39;: 617,</span>
<span class="go">                &#39;bands&#39;: 4,</span>
<span class="go">                &#39;file type&#39;: &#39;ENVI Standard&#39;,</span>
<span class="go">                &#39;map info&#39;: &#39;{UTM, 1.0, 1.0, 421356.76707299997, 4844936.7317699995, 0.04, 0.04, 15, T, WGS-84, units  meters, rotation  0.000}&#39;,</span>
<span class="go">                &#39;wavelength&#39;: [&#39;394.6&#39;, &#39;396.6528&#39;, &#39;398.7056&#39;,</span>
<span class="go">                &#39;400.7584&#39;]}</span>
</pre></div>
</div>
<p>Delete <em>&quot;map info&quot;</em> from <code class="docutils literal notranslate"><span class="pre">metadata</span></code> using <code class="docutils literal notranslate"><span class="pre">hstools.del_met_item</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">del_meta_item</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span> <span class="s1">&#39;map info&#39;</span><span class="p">)</span>
<span class="go">{&#39;samples&#39;: 1827,</span>
<span class="go"> &#39;lines&#39;: 617,</span>
<span class="go"> &#39;bands&#39;: 4,</span>
<span class="go"> &#39;file type&#39;: &#39;ENVI Standard&#39;,</span>
<span class="go"> &#39;wavelength&#39;: [&#39;394.6&#39;, &#39;396.6528&#39;, &#39;398.7056&#39;, &#39;400.7584&#39;]}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hs_process.utilities.hstools.dir_data">
<code class="sig-name descname"><span class="pre">dir_data</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hstools.dir_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.utilities.hstools.dir_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves the data directory from &quot;site packages&quot;.</p>
</dd></dl>

<dl class="py method">
<dt id="hs_process.utilities.hstools.get_UTM">
<code class="sig-name descname"><span class="pre">get_UTM</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pix_e_ul</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pix_n_ul</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">utm_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">utm_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size_y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hstools.get_UTM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.utilities.hstools.get_UTM" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the new UTM coordinate of cropped plot to modify the
&quot;map info&quot; tag of the .hdr file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pix_e_ul</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- upper left column (easting) where image
cropping begins.</p></li>
<li><p><strong>pix_n_ul</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- upper left row (northing) where image cropping
begins.</p></li>
<li><p><strong>utm_x</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>) -- UTM easting coordinates (meters) of the original
image (from the upper left).</p></li>
<li><p><strong>utm_y</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>) -- UTM northing coordinates (meters) of the
original image (from the upper left).</p></li>
<li><p><strong>size_x</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>) -- Ground resolved distance of the image pixels in
the x (easting) direction (meters).</p></li>
<li><p><strong>size_y</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>) -- Ground resolved distance of the image pixels in
the y (northing) direction (meters).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>2-element <code class="docutils literal notranslate"><span class="pre">tuple</span></code> containing</p>
<ul class="simple">
<li><p><strong>utm_x_new</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>): The modified UTM x coordinate (easting)
of cropped plot.</p></li>
<li><p><strong>utm_y_new</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>): The modified UTM y coordinate (northing)
of cropped plot.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Retrieve UTM coordinates and pixel sizes from the metadata</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">map_info_set</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;map info&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">utm_x</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_meta_set</span><span class="p">(</span><span class="n">map_info_set</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">utm_y</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_meta_set</span><span class="p">(</span><span class="n">map_info_set</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spy_ps_e</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">map_info_set</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spy_ps_n</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">map_info_set</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>
</pre></div>
</div>
<p>Calculate the UTM coordinates at the <em>100th easting pixel</em> and
<em>50th northing pixel</em> using <code class="docutils literal notranslate"><span class="pre">hstools.get_UTM</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ul_x_utm</span><span class="p">,</span> <span class="n">ul_y_utm</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_UTM</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span>
<span class="go">                                          utm_x, utm_y,</span>
<span class="go">                                          spy_ps_e,</span>
<span class="go">                                          spy_ps_n)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ul_x_utm</span>
<span class="go">441360.80707299995</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ul_y_utm</span>
<span class="go">4855934.691769999</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hs_process.utilities.hstools.get_band">
<code class="sig-name descname"><span class="pre">get_band</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_wl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spyfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hstools.get_band"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.utilities.hstools.get_band" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the band number of the closest target wavelength.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_wl</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code> or <code class="docutils literal notranslate"><span class="pre">float</span></code>) -- the target wavelength to retrieve
the band number for (required).</p></li>
<li><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object, optional) -- The datacube being accessed
and/or manipulated; if <code class="docutils literal notranslate"><span class="pre">None</span></code>, uses <code class="docutils literal notranslate"><span class="pre">hstools.spyfile</span></code>
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>key_band</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- band number of the closest target
wavelength (<code class="docutils literal notranslate"><span class="pre">target_wl</span></code>).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">int</span></code></p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Use <code class="docutils literal notranslate"><span class="pre">hstools.get_band</span></code> to find the band number corresponding to
<em>703 nm</em></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_band</span><span class="p">(</span><span class="mi">703</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
<span class="go">151</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hs_process.utilities.hstools.get_band_index">
<code class="sig-name descname"><span class="pre">get_band_index</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">band_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hstools.get_band_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.utilities.hstools.get_band_index" title="Permalink to this definition">¶</a></dt>
<dd><p>.
Returns the index of <code class="docutils literal notranslate"><span class="pre">band</span></code> from &quot;band names&quot;.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>band_name</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code> or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the target band to retrieve the
band index for (required).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>band_idx</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- band index of the passed band name
(<code class="docutils literal notranslate"><span class="pre">band_name</span></code>).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">int</span></code> or <code class="docutils literal notranslate"><span class="pre">list</span></code></p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Using <code class="docutils literal notranslate"><span class="pre">hstools.get_band_index</span></code>, find the band index of bands <em>4</em>, <em>43</em>, and <em>111</em>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_band_index</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">111</span><span class="p">])</span>
<span class="go">[3, 42, 110]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hs_process.utilities.hstools.get_band_num">
<code class="sig-name descname"><span class="pre">get_band_num</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">band_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hstools.get_band_num"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.utilities.hstools.get_band_num" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds 1 to <code class="docutils literal notranslate"><span class="pre">band_idx</span></code> and returns the band number(s).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>band_idx</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code> or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the target band index(es) to
retrive the band number for (required).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>band_num</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code> or <code class="docutils literal notranslate"><span class="pre">list</span></code>): band number of the passed
band index (<code class="docutils literal notranslate"><span class="pre">band_idx</span></code>).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">int</span></code> or <code class="docutils literal notranslate"><span class="pre">list</span></code></p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Using <code class="docutils literal notranslate"><span class="pre">hstools.get_band_num</span></code>, find the band number located at the <em>4th</em>, <em>43rd</em>, and <em>111th</em> index values.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_band_num</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">111</span><span class="p">])</span>
<span class="go">[5, 44, 112]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hs_process.utilities.hstools.get_band_range">
<code class="sig-name descname"><span class="pre">get_band_range</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">range_wl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spyfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hstools.get_band_range"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.utilities.hstools.get_band_range" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Retrieves the band index or band name for all bands within a
wavelength range.</p>
<dl>
<dt>Parameters:</dt><dd><dl class="simple">
<dt>range_wl (<code class="docutils literal notranslate"><span class="pre">list</span></code>): the minimum and maximum wavelength to consider;</dt><dd><p>values should be <code class="docutils literal notranslate"><span class="pre">int</span></code> or <code class="docutils literal notranslate"><span class="pre">float</span></code>.</p>
</dd>
<dt>index (bool): Indicates whether to return the band number</dt><dd><p>(<code class="docutils literal notranslate"><span class="pre">False</span></code>; min=1) or to return index number (<code class="docutils literal notranslate"><span class="pre">True</span></code>; min=0)
(default: <code class="docutils literal notranslate"><span class="pre">True</span></code>).</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">list</span></code>:</dt><dd><p><strong>band_list</strong> (<code class="docutils literal notranslate"><span class="pre">list</span></code>): A list of all bands (either index or
number, depending on how <code class="docutils literal notranslate"><span class="pre">index</span></code> is set) between a range in
wavelength values.</p>
</dd>
</dl>
</dd>
<dt>Example:</dt><dd><p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Find the band name of all bands between <em>700</em> and <em>710 nm</em></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_band_range</span><span class="p">([</span><span class="mi">700</span><span class="p">,</span> <span class="mi">710</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">spyfile</span><span class="o">=</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
<span class="go">[150, 151, 152, 153, 154]</span>
</pre></div>
</div>
<p>Find the band index values of all bands between <em>700</em> and <em>710 nm</em>
via <code class="docutils literal notranslate"><span class="pre">hstools.get_band_range</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_band_range</span><span class="p">([</span><span class="mi">700</span><span class="p">,</span> <span class="mi">710</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">spyfile</span><span class="o">=</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
<span class="go">[149, 150, 151, 152, 153]</span>
</pre></div>
</div>
<p>Sometimes &quot;band names&quot; are not integers in sequential order. To
demonstrate the utility of the <code class="docutils literal notranslate"><span class="pre">index</span></code> parameter, let's take a
look at Sentinel 2A mimicked imagery.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:</span>
</pre></div>
</div>
</dd>
</dl>
</div></blockquote>
<dl>
<dt>igo0024Documentshs_process_demospec_mod'</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;Wells_rep2_20180628_16h56m_pika_gige_7-mimic-s2a.bip.hdr&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Find the band name of all bands between <em>760</em> and <em>840 nm</em></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_band_range</span><span class="p">([</span><span class="mi">760</span><span class="p">,</span> <span class="mi">840</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">spyfile</span><span class="o">=</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
<span class="go">[&#39;S2A_SR_AV_B7&#39;, &#39;S2A_SR_AV_B8&#39;]</span>
</pre></div>
</div>
<p>Find the band index values of all bands between <em>760</em> and <em>840 nm</em>
via <code class="docutils literal notranslate"><span class="pre">hstools.get_band_range</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_band_range</span><span class="p">([</span><span class="mi">760</span><span class="p">,</span> <span class="mi">840</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">spyfile</span><span class="o">=</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
<span class="go">[6, 7]</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hs_process.utilities.hstools.get_center_wl">
<code class="sig-name descname"><span class="pre">get_center_wl</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wl_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spyfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wls</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hstools.get_center_wl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.utilities.hstools.get_center_wl" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets band numbers and mean wavelength from all wavelengths (or bands)
in <code class="docutils literal notranslate"><span class="pre">wl_list</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wl_list</strong> (<code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the list of bands to get information for
(required).</p></li>
<li><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object) -- The datacube being accessed and/or
manipulated; if <code class="docutils literal notranslate"><span class="pre">None</span></code>, uses <code class="docutils literal notranslate"><span class="pre">hstools.spyfile</span></code> (default:
<code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>wls</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- whether wavelengths are passed in <code class="docutils literal notranslate"><span class="pre">wl_list</span></code> or if
bands are passed in <code class="docutils literal notranslate"><span class="pre">wl_list</span></code> (default: <code class="docutils literal notranslate"><span class="pre">True</span></code> - wavelenghts
passed).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>2-element <code class="docutils literal notranslate"><span class="pre">tuple</span></code> containing</p>
<ul class="simple">
<li><p><strong>bands</strong> (<code class="docutils literal notranslate"><span class="pre">list</span></code>): the list of bands (band number) corresponding
to <code class="docutils literal notranslate"><span class="pre">wl_list</span></code>.</p></li>
<li><p><strong>wls_mean</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>): the mean wavelength from <code class="docutils literal notranslate"><span class="pre">wl_list</span></code>.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Using <code class="docutils literal notranslate"><span class="pre">hstools.get_center_wl</span></code>, find the bands and <em>actual mean wavelength</em> of the bands closest to <em>700</em> and <em>710</em> nm.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bands</span><span class="p">,</span> <span class="n">wls_mean</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_center_wl</span><span class="p">([</span><span class="mi">700</span><span class="p">,</span> <span class="mi">710</span><span class="p">],</span> <span class="n">wls</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bands</span>
<span class="go">[150, 155]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wls_mean</span>
<span class="go">705.5992</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hs_process.utilities.hstools.get_meta_set">
<code class="sig-name descname"><span class="pre">get_meta_set</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">meta_set</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hstools.get_meta_set"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.utilities.hstools.get_meta_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads metadata &quot;set&quot; (i.e., string representation of a Python set;
common in .hdr files), taking care to remove leading and trailing
spaces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>meta_set</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- the string representation of the metadata set</p></li>
<li><p><strong>idx</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- index to be read; if <code class="docutils literal notranslate"><span class="pre">None</span></code>, the whole list is
returned (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>metadata_list</strong> (<code class="docutils literal notranslate"><span class="pre">list</span></code> or <code class="docutils literal notranslate"><span class="pre">str</span></code>): List of metadata set
items (as <code class="docutils literal notranslate"><span class="pre">str</span></code>), or if idx is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, the item in the
position described by <code class="docutils literal notranslate"><span class="pre">idx</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">list</span></code> or <code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Retrieve the <em>&quot;map info&quot; set</em> from the metadata via
<code class="docutils literal notranslate"><span class="pre">hstools.get_meta_set</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">map_info_set</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;map info&#39;</span><span class="p">]</span>
<span class="go">[&#39;UTM&#39;,</span>
<span class="go"> &#39;1.0&#39;,</span>
<span class="go"> &#39;1.0&#39;,</span>
<span class="go"> &#39;441357.287073&#39;,</span>
<span class="go"> &#39;4855944.7717699995&#39;,</span>
<span class="go"> &#39;0.04&#39;,</span>
<span class="go"> &#39;0.04&#39;,</span>
<span class="go"> &#39;15&#39;,</span>
<span class="go"> &#39;T&#39;,</span>
<span class="go"> &#39;WGS-84&#39;,</span>
<span class="go"> &#39;units  meters&#39;,</span>
<span class="go"> &#39;rotation  0.000&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hs_process.utilities.hstools.get_spectral_mean">
<code class="sig-name descname"><span class="pre">get_spectral_mean</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">band_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spyfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hstools.get_spectral_mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.utilities.hstools.get_spectral_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the spectral mean of a datacube from a list of bands.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>band_list</strong> (<code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the list of bands to calculate the spectral
mean for on the datacube (required).</p></li>
<li><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object or <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) -- The datacube being
accessed and/or manipulated; if <code class="docutils literal notranslate"><span class="pre">None</span></code>, uses <code class="docutils literal notranslate"><span class="pre">hstools.spyfile</span></code>
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>array_mean</strong> (<code class="docutils literal notranslate"><span class="pre">numpy.array</span></code> or <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>): The
mean reflectance from <code class="docutils literal notranslate"><span class="pre">spyfile</span></code> for the bands in <code class="docutils literal notranslate"><span class="pre">band_list</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">numpy.array</span></code> or <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Calculate the spectral mean of the datacube via
<code class="docutils literal notranslate"><span class="pre">hstools.get_spectral_mean</span></code> using all bands between <em>800</em> and
<em>840 nm</em></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">band_list</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_band_range</span><span class="p">([</span><span class="mi">800</span><span class="p">,</span> <span class="mi">840</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array_mean</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_spectral_mean</span><span class="p">(</span><span class="n">band_list</span><span class="p">,</span> <span class="n">spyfile</span><span class="o">=</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">show_img</span><span class="p">(</span><span class="n">array_mean</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../img/utilities/get_spectral_mean.png" src="../img/utilities/get_spectral_mean.png" />
</dd></dl>

<dl class="py method">
<dt id="hs_process.utilities.hstools.get_wavelength">
<code class="sig-name descname"><span class="pre">get_wavelength</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_band</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spyfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hstools.get_wavelength"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.utilities.hstools.get_wavelength" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns actual wavelength of the closest target band.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_band</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code> or <code class="docutils literal notranslate"><span class="pre">float</span></code>) -- the target band to retrieve
wavelength number for (required).</p></li>
<li><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object, optional) -- The datacube being accessed and/or
manipulated; if <code class="docutils literal notranslate"><span class="pre">None</span></code>, uses <code class="docutils literal notranslate"><span class="pre">hstools.spyfile</span></code> (default:
<code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>key_wavelength</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>) -- wavelength of the closest
target band (<code class="docutils literal notranslate"><span class="pre">target_band</span></code>).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Use <code class="docutils literal notranslate"><span class="pre">hstools.get_wavelength</span></code> to find the wavelength value corresponding to the <em>151st band</em></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_wavelength</span><span class="p">(</span><span class="mi">151</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
<span class="go">702.52</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hs_process.utilities.hstools.get_wavelength_range">
<code class="sig-name descname"><span class="pre">get_wavelength_range</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">range_bands</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spyfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hstools.get_wavelength_range"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.utilities.hstools.get_wavelength_range" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Retrieves the wavelengths for all bands within a band range.</p>
<dl>
<dt>Parameters:</dt><dd><dl class="simple">
<dt>range_bands (<code class="docutils literal notranslate"><span class="pre">list</span></code>): the minimum and maximum band number to</dt><dd><p>consider; values should be <code class="docutils literal notranslate"><span class="pre">int</span></code>.</p>
</dd>
<dt>index (bool): Indicates whether the bands in <code class="docutils literal notranslate"><span class="pre">range_bands</span></code> denote</dt><dd><p>the band number (<code class="docutils literal notranslate"><span class="pre">False</span></code>; min=1) or the index number
(<code class="docutils literal notranslate"><span class="pre">True</span></code>; min=0) (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>).</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">list</span></code>:</dt><dd><p><strong>wavelength_list</strong> (<code class="docutils literal notranslate"><span class="pre">list</span></code>): A list of all wavelengths
between a range in band numbers or index values (depending how
<code class="docutils literal notranslate"><span class="pre">index</span></code> is set).</p>
</dd>
</dl>
</dd>
<dt>Example:</dt><dd><p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_hdr</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:</span>
</pre></div>
</div>
</dd>
</dl>
</div></blockquote>
<dl>
<dt>igo0024DocumentsGitHubhs_processhs_processdataWells_rep2_20180628_16h56m_test_pika_gige_7-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr'</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_hdr</span><span class="p">)</span>
</pre></div>
</div>
<p>Find the wavelengths from the <em>16th</em> to <em>21st bands</em></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_wavelength_range</span><span class="p">([</span><span class="mi">16</span><span class="p">,</span> <span class="mi">21</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">spyfile</span><span class="o">=</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
<span class="go">[425.392, 427.4448, 429.4976, 431.5504, 433.6032, 435.656]</span>
</pre></div>
</div>
<p>Find the wavelengths from the <em>16th</em> to the <em>21st index</em></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_wavelength_range</span><span class="p">([</span><span class="mi">16</span><span class="p">,</span> <span class="mi">21</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">spyfile</span><span class="o">=</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
<span class="go">[427.4448, 429.4976, 431.5504, 433.6032, 435.656, 437.7088]</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hs_process.utilities.hstools.load_spyfile">
<code class="sig-name descname"><span class="pre">load_spyfile</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spyfile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hstools.load_spyfile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.utilities.hstools.load_spyfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a <code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> (Spectral Python object) for data access and/or
manipulation by the <code class="docutils literal notranslate"><span class="pre">hstools</span></code> class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object) -- The datacube being accessed and/or
manipulated.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Load a new datacube using <code class="docutils literal notranslate"><span class="pre">hstools.load_spyfile</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">load_spyfile</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">spyfile</span>
<span class="go">Data Source:   &#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip&#39;</span>
<span class="go">    # Rows:            617</span>
<span class="go">    # Samples:        1300</span>
<span class="go">    # Bands:           240</span>
<span class="go">    Interleave:        BIP</span>
<span class="go">    Quantization:  32 bits</span>
<span class="go">    Data format:   float32</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hs_process.utilities.hstools.mask_array">
<code class="sig-name descname"><span class="pre">mask_array</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percentile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">side</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lower'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hstools.mask_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.utilities.hstools.mask_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a masked numpy array based on a threshold value. If <code class="docutils literal notranslate"><span class="pre">array</span></code> is
already a masked array, that mask is maintained and the new mask(s) is/
are added to the original mask.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) -- The data array to mask.</p></li>
<li><p><strong>thresh</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code> or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- The value for which to base the
threshold; if <code class="docutils literal notranslate"><span class="pre">thresh</span></code> is <code class="docutils literal notranslate"><span class="pre">list</span></code> and <code class="docutils literal notranslate"><span class="pre">side</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>,
then all values in <code class="docutils literal notranslate"><span class="pre">thresh</span></code> will be masked; if <code class="docutils literal notranslate"><span class="pre">thresh</span></code> is
<code class="docutils literal notranslate"><span class="pre">list</span></code> and <code class="docutils literal notranslate"><span class="pre">side</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, then only the first
value in the list will be considered for thresholding (default:
<code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>percentile</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>) -- The percentile of pixels to mask; if
<code class="docutils literal notranslate"><span class="pre">percentile</span></code> = 95 and <code class="docutils literal notranslate"><span class="pre">side</span></code> = 'lower', the lowest 95% of
pixels will be masked prior to calculating the mean spectra
across pixels (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>; range: 0-100).</p></li>
<li><p><strong>side</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- The side of the threshold for which to apply the
mask. Must be either 'lower', 'upper', 'outside', or <code class="docutils literal notranslate"><span class="pre">None</span></code>;
if 'lower', everything below the threshold will be masked; if
'outside', the <code class="docutils literal notranslate"><span class="pre">thresh</span></code> / <code class="docutils literal notranslate"><span class="pre">percentile</span></code> parameter must be
list-like with two values indicating the lower and upper bounds
- anything outside of these values will be masked out; if
<code class="docutils literal notranslate"><span class="pre">None</span></code>, only the values that exactly match the threshold will
be masked (default: 'lower').</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>2-element <code class="docutils literal notranslate"><span class="pre">tuple</span></code> containing</p>
<ul class="simple">
<li><p><strong>array_mask</strong> (<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>): The masked <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>
based on the passed threshold and/or percentile value.</p></li>
<li><p><strong>metadata</strong> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>): The modified metadata.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Retrieve the image band at <em>800 nm</em> using <code class="docutils literal notranslate"><span class="pre">hstools.get_band</span></code> and
<code class="docutils literal notranslate"><span class="pre">hsio.spyfile.open_memmap</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">band</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_band</span><span class="p">(</span><span class="mi">800</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">open_memmap</span><span class="p">()[:,</span> <span class="p">:,</span> <span class="n">band</span><span class="p">]</span>
</pre></div>
</div>
<p>Create a masked array of all values below the <em>75th percentile</em>
via <code class="docutils literal notranslate"><span class="pre">hstools.mask_array</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">array_mask</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">mask_array</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span> <span class="n">percentile</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>See that the <em>&quot;history&quot;</em> tage in the <code class="docutils literal notranslate"><span class="pre">metadata</span></code> has been modified</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;history&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">158</span><span class="p">:]</span>
<span class="go">&quot;hs_process.mask_array[&lt;label: &#39;thresh?&#39; value:None; label: &#39;percentile?&#39; value:75; label: &#39;side?&#39; value:lower; label: &#39;unmasked_pct?&#39; value:24.9935170178282&gt;]&quot;</span>
</pre></div>
</div>
<p>Visualize the unmasked array using <code class="docutils literal notranslate"><span class="pre">hsio.show_img</span></code>. Set <code class="docutils literal notranslate"><span class="pre">vmin</span></code>
and <code class="docutils literal notranslate"><span class="pre">vmax</span></code> to ensure the same color scale is used in comparing
the masked vs. unmasked arrays.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">vmin</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vmax</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">show_img</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../img/utilities/mask_array_800nm.png" src="../img/utilities/mask_array_800nm.png" />
<p>Visualize the unmasked array using <code class="docutils literal notranslate"><span class="pre">hsio.show_img</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">show_img</span><span class="p">(</span><span class="n">array_mask</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../img/utilities/mask_array_800nm_75th.png" src="../img/utilities/mask_array_800nm_75th.png" />
</dd></dl>

<dl class="py method">
<dt id="hs_process.utilities.hstools.mean_datacube">
<code class="sig-name descname"><span class="pre">mean_datacube</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spyfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nodata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hstools.mean_datacube"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.utilities.hstools.mean_datacube" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Calculates the mean spectra for a datcube; if <code class="docutils literal notranslate"><span class="pre">mask</span></code> is passed (as a
<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>), then the mask is applied to <code class="docutils literal notranslate"><span class="pre">spyfile</span></code> prior to
computing the mean spectra.</p>
<dl>
<dt>Parameters:</dt><dd><dl class="simple">
<dt>spyfile (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object or <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>): The</dt><dd><p>hyperspectral datacube to mask.</p>
</dd>
<dt>mask (<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>): the mask to apply to <code class="docutils literal notranslate"><span class="pre">spyfile</span></code>; if</dt><dd><p><code class="docutils literal notranslate"><span class="pre">mask</span></code> does not have similar dimensions to <code class="docutils literal notranslate"><span class="pre">spyfile</span></code>, the
first band (i.e., first two dimensions) of <code class="docutils literal notranslate"><span class="pre">mask</span></code> will be
repeated <em>n</em> times to match the number of bands of <code class="docutils literal notranslate"><span class="pre">spyfile</span></code>
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
</dd>
<dt>nodata (<code class="docutils literal notranslate"><span class="pre">float</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code>): If <code class="docutils literal notranslate"><span class="pre">None</span></code>, treats all pixels</dt><dd><p>cells as they are repressented in the <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>.
Otherwise, replaces <code class="docutils literal notranslate"><span class="pre">nodata</span></code> with <code class="docutils literal notranslate"><span class="pre">np.nan</span></code> and these cells
will not be considered when calculating the mean spectra.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>3-element <code class="docutils literal notranslate"><span class="pre">tuple</span></code> containing</p>
<ul class="simple">
<li><p><strong>spec_mean</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile.SpyFile</span></code> object): The mean spectra from
the input datacube.</p></li>
<li><p><strong>spec_std</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile.SpyFile</span></code> object): The standard deviation
of the spectra from the input datacube.</p></li>
<li><p><strong>datacube_masked</strong> (<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>): The masked
<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>; if <code class="docutils literal notranslate"><span class="pre">mask</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">datacube_masked</span></code>
is identical to the <code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> data array.</p></li>
</ul>
</dd>
<dt>Example:</dt><dd><p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Retrieve the image band at <em>800 nm</em> using <code class="docutils literal notranslate"><span class="pre">hstools.get_band</span></code> and
<code class="docutils literal notranslate"><span class="pre">hsio.spyfile.open_memmap</span></code>, then mask out all pixels whose value falls
below the <em>75th percentile</em>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">band</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_band</span><span class="p">(</span><span class="mi">800</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">open_memmap</span><span class="p">()[:,</span> <span class="p">:,</span> <span class="n">band</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array_mask</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">mask_array</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span> <span class="n">percentile</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Calculate the spectral mean from the remaining <em>(i.e., unmasked)</em>
pixels using <code class="docutils literal notranslate"><span class="pre">hstools.mean_datacube</span></code>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">spec_mean</span><span class="p">,</span> <span class="n">spec_std</span><span class="p">,</span> <span class="n">datacube_masked</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">mean_datacube</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">array_mask</span><span class="p">)</span>
</pre></div>
</div>
<p>Save using <code class="docutils literal notranslate"><span class="pre">hsio.write_spec</span></code> and <code class="docutils literal notranslate"><span class="pre">hsio.write_cube</span></code>, then load
into Spectronon software for visualization.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fname_hdr_spec</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\hstools\Wells_rep2_20180628_16h56m_pika_gige_7-mean_800nm_75th.spec.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_hdr_cube</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\hstools\Wells_rep2_20180628_16h56m_pika_gige_7-mean_800nm_75th.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">write_spec</span><span class="p">(</span><span class="n">fname_hdr_spec</span><span class="p">,</span> <span class="n">spec_mean</span><span class="p">,</span> <span class="n">spec_std</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Saving F:</span>
</pre></div>
</div>
</dd>
</dl>
</div></blockquote>
<dl>
<dt>igo0024Documentshs_process_demohstoolsWells_rep2_20180628_16h56m_pika_gige_7-mean_800nm_75th.spec</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">write_cube</span><span class="p">(</span><span class="n">fname_hdr_cube</span><span class="p">,</span> <span class="n">datacube_masked</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Saving F:</span>
</pre></div>
</div>
</dd>
</dl>
<p>igo0024Documentshs_process_demohstoolsWells_rep2_20180628_16h56m_pika_gige_7-mean_800nm_75th.bip</p>
<blockquote>
<div><img alt="../img/utilities/mean_datacube.png" src="../img/utilities/mean_datacube.png" />
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="hs_process.utilities.hstools.modify_meta_set">
<code class="sig-name descname"><span class="pre">modify_meta_set</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">meta_set</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hstools.modify_meta_set"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.utilities.hstools.modify_meta_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Modifies metadata &quot;set&quot; (i.e., string representation of a Python set;
common in .hdr files) by converting string to list, then adjusts the
value of an item by its index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>meta_set</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- the string representation of the metadata set</p></li>
<li><p><strong>idx</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- index to be modified; if <code class="docutils literal notranslate"><span class="pre">None</span></code>, the whole meta_set is
returned (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>value</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>, <code class="docutils literal notranslate"><span class="pre">int</span></code>, or <code class="docutils literal notranslate"><span class="pre">str</span></code>) -- value to replace at idx</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>set_str</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>): Modified metadata set string.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Retrieve the <em>&quot;map info&quot; set</em> from the metadata via
<code class="docutils literal notranslate"><span class="pre">hstools.get_meta_set</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">map_info_set</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;map info&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">map_info_set</span>
<span class="go">[&#39;UTM&#39;,</span>
<span class="go"> &#39;1.0&#39;,</span>
<span class="go"> &#39;1.0&#39;,</span>
<span class="go"> &#39;441357.287073&#39;,</span>
<span class="go"> &#39;4855944.7717699995&#39;,</span>
<span class="go"> &#39;0.04&#39;,</span>
<span class="go"> &#39;0.04&#39;,</span>
<span class="go"> &#39;15&#39;,</span>
<span class="go"> &#39;T&#39;,</span>
<span class="go"> &#39;WGS-84&#39;,</span>
<span class="go"> &#39;units  meters&#39;,</span>
<span class="go"> &#39;rotation  0.000&#39;]</span>
</pre></div>
</div>
<p>Modify the value at <em>index position 4</em> from <code class="docutils literal notranslate"><span class="pre">4855944.7717699995</span></code>
to <code class="docutils literal notranslate"><span class="pre">441300.2</span></code> using <code class="docutils literal notranslate"><span class="pre">hstools.modify_meta_set</span></code>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">modify_meta_set</span><span class="p">(</span><span class="n">map_info_set</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">441300.2</span><span class="p">)</span>
<span class="go">&#39;{UTM, 1.0, 1.0, 441357.287073, 441300.2, 0.04, 0.04, 15, T, WGS-84, units  meters, rotation  0.000}&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hs_process.utilities.hstools.plot_histogram">
<code class="sig-name descname"><span class="pre">plot_histogram</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname_fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percentile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">90</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#444444'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hstools.plot_histogram"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.utilities.hstools.plot_histogram" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots a histogram with the percentile value labeled.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) -- The data array used to create the
histogram for; if <code class="docutils literal notranslate"><span class="pre">array</span></code> is masked, the masked pixels are
excluded from the histogram.</p></li>
<li><p><strong>fname_fig</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>, optional) -- The filename to save the figure to;
if <code class="docutils literal notranslate"><span class="pre">None</span></code>, the figure will not be saved (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>title</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>, optional) -- The plot title (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>xlabel</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>, optional) -- The x-axis label of the histogram
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>percentile</strong> (<code class="docutils literal notranslate"><span class="pre">scalar</span></code>, optional) -- The percentile to label and
illustrate on the histogram; if <code class="docutils literal notranslate"><span class="pre">percentile</span></code> = 90, the
band/spectral index value at the 90th percentile will be
labeled on the plot (default: 90; range: 0-100).</p></li>
<li><p><strong>bins</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, optional) -- Number of histogram bins (default: 50).</p></li>
<li><p><strong>fontsize</strong> (<code class="docutils literal notranslate"><span class="pre">scalar</span></code>) -- Font size of the axes labels. The title and
text annotations will be scaled relatively (default: 16).</p></li>
<li><p><strong>color</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>, optional) -- Color of the histogram columns (default:
&quot;#444444&quot;)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Figure object showing the histogram.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>fig (<code class="docutils literal notranslate"><span class="pre">matplotlib.figure</span></code>)</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Retrieve the image band at <em>800 nm</em> using <code class="docutils literal notranslate"><span class="pre">hstools.get_band</span></code> and
<code class="docutils literal notranslate"><span class="pre">hsio.spyfile.open_memmap</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">band</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_band</span><span class="p">(</span><span class="mi">800</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">open_memmap</span><span class="p">()[:,</span> <span class="p">:,</span> <span class="n">band</span><span class="p">]</span>
</pre></div>
</div>
<p>Create a masked array of all values below the <em>5th percentile</em>
via <code class="docutils literal notranslate"><span class="pre">hstools.mask_array</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">array_mask</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">mask_array</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span> <span class="n">percentile</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Visualize the histogram of the unmasked pixels (i.e., those greater
than the 5th percentile) using <code class="docutils literal notranslate"><span class="pre">hstools.plot_histogram</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Reflectance at 800 nm&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;Reflectance (%)&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">plot_histogram</span><span class="p">(</span><span class="n">array_mask</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">xlabel</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../img/utilities/plot_histogram_800nm.png" src="../img/utilities/plot_histogram_800nm.png" />
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-hs_process">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-hs_process" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">hs_process</span></code> is a Python package for processing and manipulating aerial
hyperspectral imagery.</p>
<p><code class="docutils literal notranslate"><span class="pre">hs_process</span></code> emphasizes the ability to batch process datacubes, with the
overall goal of keeping the processing pipeline as &quot;hands-off&quot; as possible.
There is also a focus of maintaining the ability to record some of the
subjective aspects of image processing.</p>
<dl class="py class">
<dt id="hs_process.batch">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hs_process.</span></code><code class="sig-name descname"><span class="pre">batch</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.bip'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lock</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress_bar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/batch.html#batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for batch processing hyperspectral image data. Makes use of
<a class="reference external" href="hs_process.segment.html">segment</a>, <a class="reference external" href="hs_process.spatial_mod.html">spatial_mod</a>, and <a class="reference external" href="hs_process.spec_mod.html">spec_mod</a> to batch process many
datacubes in a given directory. Supports options to save full
datacubes, geotiff renders, as well as summary statistics and/or
reports for the various tools.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It may be a good idea to review and understand the <a class="reference external" href="hs_process.defaults.html">defaults</a>,
<a class="reference external" href="hs_process.hsio.html">hsio</a>, <a class="reference external" href="hs_process.hstools.html">hstools</a>, <a class="reference external" href="hs_process.segment.html">segment</a>, <a class="reference external" href="hs_process.spatial_mod.html">spatial_mod</a>, and <a class="reference external" href="hs_process.spec_mod.html">spec_mod</a>
classes prior to using the <code class="docutils literal notranslate"><span class="pre">batch</span></code> module.</p>
</div>
<dl class="py method">
<dt id="hs_process.batch.cube_to_spectra">
<code class="sig-name descname"><span class="pre">cube_to_spectra</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bip'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cube_to_spec'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_append</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cube-to-spec'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_geotiff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_interleave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_byteorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/batch.html#batch.cube_to_spectra"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.batch.cube_to_spectra" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the mean and standard deviation for each cube in
<code class="docutils literal notranslate"><span class="pre">fname_list</span></code> and writes the result to a &quot;.spec&quot; file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname_list</strong> (<code class="docutils literal notranslate"><span class="pre">list</span></code>, optional) -- list of filenames to process; if
left to <code class="docutils literal notranslate"><span class="pre">None</span></code>, will look at <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>, <code class="docutils literal notranslate"><span class="pre">search_ext</span></code>, and
<code class="docutils literal notranslate"><span class="pre">dir_level</span></code> parameters for files to process (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>base_dir</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>, optional) -- directory path to search for files to
spectrally clip; if <code class="docutils literal notranslate"><span class="pre">fname_list</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">base_dir</span></code> will
be ignored (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>search_ext</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- file format/extension to search for in all
directories and subdirectories to determine which files to
process; if <code class="docutils literal notranslate"><span class="pre">fname_list</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">search_ext</span></code> will
be ignored (default: 'bip').</p></li>
<li><p><strong>dir_level</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- The number of directory levels to search; if
<code class="docutils literal notranslate"><span class="pre">None</span></code>, searches all directory levels (default: 0).</p></li>
<li><p><strong>base_dir_out</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- directory path to save all processed
spectra; if set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, a folder named according to the
<code class="docutils literal notranslate"><span class="pre">folder_name</span></code> parameter is added to <code class="docutils literal notranslate"><span class="pre">base_dir</span></code></p></li>
<li><p><strong>folder_name</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- folder to add to <code class="docutils literal notranslate"><span class="pre">base_dir_out</span></code> to save all
the processed datacubes (default: 'cube_to_spec').</p></li>
<li><p><strong>name_append</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- name to append to the filename (default:
'cube-to-spec').</p></li>
<li><p><strong>write_geotiff</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- whether to save the masked RGB image as a
geotiff alongside the masked datacube.</p></li>
<li><p><strong>out_XXX</strong> -- Settings for saving the output files can be adjusted here
if desired. They are stored in <code class="docutils literal notranslate"><span class="pre">batch.io.defaults</span></code>, and are
therefore accessible at a high level. See
<code class="docutils literal notranslate"><span class="pre">hsio.set_io_defaults()</span></code> for more information on each of the
settings.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following <code class="docutils literal notranslate"><span class="pre">batch</span></code> example builds on the API example results
of the <a class="reference external" href="hs_process.spatial_mod.html#hs_process.spatial_mod.crop_many_gdf">spatial_mod.crop_many_gdf</a> function. Please complete the
<a class="reference external" href="hs_process.spatial_mod.html#hs_process.spatial_mod.crop_many_gdf">spatial_mod.crop_many_gdf</a> example to be sure your directory
(i.e., <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>) is populated with multiple hyperspectral
datacubes. The following example will be using datacubes located in
the following directory:
<code class="docutils literal notranslate"><span class="pre">F:\nigo0024\Documents\hs_process_demo\spatial_mod\crop_many_gdf</span></code></p>
</div>
<p class="rubric">Example</p>
<p>Load and initialize the <code class="docutils literal notranslate"><span class="pre">batch</span></code> module, checking to be sure the
directory exists.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">batch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;spatial_mod&#39;</span><span class="p">,</span> <span class="s1">&#39;crop_many_gdf&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">base_dir</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span> <span class="o">=</span> <span class="n">batch</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">search_ext</span><span class="o">=</span><span class="s1">&#39;.bip&#39;</span><span class="p">,</span> <span class="n">progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># searches for all files in ``base_dir`` with a &quot;.bip&quot; file extension</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Use <code class="docutils literal notranslate"><span class="pre">batch.cube_to_spectra</span></code> to calculate the <em>mean</em> and <em>standard
deviation</em> across all pixels for each of the datacubes in
<code class="docutils literal notranslate"><span class="pre">base_dir</span></code>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span><span class="o">.</span><span class="n">cube_to_spectra</span><span class="p">(</span><span class="n">base_dir</span><span class="o">=</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">write_geotiff</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">out_force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Processing file 39/40: 100%|██████████| 40/40 [00:03&lt;00:00, 13.28it/s]------------------------------------------------| 0.0%</span>
</pre></div>
</div>
<p>Use <code class="docutils literal notranslate"><span class="pre">seaborn</span></code> to visualize the spectra of plots 1011, 1012, and
1013. Notice how <code class="docutils literal notranslate"><span class="pre">hsbatch.io.name_plot</span></code> is utilized to retrieve
the plot ID, and how the <em>&quot;history&quot;</em> tag is referenced from the
metadata to determine the number of pixels whose reflectance was
averaged to create the mean spectra. Also remember that pixels
across the original input image likely represent a combination of
soil, vegetation, and shadow.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">re</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s1">&#39;cube_to_spec&#39;</span><span class="p">,</span> <span class="s1">&#39;Wells_rep2_20180628_16h56m_pika_gige_7_plot_1011-cube-to-spec-mean.spec&#39;</span><span class="p">),</span>
<span class="go">                  os.path.join(base_dir, &#39;cube_to_spec&#39;, &#39;Wells_rep2_20180628_16h56m_pika_gige_7_plot_1012-cube-to-spec-mean.spec&#39;),</span>
<span class="go">                  os.path.join(base_dir, &#39;cube_to_spec&#39;, &#39;Wells_rep2_20180628_16h56m_pika_gige_7_plot_1013-cube-to-spec-mean.spec&#39;)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">fname</span> <span class="ow">in</span> <span class="n">fname_list</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_spec</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">meta_bands</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">meta_bands</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">data</span> <span class="o">=</span> <span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile_spec</span><span class="o">.</span><span class="n">load</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">hist</span> <span class="o">=</span> <span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile_spec</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;history&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pix_n</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;&lt;pixel number: (.*)&gt;&#39;</span><span class="p">,</span> <span class="n">hist</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Plot &#39;</span><span class="o">+</span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">name_plot</span><span class="o">+</span><span class="s1">&#39; (n=&#39;</span><span class="o">+</span><span class="n">pix_n</span><span class="o">+</span><span class="s1">&#39;)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">else</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Plot &#39;</span><span class="o">+</span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">name_plot</span><span class="o">+</span><span class="s1">&#39; (n=&#39;</span><span class="o">+</span><span class="n">pix_n</span><span class="o">+</span><span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavelength (nm)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Reflectance (%)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;API Example: `batch.cube_to_spectra`&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../img/batch/cube_to_spectra.png" src="../img/batch/cube_to_spectra.png" />
</dd></dl>

<dl class="py method">
<dt id="hs_process.batch.segment_band_math">
<code class="sig-name descname"><span class="pre">segment_band_math</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bip'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'band_math'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_append</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'band-math'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_geotiff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ndi'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wl1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wl2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wl3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">list_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_interleave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_byteorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/batch.html#batch.segment_band_math"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.batch.segment_band_math" title="Permalink to this definition">¶</a></dt>
<dd><p>Batch processing tool to perform band math on multiple datacubes in the
same way. <code class="docutils literal notranslate"><span class="pre">batch.segment_band_math</span></code> is typically used prior to
<code class="docutils literal notranslate"><span class="pre">batch.segment_create_mask</span></code> to generate the images/directory required
for the masking process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- Must be one of &quot;ndi&quot; (normalized difference
index), &quot;ratio&quot; (simple ratio index), &quot;derivative&quot;
(deriviative-type index), or &quot;mcari2&quot; (modified chlorophyll
absorption index2). Indicates what kind of band math should be
performed on the input datacube. The &quot;ndi&quot; method leverages
<code class="docutils literal notranslate"><span class="pre">segment.band_math_ndi()</span></code>, the &quot;ratio&quot; method leverages
<code class="docutils literal notranslate"><span class="pre">segment.band_math_ratio()</span></code>, and the &quot;derivative&quot; method
leverages <code class="docutils literal notranslate"><span class="pre">segment.band_math_derivative()</span></code>. Please see the
<code class="docutils literal notranslate"><span class="pre">segment</span></code> documentation for more information (default:
&quot;ndi&quot;).</p></li>
<li><p><strong>wl1</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the wavelength (or set of
wavelengths) to be used as the first parameter of the
band math index; if <code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all
bands between two wavelength values by calculating the mean
pixel value across all bands in that range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>wl2</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the wavelength (or set of
wavelengths) to be used as the second parameter of the
band math index; if <code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all
bands between two wavelength values by calculating the mean
pixel value across all bands in that range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>b1</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the band (or set of bands) to be
used as the first parameter of the band math index;
if <code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all bands between two band values
by calculating the mean pixel value across all bands in that
range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>b2</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the band (or set of bands) to be
used as the second parameter of the band math
index; if <code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all bands between two band
values by calculating the mean pixel value across all bands in
that range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>list_range</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- Whether bands/wavelengths passed as a list is
interpreted as a range of bands (<code class="docutils literal notranslate"><span class="pre">True</span></code>) or for each individual
band in the list (<code class="docutils literal notranslate"><span class="pre">False</span></code>). If <code class="docutils literal notranslate"><span class="pre">list_range</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>,
<code class="docutils literal notranslate"><span class="pre">b1</span></code>/<code class="docutils literal notranslate"><span class="pre">wl1</span></code> and <code class="docutils literal notranslate"><span class="pre">b2</span></code>/<code class="docutils literal notranslate"><span class="pre">wl2</span></code> should be lists with two items, and
all bands/wavelegths between the two values will be used
(default: <code class="docutils literal notranslate"><span class="pre">True</span></code>).</p></li>
<li><p><strong>plot_out</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- whether to save a histogram of the band math
result (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>).</p></li>
<li><p><strong>write_geotiff</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- whether to save the masked RGB image as a
geotiff alongside the masked datacube.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following <code class="docutils literal notranslate"><span class="pre">batch</span></code> example builds on the API example results
of the <a class="reference external" href="hs_process.spatial_mod.html#hs_process.spatial_mod.crop_many_gdf">spatial_mod.crop_many_gdf</a> function. Please complete the
<a class="reference external" href="hs_process.spatial_mod.html#hs_process.spatial_mod.crop_many_gdf">spatial_mod.crop_many_gdf</a> example to be sure your directory
(i.e., <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>) is populated with multiple hyperspectral
datacubes. The following example will be using datacubes located in
the following directory:
<code class="docutils literal notranslate"><span class="pre">F:\nigo0024\Documents\hs_process_demo\spatial_mod\crop_many_gdf</span></code></p>
</div>
<p class="rubric">Example</p>
<p>Load and initialize the <code class="docutils literal notranslate"><span class="pre">batch</span></code> module, checking to be sure the
directory exists.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">batch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\spatial_mod\crop_many_gdf&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">base_dir</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span> <span class="o">=</span> <span class="n">batch</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">search_ext</span><span class="o">=</span><span class="s1">&#39;.bip&#39;</span><span class="p">)</span>  <span class="c1"># searches for all files in ``base_dir`` with a &quot;.bip&quot; file extension</span>
</pre></div>
</div>
<p>Use <code class="docutils literal notranslate"><span class="pre">batch.segment_band_math</span></code> to compute the MCARI2 (Modified
Chlorophyll Absorption Ratio Index Improved; Haboudane et al.,
2004) spectral index for each of the datacubes in <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>. See
<a class="reference external" href="https://www.harrisgeospatial.com/docs/NarrowbandGreenness.html#Modified3">Harris Geospatial</a> for more information about the MCARI2 spectral
index and references to other spectral indices.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">folder_name</span> <span class="o">=</span> <span class="s1">&#39;band_math_mcari2-800-670-550&#39;</span>  <span class="c1"># folder name can be modified to be more descriptive in what type of band math is being performed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;mcari2&#39;</span>  <span class="c1"># must be one of &quot;ndi&quot;, &quot;ratio&quot;, &quot;derivative&quot;, or &quot;mcari2&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wl1</span> <span class="o">=</span> <span class="mi">800</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wl2</span> <span class="o">=</span> <span class="mi">670</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wl3</span> <span class="o">=</span> <span class="mi">550</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span><span class="o">.</span><span class="n">segment_band_math</span><span class="p">(</span><span class="n">base_dir</span><span class="o">=</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">folder_name</span><span class="o">=</span><span class="n">folder_name</span><span class="p">,</span>
<span class="go">                              name_append=&#39;band-math&#39;, write_geotiff=True,</span>
<span class="go">                              method=method, wl1=wl1, wl2=wl2, wl3=wl3,</span>
<span class="go">                              plot_out=True, out_force=True)</span>
<span class="go">Bands used (``b1``): [198]</span>
<span class="go">Bands used (``b2``): [135]</span>
<span class="go">Bands used (``b3``): [77]</span>
<span class="go">Wavelengths used (``b1``): [799.0016]</span>
<span class="go">Wavelengths used (``b2``): [669.6752]</span>
<span class="go">Wavelengths used (``b3``): [550.6128]</span>
<span class="go">Saving F:\nigo0024\Documents\hs_process_demo\spatial_mod\crop_many_gdfand_math_mcari2-800-670-550\Wells_rep2_20180628_16h56m_pika_gige_7_plot_1011-band-math-mcari2-800-670-550.bip</span>
<span class="gp">...</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">batch.segment_band_math</span></code> creates a new folder in <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>
(in this case the new directory is
<code class="docutils literal notranslate"><span class="pre">F:\nigo0024\Documents\hs_process_demo\spatial_mod\crop_many_gdfand_math_mcari2-800-670-550</span></code>)
which contains several data products. The <strong>first</strong> is
<code class="docutils literal notranslate"><span class="pre">band-math-stats.csv</span></code>: a spreadsheet containing summary
statistics for each of the image cubes that were processed via
<code class="docutils literal notranslate"><span class="pre">batch.segment_band_math</span></code>; stats include <em>pixel count</em>,
<em>mean</em>, <em>standard deviation</em>, <em>median</em>, and <em>percentiles</em> across
all image pixels.</p>
<p><strong>Second</strong> is a <code class="docutils literal notranslate"><span class="pre">geotiff</span></code> file for each of the image cubes after the
band math processing. This can be opened in <em>QGIS</em> to visualize in
a spatial reference system, or can be opened using any software
that supports floating point <em>.tif</em> files.</p>
<img alt="../img/batch/segment_band_math_plot_611-band-math-mcari2-800-670-550_tif.png" src="../img/batch/segment_band_math_plot_611-band-math-mcari2-800-670-550_tif.png" />
<p><strong>Third</strong> is the band math raster saved in the <em>.hdr</em> file format.
Note that the data conained here should be the same as in the
<em>.tif</em> file, so it's a matter of preference as to what may be more
useful. This single band <em>.hdr</em> can also be opend in <em>QGIS</em>.</p>
<p><strong>Fourth</strong> is a histogram of the band math data contained in the
image. The histogram illustrates the 90th percentile value, which
may be useful in the segmentation step (e.g., see
<a class="reference external" href="hs_process.batch.html#hs_process.batch.segment_create_mask">batch.segment_create_mask</a>).</p>
<img alt="../img/batch/segment_band_math_plot_611-band-math-mcari2-800-670-550.png" src="../img/batch/segment_band_math_plot_611-band-math-mcari2-800-670-550.png" />
</dd></dl>

<dl class="py method">
<dt id="hs_process.batch.segment_composite_band">
<code class="sig-name descname"><span class="pre">segment_composite_band</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bip'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'composite_band'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_append</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'composite-band'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_geotiff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wl1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">list_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_interleave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_byteorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/batch.html#batch.segment_composite_band"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.batch.segment_composite_band" title="Permalink to this definition">¶</a></dt>
<dd><p>Batch processing tool to create a composite band on multiple datacubes
in the same way. <code class="docutils literal notranslate"><span class="pre">batch.segment_composite_band</span></code> is typically used
prior to  <code class="docutils literal notranslate"><span class="pre">batch.segment_create_mask</span></code> to generate the
images/directory required for the masking process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wl1</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the wavelength (or set of
wavelengths) to be used as the first parameter of the
band math index; if <code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all
bands between two wavelength values by calculating the mean
pixel value across all bands in that range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>b1</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the band (or set of bands)
to be used as the first parameter of the band math index; if
<code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all bands between two band values
by calculating the mean pixel value across all bands in that
range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>list_range</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- Whether bands/wavelengths passed as a list
is interpreted as a range of bands (<code class="docutils literal notranslate"><span class="pre">True</span></code>) or for each
individual band in the list (<code class="docutils literal notranslate"><span class="pre">False</span></code>). If <code class="docutils literal notranslate"><span class="pre">list_range</span></code> is
<code class="docutils literal notranslate"><span class="pre">True</span></code>, <code class="docutils literal notranslate"><span class="pre">b1</span></code>/<code class="docutils literal notranslate"><span class="pre">wl1</span></code> and <code class="docutils literal notranslate"><span class="pre">b2</span></code>/<code class="docutils literal notranslate"><span class="pre">wl2</span></code> should be lists
with two items, and all bands/wavelegths between the two values
will be used (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>).</p></li>
<li><p><strong>plot_out</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- whether to save a histogram of the band math
result (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>).</p></li>
<li><p><strong>write_geotiff</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- whether to save the masked RGB image as a
geotiff alongside the masked datacube.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hs_process.batch.segment_create_mask">
<code class="sig-name descname"><span class="pre">segment_create_mask</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bip'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mask'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_append</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mask'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_datacube</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_spec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_geotiff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_percentile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_side</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lower'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_interleave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_byteorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/batch.html#batch.segment_create_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.batch.segment_create_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Batch processing tool to create a masked array on many datacubes.
<code class="docutils literal notranslate"><span class="pre">batch.segment_create_mask</span></code> is typically used after
<code class="docutils literal notranslate"><span class="pre">batch.segment_band_math</span></code> to mask all the datacubes in a directory
based on the result of the band math process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mask_thresh</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code> or <code class="docutils literal notranslate"><span class="pre">int</span></code>) -- The value for which to mask the
array; should be used with <code class="docutils literal notranslate"><span class="pre">side</span></code> parameter (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>mask_percentile</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code> or <code class="docutils literal notranslate"><span class="pre">int</span></code>) -- The percentile of pixels to
mask; if <code class="docutils literal notranslate"><span class="pre">percentile``=95</span> <span class="pre">and</span> <span class="pre">``side``='lower',</span> <span class="pre">the</span> <span class="pre">lowest</span> <span class="pre">95%</span> <span class="pre">of</span>
<span class="pre">pixels</span> <span class="pre">will</span> <span class="pre">be</span> <span class="pre">masked</span> <span class="pre">following</span> <span class="pre">the</span> <span class="pre">band</span> <span class="pre">math</span> <span class="pre">operation</span>
<span class="pre">(default:</span> <span class="pre">``None</span></code>; range: 0-100).</p></li>
<li><p><strong>mask_side</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- The side of the threshold for which to apply the
mask. Must be either 'lower', 'upper', 'outside', or <code class="docutils literal notranslate"><span class="pre">None</span></code>;
if 'lower', everything below the threshold will be masked; if
'outside', the <code class="docutils literal notranslate"><span class="pre">thresh</span></code> / <code class="docutils literal notranslate"><span class="pre">percentile</span></code> parameter must be
list-like with two values indicating the lower and upper bounds
- anything outside of these values will be masked out; if
<code class="docutils literal notranslate"><span class="pre">None</span></code>, only the values that exactly match the threshold will
be masked (default: 'lower').</p></li>
<li><p><strong>geotiff</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- whether to save the masked RGB image as a geotiff
alongside the masked datacube.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following <code class="docutils literal notranslate"><span class="pre">batch</span></code> example builds on the API example results
of <a class="reference external" href="hs_process.spatial_mod.html#hs_process.spatial_mod.crop_many_gdf">spatial_mod.crop_many_gdf</a> and <a class="reference external" href="hs_process.batch.html#hs_process.batch.segment_band_math">batch.segment_band_math</a>.
Please complete each of those API examples to be sure your
directories (i.e., <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>, and <code class="docutils literal notranslate"><span class="pre">mask_dir</span></code>) are populated
with image files. The following example will be masking datacubes
located in:
<code class="docutils literal notranslate"><span class="pre">F:\nigo0024\Documents\hs_process_demo\spatial_mod\crop_many_gdf</span></code>
based on MCARI2 images located in:
<code class="docutils literal notranslate"><span class="pre">F:\nigo0024\Documents\hs_process_demo\spatial_mod\crop_many_gdf\band_math_mcari2-800-670-550</span></code></p>
</div>
<p class="rubric">Example</p>
<p>Load and initialize the <code class="docutils literal notranslate"><span class="pre">batch</span></code> module, ensuring <code class="docutils literal notranslate"><span class="pre">base_dir</span></code> is
a valid directory</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">batch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\spatial_mod\crop_many_gdf&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">base_dir</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span> <span class="o">=</span> <span class="n">batch</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">search_ext</span><span class="o">=</span><span class="s1">&#39;.bip&#39;</span><span class="p">)</span>  <span class="c1"># searches for all files in ``base_dir`` with a &quot;.bip&quot; file extension</span>
</pre></div>
</div>
<p>There must be a single-band image that will be used to determine
which datacube pixels are to be masked (determined via the
<code class="docutils literal notranslate"><span class="pre">mask_dir</span></code> parameter). Point to the directory that contains the
MCARI2 images.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mask_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s1">&#39;band_math_mcari2-800-670-550&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">mask_dir</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Indicate how the MCARI2 images should be used to determine which
hyperspectal pixels are to be masked. The available parameters for
controlling this are <code class="docutils literal notranslate"><span class="pre">mask_thresh</span></code>, <code class="docutils literal notranslate"><span class="pre">mask_percentile</span></code>, and
<code class="docutils literal notranslate"><span class="pre">mask_side</span></code>. We will mask out all pixels that fall below the
MCARI2 90th percentile.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mask_percentile</span> <span class="o">=</span> <span class="mi">90</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask_side</span> <span class="o">=</span> <span class="s1">&#39;lower&#39;</span>
</pre></div>
</div>
<p>Finally, indicate the folder to save the masked datacubes and
perform the batch masking via <code class="docutils literal notranslate"><span class="pre">batch.segment_create_mask</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">folder_name</span> <span class="o">=</span> <span class="s1">&#39;mask_mcari2_90th&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span><span class="o">.</span><span class="n">segment_create_mask</span><span class="p">(</span><span class="n">base_dir</span><span class="o">=</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">mask_dir</span><span class="o">=</span><span class="n">mask_dir</span><span class="p">,</span>
<span class="go">                                folder_name=folder_name,</span>
<span class="go">                                name_append=&#39;mask-mcari2-90th&#39;, write_geotiff=True,</span>
<span class="go">                                mask_percentile=mask_percentile,</span>
<span class="go">                                mask_side=mask_side)</span>
<span class="go">Saving F:\nigo0024\Documents\hs_process_demo\spatial_mod\crop_many_gdf\mask_mcari2_90th\Wells_rep2_20180628_16h56m_pika_gige_7_plot_1011-mask-mcari2-90th.bip</span>
<span class="go">Saving F:\nigo0024\Documents\hs_process_demo\spatial_mod\crop_many_gdf\mask_mcari2_90th\Wells_rep2_20180628_16h56m_pika_gige_7_plot_1011-mask-mcari2-90th-spec-mean.spec</span>
<span class="gp">...</span>
</pre></div>
</div>
<img alt="../img/batch/segment_create_mask_inline.png" src="../img/batch/segment_create_mask_inline.png" />
<p><code class="docutils literal notranslate"><span class="pre">batch.segment_create_mask</span></code> creates a new folder in <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>
named according to the <code class="docutils literal notranslate"><span class="pre">folder_name</span></code> parameter
(in this case the new directory is
<code class="docutils literal notranslate"><span class="pre">F:\nigo0024\Documents\hs_process_demo\spatial_mod\crop_many_gdf\mask_mcari2_90th</span></code>)
which contains several data products. The <strong>first</strong> is
<code class="docutils literal notranslate"><span class="pre">mask-stats.csv</span></code>: a spreadsheet containing the band math
threshold value for each image file. In this example, the MCARI2
value corresponding to the 90th percentile is listed.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 32%" />
<col style="width: 32%" />
<col style="width: 35%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>fname</p></th>
<th class="head"><p>plot_id</p></th>
<th class="head"><p>lower-pctl-90</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>...</p></td>
<td><p>1011</p></td>
<td><p>0.83222</p></td>
</tr>
<tr class="row-odd"><td><p>...</p></td>
<td><p>1012</p></td>
<td><p>0.81112</p></td>
</tr>
<tr class="row-even"><td><p>...</p></td>
<td><p>1013</p></td>
<td><p>0.74394</p></td>
</tr>
</tbody>
</table>
<p>...etc.</p>
<p><strong>Second</strong> is a <code class="docutils literal notranslate"><span class="pre">geotiff</span></code> file for each of the image cubes after the
masking procedure. This can be opened in <em>QGIS</em> to visualize in
a spatial reference system, or can be opened using any software
that supports floating point <em>.tif</em> files. The masked pixels are
saved as <code class="docutils literal notranslate"><span class="pre">null</span></code> values and should render transparently.</p>
<img alt="../img/batch/segment_create_mask_geotiff.png" src="../img/batch/segment_create_mask_geotiff.png" />
<p><strong>Third</strong> is the full hyperspectral datacube, also with the masked
pixels saved as <code class="docutils literal notranslate"><span class="pre">null</span></code> values. Note that the only pixels
remaining are the 10% with the highest MCARI2 values.</p>
<img alt="../img/batch/segment_create_mask_datacube.png" src="../img/batch/segment_create_mask_datacube.png" />
<p><strong>Fourth</strong> is the mean spectra across the unmasked datacube pixels.
This is illustrated above by the green line plot (the light green
shadow represents the standard deviation for each band).</p>
</dd></dl>

<dl class="py method">
<dt id="hs_process.batch.spatial_crop">
<code class="sig-name descname"><span class="pre">spatial_crop</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname_sheet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bip'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spatial_crop'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_append</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spatial-crop'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_geotiff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'single'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gdf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_interleave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_byteorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/batch.html#batch.spatial_crop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.batch.spatial_crop" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterates through a spreadsheet that provides necessary information
about how each image should be cropped and how it should be saved.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">gdf</span></code> is passed (a geopandas.GoeDataFrame polygon file), the
cropped images will be shifted to the center of appropriate 'plot_id'
polygon.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname_sheet</strong> (<code class="docutils literal notranslate"><span class="pre">fname</span></code>, <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>, or <code class="docutils literal notranslate"><span class="pre">None</span></code>, optional) -- The filename of the spreadsheed that provides the
necessary information for fine-tuning the batch process
cropping. See below for more information about the required and
optional contents of <code class="docutils literal notranslate"><span class="pre">fname_sheet</span></code> and how to properly format
it. Optionally, <code class="docutils literal notranslate"><span class="pre">fname_sheet</span></code> can be a <code class="docutils literal notranslate"><span class="pre">Pandas.DataFrame</span></code>.
If left to <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">base_dir</span></code> and <code class="docutils literal notranslate"><span class="pre">gdf</span></code> must be passed.</p></li>
<li><p><strong>base_dir</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>, optional) -- directory path to search for files to
spatially crop; if <code class="docutils literal notranslate"><span class="pre">fname_sheet</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>,
<code class="docutils literal notranslate"><span class="pre">base_dir</span></code> will be ignored (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>base_dir_out</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>, optional) -- output directory of the cropped
image (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>folder_name</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>, optional) -- folder to add to <code class="docutils literal notranslate"><span class="pre">base_dir_out</span></code>
to save all the processed datacubes (default: 'spatial_crop').</p></li>
<li><p><strong>name_append</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>, optional) -- name to append to the filename
(default: 'spatial-crop').</p></li>
<li><p><strong>write_geotiff</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>, optional) -- whether to save an RGB image as
a geotiff alongside the cropped datacube.</p></li>
<li><p><strong>method</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>, optional) -- Must be one of &quot;single&quot; or
&quot;many_gdf&quot;. Indicates whether a single plot should be cropped
from the input datacube or if many/multiple plots should be
cropped from the input datacube. The &quot;single&quot; method leverages
<a class="reference external" href="hs_process.spatial_mod.html#hs_process.spatial_mod.crop_single">spatial_mod.crop_single()</a> and the &quot;many_gdf&quot; method
leverages <a class="reference external" href="hs_process.spatial_mod.html#hs_process.spatial_mod.crop_many_gdf">spatial_mod.crop_many_gdf()</a>. Please
see the <code class="docutils literal notranslate"><span class="pre">spatial_mod</span></code> documentation for more information
(default: &quot;single&quot;).</p></li>
<li><p><strong>gdf</strong> (<code class="docutils literal notranslate"><span class="pre">geopandas.GeoDataFrame</span></code>, optional) -- the plot names and
polygon geometery of each of the plots; 'plot_id' must be used as
a column name to identify each of the plots, and should be an
integer.</p></li>
<li><p><strong>out_XXX</strong> -- Settings for saving the output files can be adjusted here
if desired. They are stored in <code class="docutils literal notranslate"><span class="pre">batch.io.defaults</span></code>, and are
therefore accessible at a high level. See
<a class="reference external" href="hs_process.hsio.html#hs_process.hsio.set_io_defaults">hsio.set_io_defaults()</a> for more information on each of the
settings.</p></li>
</ul>
</dd>
</dl>
<p><strong>Tips and Tricks for</strong> <code class="docutils literal notranslate"><span class="pre">fname_sheet</span></code> <strong>when</strong> <code class="docutils literal notranslate"><span class="pre">gdf</span></code> <strong>is not passed</strong></p>
<p>If <code class="docutils literal notranslate"><span class="pre">gdf</span></code> is not passed, <code class="docutils literal notranslate"><span class="pre">fname_sheet</span></code> may have the following
required column headings that correspond to the relevant parameters in
<a class="reference external" href="hs_process.spatial_mod.html#hs_process.spatial_mod.crop_single">spatial_mod.crop_single()</a> and <a class="reference external" href="hs_process.spatial_mod.html#hs_process.spatial_mod.crop_many_gdf">spatial_mod.crop_many_gdf()</a>:</p>
<ol class="arabic simple">
<li><p>&quot;directory&quot;</p></li>
<li><p>&quot;name_short&quot;</p></li>
<li><p>&quot;name_long&quot;</p></li>
<li><p>&quot;ext&quot;</p></li>
<li><p>&quot;pix_e_ul&quot;</p></li>
<li><p>&quot;pix_n_ul&quot;.</p></li>
</ol>
<p>With this minimum input, <code class="docutils literal notranslate"><span class="pre">batch.spatial_crop</span></code> will read in each
image, crop from the upper left pixel (determined as
<code class="docutils literal notranslate"><span class="pre">pix_e_ul</span></code>/<code class="docutils literal notranslate"><span class="pre">pix_n_ul</span></code>) to the lower right pixel calculated
based on <code class="docutils literal notranslate"><span class="pre">crop_e_pix</span></code>/<code class="docutils literal notranslate"><span class="pre">crop_n_pix</span></code> (which is the width of the
cropped area in units of pixels).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">crop_e_pix</span></code> and <code class="docutils literal notranslate"><span class="pre">crop_n_pix</span></code> have default values (see
<a class="reference external" href="hs_process.defaults.html#hs_process.defaults.crop_defaults">defaults.crop_defaults()</a>), but they can also be passed
specifically for each datacube by including appropriate columns in
<code class="docutils literal notranslate"><span class="pre">fname_sheet</span></code> (which takes precedence over
<code class="docutils literal notranslate"><span class="pre">defaults.crop_defaults</span></code>).</p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">fname_sheet</span></code> may also have the following optional column headings:</p>
<ol class="arabic simple">
<li><p>&quot;crop_e_pix&quot;</p></li>
<li><p>&quot;crop_n_pix&quot;</p></li>
<li><p>&quot;crop_e_m&quot;</p></li>
<li><p>&quot;crop_n_m&quot;</p></li>
<li><p>&quot;buf_e_pix&quot;</p></li>
<li><p>&quot;buf_n_pix&quot;</p></li>
<li><p>&quot;buf_e_m&quot;</p></li>
<li><p>&quot;buf_n_m&quot;</p></li>
<li><p>&quot;gdf_shft_e_m&quot;</p></li>
<li><p>&quot;gdf_shft_n_m&quot;</p></li>
<li><p>&quot;plot_id_ref&quot;</p></li>
<li><p>&quot;study&quot;</p></li>
<li><p>&quot;date&quot;</p></li>
</ol>
<p><strong>More</strong> <code class="docutils literal notranslate"><span class="pre">fname_sheet</span></code> <strong>Tips and Tricks</strong></p>
<ol class="arabic simple">
<li><p>These optional inputs passed via <code class="docutils literal notranslate"><span class="pre">fname_sheet</span></code> allow more control
over exactly how the images are to be cropped. For a more detailed
explanation of the information that many of these columns are
intended to contain, see the documentation for
<a class="reference external" href="hs_process.spatial_mod.html#hs_process.spatial_mod.crop_single">spatial_mod.crop_single()</a> and <a class="reference external" href="hs_process.spatial_mod.html#hs_process.spatial_mod.crop_many_gdf">spatial_mod.crop_many_gdf()</a>.
Those parameters not referenced should be apparent in the API
examples and tutorials.</p></li>
<li><p>If the column names are different in <code class="docutils literal notranslate"><span class="pre">fname_sheet</span></code> than described
here, <a class="reference external" href="hs_process.defaults.html#hs_process.defaults.spat_crop_cols">defaults.spat_crop_cols()</a> can be modified to indicate which
columns correspond to the relevant information.</p></li>
<li><p>The <em>date</em> and <em>study</em> columns do not impact how the datacubes are
to be cropped, but if this information exists,
<code class="docutils literal notranslate"><span class="pre">batch.spatial_crop</span></code> adds it to the filename of the cropped
datacube. This can be used to avoid overwriting datacubes with
similar names, and is especially useful when processing imagery from
many dates and/or studies/locations and saving them in the same
directory. If &quot;study&quot;, &quot;date&quot;, and &quot;plot_id&quot; are all passed, this
information is used to formulate the output file name; e.g.,
<em>study_wells_date_20180628_plot_527-spatial-crop.bip</em>. If either
&quot;study&quot; or &quot;date&quot; is missing, the populated variables wil be
appended to the end of the <code class="docutils literal notranslate"><span class="pre">hsio.name_short</span></code> string; e.g.,
<em>plot_9_3_pika_gige_1_plot_527-spatial-crop.bip</em>.</p></li>
<li><p>Any other columns can be added to <code class="docutils literal notranslate"><span class="pre">fname_sheet</span></code>, but
<code class="docutils literal notranslate"><span class="pre">batch.spatial_crop()</span></code> does not use them in any way.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following <code class="docutils literal notranslate"><span class="pre">batch</span></code> example only actually processes <em>a single</em>
hyperspectral image. If more datacubes were present in
<code class="docutils literal notranslate"><span class="pre">base_dir</span></code>, however, <code class="docutils literal notranslate"><span class="pre">batch.spatial_crop</span></code> would process all
datacubes that were available.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This example uses <code class="docutils literal notranslate"><span class="pre">spatial_mod.crop_many_gdf</span></code> to crop many
plots from a datacube using a polygon geometry file describing the
spatial extent of each plot.</p>
</div>
<p class="rubric">Example</p>
<p>Load and initialize the <code class="docutils literal notranslate"><span class="pre">batch</span></code> module, checking to be sure the
directory exists.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">batch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">base_dir</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span> <span class="o">=</span> <span class="n">batch</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">search_ext</span><span class="o">=</span><span class="s1">&#39;.bip&#39;</span><span class="p">,</span> <span class="n">dir_level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="go">                    progress_bar=True)  # searches for all files in ``base_dir`` with a &quot;.bip&quot; file extension</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Load the plot geometry as a <code class="docutils literal notranslate"><span class="pre">geopandas.GeoDataFrame</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fname_gdf</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\plot_bounds.geojson&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">fname_gdf</span><span class="p">)</span>
</pre></div>
</div>
<p>Perform the spatial cropping using the <em>&quot;many_gdf&quot;</em> <cite>method</cite>. Note
that nothing is being passed to <cite>fname_sheet</cite> here, so
<code class="docutils literal notranslate"><span class="pre">batch.spatial_crop</span></code> is simply going to attempt to crop all plots
contained within <cite>gdf</cite> that overlap with any datacubes in
<code class="docutils literal notranslate"><span class="pre">base_dir</span></code>.</p>
<p>Passing <code class="docutils literal notranslate"><span class="pre">fname_sheet</span></code> directly is definitely more flexible for
customization. However, some customization is possible while not
passing <code class="docutils literal notranslate"><span class="pre">fname_sheet</span></code>. In the example below, we set an easting
and northing buffer, as well as limit the number of plots to crop
to 40. These defaults trickle through to
<code class="docutils literal notranslate"><span class="pre">spatial_mod.crop_many_gdf()</span></code>, so by setting them on the
<code class="docutils literal notranslate"><span class="pre">batch</span></code> object, they will be recognized when calculating crop
boundaries from <code class="docutils literal notranslate"><span class="pre">gdf</span></code>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">defaults</span><span class="o">.</span><span class="n">crop_defaults</span><span class="o">.</span><span class="n">buf_e_m</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># Sets buffer in the easting direction (units of meters)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">defaults</span><span class="o">.</span><span class="n">crop_defaults</span><span class="o">.</span><span class="n">buf_n_m</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">defaults</span><span class="o">.</span><span class="n">crop_defaults</span><span class="o">.</span><span class="n">n_plots</span> <span class="o">=</span> <span class="mi">40</span>  <span class="c1"># We can limit the number of plots to process from gdf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span><span class="o">.</span><span class="n">spatial_crop</span><span class="p">(</span><span class="n">base_dir</span><span class="o">=</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;many_gdf&#39;</span><span class="p">,</span>
<span class="go">                         gdf=gdf, out_force=True)</span>
</pre></div>
</div>
<p>Because <code class="docutils literal notranslate"><span class="pre">fname_list</span></code> was passed instead of <code class="docutils literal notranslate"><span class="pre">fname_sheet</span></code>, there is not a way to infer the study name and date. Therefore, &quot;study&quot; and &quot;date&quot; will be omitted from the output file name. If you would like output file names to include &quot;study&quot; and &quot;date&quot;, please pass <code class="docutils literal notranslate"><span class="pre">fname_sheet</span></code> with &quot;study&quot; and &quot;date&quot; columns.</p>
<p>Processing file 39/40: 100%|██████████| 40/40 [00:02&lt;00:00, 17.47it/s]</p>
<img alt="_images/spatial_crop_inline.png" src="_images/spatial_crop_inline.png" />
<p>A new folder was created in <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>
- <code class="docutils literal notranslate"><span class="pre">F:\nigo0024\Documents\hs_process_demo\spatial_crop</span></code> - that
contains the cropped datacubes and the cropped <code class="docutils literal notranslate"><span class="pre">geotiff</span></code> images.
The Plot ID from the <code class="docutils literal notranslate"><span class="pre">gdf</span></code> is used to name each datacube
according to its plot ID. The <code class="docutils literal notranslate"><span class="pre">geotiff</span></code> images can be opened in
<em>QGIS</em> to visualize the images after cropping them.</p>
<img alt="../img/batch/spatial_crop_tifs.png" src="../img/batch/spatial_crop_tifs.png" />
<p>The cropped images were brightened in <em>QGIS</em> to emphasize the
cropped boundaries. The plot boundaries are overlaid for reference
(notice the 2.0 m buffer on the East/West ends and the 0.5 m buffer
on the North/South sides).</p>
</dd></dl>

<dl class="py method">
<dt id="hs_process.batch.spectra_combine">
<code class="sig-name descname"><span class="pre">spectra_combine</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bip'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_interleave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_byteorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/batch.html#batch.spectra_combine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.batch.spectra_combine" title="Permalink to this definition">¶</a></dt>
<dd><p>Batch processing tool to gather all pixels from every image in a
directory, compute the mean and standard deviation, and save as a
single spectra (i.e., a spectra file is equivalent to a single spectral
pixel with no spatial information).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname_list</strong> (<code class="docutils literal notranslate"><span class="pre">list</span></code>, optional) -- list of filenames to process; if
left to <code class="docutils literal notranslate"><span class="pre">None</span></code>, will look at <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>, <code class="docutils literal notranslate"><span class="pre">search_ext</span></code>,
and <code class="docutils literal notranslate"><span class="pre">dir_level</span></code> parameters for files to process (default:
<code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>base_dir</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>, optional) -- directory path to search for files to
spectrally clip; if <code class="docutils literal notranslate"><span class="pre">fname_list</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>,
<code class="docutils literal notranslate"><span class="pre">base_dir</span></code> will be ignored (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>search_ext</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- file format/extension to search for in all
directories and subdirectories to determine which files to
process; if <code class="docutils literal notranslate"><span class="pre">fname_list</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">search_ext</span></code> will
be ignored (default: 'bip').</p></li>
<li><p><strong>dir_level</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- The number of directory levels to search; if
<code class="docutils literal notranslate"><span class="pre">None</span></code>, searches all directory levels (default: 0).</p></li>
<li><p><strong>base_dir_out</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- directory path to save all processed
datacubes; if set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, a folder named according to the
<code class="docutils literal notranslate"><span class="pre">folder_name</span></code> parameter is added to <code class="docutils literal notranslate"><span class="pre">base_dir</span></code> (default:
<code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>out_XXX</strong> -- Settings for saving the output files can be adjusted here
if desired. They are stored in <code class="docutils literal notranslate"><span class="pre">batch.io.defaults,</span> <span class="pre">and</span> <span class="pre">are</span>
<span class="pre">therefore</span> <span class="pre">accessible</span> <span class="pre">at</span> <span class="pre">a</span> <span class="pre">high</span> <span class="pre">level.</span> <span class="pre">See</span>
<span class="pre">``hsio.set_io_defaults()</span></code> for more information on each of the
settings.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following example will load in several small hyperspectral
radiance datacubes <em>(not reflectance)</em> that were previously cropped
manually (via Spectronon software). These datacubes represent the
radiance values of grey reference panels that were placed in the
field to provide data necessary for converting radiance imagery
to reflectance. These particular datacubes were extracted
from several different images captured within ~10 minutes of each
other.</p>
</div>
<p class="rubric">Example</p>
<p>Load and initialize the <code class="docutils literal notranslate"><span class="pre">batch</span></code> module, checking to be sure the
directory exists.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">batch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\cube_ref_panels&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">base_dir</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span> <span class="o">=</span> <span class="n">batch</span><span class="p">(</span><span class="n">base_dir</span><span class="p">)</span>
</pre></div>
</div>
<p>Combine all the <em>radiance</em> datacubes in the directory via
<code class="docutils literal notranslate"><span class="pre">batch.spectra_combine</span></code>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span><span class="o">.</span><span class="n">spectra_combine</span><span class="p">(</span><span class="n">base_dir</span><span class="o">=</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">search_ext</span><span class="o">=</span><span class="s1">&#39;bip&#39;</span><span class="p">,</span>
<span class="go">                            dir_level=0)</span>
<span class="go">Combining datacubes/spectra into a single mean spectra.</span>
<span class="go">Number of input datacubes/spectra: 7</span>
<span class="go">Total number of pixels: 1516</span>
<span class="go">Saving F:\nigo0024\Documents\hs_process_demo\cube_ref_panels\spec_mean_spy.spec</span>
</pre></div>
</div>
<p>Visualize the combined spectra by opening in <em>Spectronon</em>. The
solid line represents the mean radiance spectra across all pixels
and images in <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>, and the lighter, slightly transparent
line represents the standard deviation of the radiance across all
pixels and images in <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>.</p>
<img alt="../img/batch/spectra_combine.png" src="../img/batch/spectra_combine.png" />
<p>Notice the lower signal at the oxygen absorption region (near 770
nm). After converting datacubes to reflectance, it may be
desireable to spectrally clip this region (see
<a class="reference external" href="hs_process.spec_mod.html#hs_process.spec_mod.spectral_clip">spec_mod.spectral_clip()</a>)</p>
</dd></dl>

<dl class="py method">
<dt id="hs_process.batch.spectra_derivative">
<code class="sig-name descname"><span class="pre">spectra_derivative</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spec'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spec_derivative'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_append</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spec-derivative'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_interleave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_byteorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/batch.html#batch.spectra_derivative"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.batch.spectra_derivative" title="Permalink to this definition">¶</a></dt>
<dd><p>Batch processing tool to calculate the numeric spectral derivative for
multiple spectra.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname_list</strong> (<code class="docutils literal notranslate"><span class="pre">list</span></code>, optional) -- list of filenames to process; if
left to <code class="docutils literal notranslate"><span class="pre">None</span></code>, will look at <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>, <code class="docutils literal notranslate"><span class="pre">search_ext</span></code>,
and <code class="docutils literal notranslate"><span class="pre">dir_level</span></code> parameters for files to process (default:
<code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>base_dir</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>, optional) -- directory path to search for files to
process; if <code class="docutils literal notranslate"><span class="pre">fname_list</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">base_dir</span></code> will
be ignored (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>search_ext</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- file format/extension to search for in all
directories and subdirectories to determine which files to
process; if <code class="docutils literal notranslate"><span class="pre">fname_list</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">search_ext</span></code> will
be ignored (default: 'bip').</p></li>
<li><p><strong>dir_level</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- The number of directory levels to search; if
<code class="docutils literal notranslate"><span class="pre">None</span></code>, searches all directory levels (default: 0).</p></li>
<li><p><strong>base_dir_out</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- directory path to save all processed
spectra; if set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, a folder named according to the
<code class="docutils literal notranslate"><span class="pre">folder_name</span></code> parameter is added to <code class="docutils literal notranslate"><span class="pre">base_dir</span></code></p></li>
<li><p><strong>folder_name</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- folder to add to <code class="docutils literal notranslate"><span class="pre">base_dir_out</span></code> to save
all the processed datacubes (default: 'spec_derivative').</p></li>
<li><p><strong>name_append</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- name to append to the filename (default:
'spec-derivative').</p></li>
<li><p><strong>order</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- The order of the derivative (default: 1).</p></li>
<li><p><strong>out_XXX</strong> -- Settings for saving the output files can be adjusted here
if desired. They are stored in <code class="docutils literal notranslate"><span class="pre">batch.io.defaults,</span> <span class="pre">and</span> <span class="pre">are</span>
<span class="pre">therefore</span> <span class="pre">accessible</span> <span class="pre">at</span> <span class="pre">a</span> <span class="pre">high</span> <span class="pre">level.</span> <span class="pre">See</span>
<span class="pre">``hsio.set_io_defaults()</span></code> for more information on each of the
settings.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following <cite>batch</cite> example builds on the API example results
of the <a class="reference external" href="hs_process.batch.html#hs_process.batch.cube_to_spectra">batch.cube_to_spectra</a> function. Please complete
both the <a class="reference external" href="hs_process.spatial_mod.html#hs_process.spatial_mod.crop_many_gdf">spatial_mod.crop_many_gdf</a> and
<a class="reference external" href="hs_process.batch.html#hs_process.batch.cube_to_spectra">batch.cube_to_spectra</a> examples to be sure your directory
(i.e., <cite>base_dir</cite>) is populated with multiple hyperspectral
spectra. The following example will be using spectra located in the
following directory:
<code class="docutils literal notranslate"><span class="pre">F:\nigo0024\Documents\hs_process_demo\spatial_mod\crop_many_gdf\cube_to_spec</span></code></p>
</div>
<p class="rubric">Example</p>
<p>Load and initialize the <code class="docutils literal notranslate"><span class="pre">batch</span></code> module, checking to be sure the
directory exists.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">batch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;spatial_mod&#39;</span><span class="p">,</span> <span class="s1">&#39;crop_many_gdf&#39;</span><span class="p">,</span> <span class="s1">&#39;cube_to_spec&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">base_dir</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span> <span class="o">=</span> <span class="n">batch</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">search_ext</span><span class="o">=</span><span class="s1">&#39;.spec&#39;</span><span class="p">,</span> <span class="n">progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Use <code class="docutils literal notranslate"><span class="pre">batch.spectra_derivative</span></code> to calculate the central finite
difference (i.e., the numeric spectral derivative) for each of the
.spec files in <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">order</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span><span class="o">.</span><span class="n">spectra_derivative</span><span class="p">(</span><span class="n">base_dir</span><span class="o">=</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">out_force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Use seaborn to visualize the derivative spectra of plots 1011,
1012, and 1013.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">re</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s1">&#39;spec_derivative&#39;</span><span class="p">,</span> <span class="s1">&#39;Wells_rep2_20180628_16h56m_pika_gige_7_plot_1011-spec-derivative-order-</span><span class="si">{0}</span><span class="s1">.spec&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">order</span><span class="p">)),</span>
<span class="go">                  os.path.join(base_dir, &#39;spec_derivative&#39;, &#39;Wells_rep2_20180628_16h56m_pika_gige_7_plot_1012-spec-derivative-order-{0}.spec&#39;.format(order)),</span>
<span class="go">                  os.path.join(base_dir, &#39;spec_derivative&#39;, &#39;Wells_rep2_20180628_16h56m_pika_gige_7_plot_1013-spec-derivative-order-{0}.spec&#39;.format(order))]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">fname</span> <span class="ow">in</span> <span class="n">fname_list</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_spec</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">meta_bands</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">meta_bands</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">data</span> <span class="o">=</span> <span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile_spec</span><span class="o">.</span><span class="n">open_memmap</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">hist</span> <span class="o">=</span> <span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile_spec</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;history&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pix_n</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;&lt;pixel number: (?s)(.*)&gt;] -&gt;&#39;</span><span class="p">,</span> <span class="n">hist</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">meta_bands</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Plot &#39;</span><span class="o">+</span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">name_plot</span><span class="o">+</span><span class="s1">&#39; (n=&#39;</span><span class="o">+</span><span class="n">pix_n</span><span class="o">+</span><span class="s1">&#39;)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">else</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Plot &#39;</span><span class="o">+</span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">name_plot</span><span class="o">+</span><span class="s1">&#39; (n=&#39;</span><span class="o">+</span><span class="n">pix_n</span><span class="o">+</span><span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavelength (nm)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Derivative reflectance (%)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;API Example: `batch.spectra_derivative`&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../img/batch/spectra_derivative.png" src="../img/batch/spectra_derivative.png" />
</dd></dl>

<dl class="py method">
<dt id="hs_process.batch.spectra_to_csv">
<code class="sig-name descname"><span class="pre">spectra_to_csv</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spec'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'stats-spectra'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multithread</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/batch.html#batch.spectra_to_csv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.batch.spectra_to_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads all the <code class="docutils literal notranslate"><span class="pre">.spec</span></code> files in a direcory and saves their reflectance
information to a <code class="docutils literal notranslate"><span class="pre">.csv</span></code>. <code class="docutils literal notranslate"><span class="pre">batch.spectra_to_csv</span></code> is identical to
<code class="docutils literal notranslate"><span class="pre">batch.spectra_to_df</span></code> except a <code class="docutils literal notranslate"><span class="pre">.csv</span></code> file is saved rather than
returning a <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname_list</strong> (<code class="docutils literal notranslate"><span class="pre">list</span></code>, optional) -- list of filenames to process; if
left to <code class="docutils literal notranslate"><span class="pre">None</span></code>, will look at <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>, <code class="docutils literal notranslate"><span class="pre">search_ext</span></code>, and
<code class="docutils literal notranslate"><span class="pre">dir_level</span></code> parameters for files to process (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>base_dir</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>, optional) -- directory path to search for files to
spectrally clip; if <code class="docutils literal notranslate"><span class="pre">fname_list</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">base_dir</span></code> will
be ignored (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>search_ext</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- file format/extension to search for in all
directories and subdirectories to determine which files to
process; if <code class="docutils literal notranslate"><span class="pre">fname_list</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">search_ext</span></code> will
be ignored (default: 'bip').</p></li>
<li><p><strong>dir_level</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- The number of directory levels to search; if
<code class="docutils literal notranslate"><span class="pre">None</span></code>, searches all directory levels (default: 0).</p></li>
<li><p><strong>base_dir_out</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- directory path to save all processed
datacubes; if set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, file is saved to <code class="docutils literal notranslate"><span class="pre">base_dir</span></code></p></li>
<li><p><strong>name</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- The output filename (default: &quot;stats-spectra&quot;).</p></li>
<li><p><strong>multithread</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- Whether to leverage multi-thread processing
when reading the .spec files. Setting to <code class="docutils literal notranslate"><span class="pre">True</span></code> should speed
up the time it takes to read all .spec files.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following example builds on the API example results of
<a class="reference external" href="hs_process.batch.html#hs_process.batch.segment_band_math">batch.segment_band_math()</a> and <cite>batch.segment_create_mask()_.
Please complete each of those API examples to be sure your
directory (i.e.,
``F:nigo0024Documentshs_process_demospatial_modcrop_many_gdfmask_mcari2_90th`</cite>)
is populated with image files.</p>
</div>
<p class="rubric">Example</p>
<p>Load and initialize the <code class="docutils literal notranslate"><span class="pre">batch</span></code> module, checking to be sure the
directory exists.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">batch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\spatial_mod\crop_many_gdf\mask_mcari2_90th&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">base_dir</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span> <span class="o">=</span> <span class="n">batch</span><span class="p">(</span><span class="n">base_dir</span><span class="p">)</span>
</pre></div>
</div>
<p>Read all the <code class="docutils literal notranslate"><span class="pre">.spec</span></code> files in <code class="docutils literal notranslate"><span class="pre">base_dir</span></code> and save them to a
<code class="docutils literal notranslate"><span class="pre">.csv</span></code> file.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span><span class="o">.</span><span class="n">spectra_to_csv</span><span class="p">(</span><span class="n">base_dir</span><span class="o">=</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">search_ext</span><span class="o">=</span><span class="s1">&#39;spec&#39;</span><span class="p">,</span>
<span class="go">                           dir_level=0)</span>
<span class="go">Writing mean spectra to a .csv file.</span>
<span class="go">Number of input datacubes/spectra: 40</span>
<span class="go">Output file location: F:\nigo0024\Documents\hs_process_demo\spatial_mod\crop_many_gdf\mask_mcari2_90th\stats-spectra.csv</span>
</pre></div>
</div>
<p>When <code class="docutils literal notranslate"><span class="pre">stats-spectra.csv</span></code> is opened in Microsoft Excel, we can see
that each row is a <code class="docutils literal notranslate"><span class="pre">.spec</span></code> file from a different plot, and each
column is a particular spectral band/wavelength.</p>
<img alt="../img/batch/spectra_to_csv.png" src="../img/batch/spectra_to_csv.png" />
</dd></dl>

<dl class="py method">
<dt id="hs_process.batch.spectra_to_df">
<code class="sig-name descname"><span class="pre">spectra_to_df</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spec'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multithread</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/batch.html#batch.spectra_to_df"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.batch.spectra_to_df" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads all the .spec files in a direcory and returns their data as a
<code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> object. <code class="docutils literal notranslate"><span class="pre">batch.spectra_to_df</span></code> is identical to
<code class="docutils literal notranslate"><span class="pre">batch.spectra_to_csv</span></code> except a <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> is returned
rather than saving a <code class="docutils literal notranslate"><span class="pre">.csv</span></code> file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname_list</strong> (<code class="docutils literal notranslate"><span class="pre">list</span></code>, optional) -- list of filenames to process; if
left to <code class="docutils literal notranslate"><span class="pre">None</span></code>, will look at <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>, <code class="docutils literal notranslate"><span class="pre">search_ext</span></code>, and
<code class="docutils literal notranslate"><span class="pre">dir_level</span></code> parameters for files to process (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>base_dir</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>, optional) -- directory path to search for files to
spectrally clip; if <code class="docutils literal notranslate"><span class="pre">fname_list</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">base_dir</span></code> will
be ignored (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>search_ext</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- file format/extension to search for in all
directories and subdirectories to determine which files to
process; if <code class="docutils literal notranslate"><span class="pre">fname_list</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">search_ext</span></code> will
be ignored (default: 'bip').</p></li>
<li><p><strong>dir_level</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- The number of directory levels to search; if
<code class="docutils literal notranslate"><span class="pre">None</span></code>, searches all directory levels (default: 0).</p></li>
<li><p><strong>multithread</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- Whether to leverage multi-thread processing
when reading the .spec files. Setting to <code class="docutils literal notranslate"><span class="pre">True</span></code> should speed
up the time it takes to read all .spec files.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following example builds on the API example results of
<a class="reference external" href="hs_process.batch.html#hs_process.batch.segment_band_math">batch.segment_band_math()</a> and <cite>batch.segment_create_mask()_.
Please complete each of those API examples to be sure your
directory (i.e.,
``F:nigo0024Documentshs_process_demospatial_modcrop_many_gdfmask_mcari2_90th`</cite>)
is populated with image files.</p>
</div>
<p class="rubric">Example</p>
<p>Load and initialize the <code class="docutils literal notranslate"><span class="pre">batch</span></code> module, checking to be sure the
directory exists.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">batch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\spatial_mod\crop_many_gdf\mask_mcari2_90th&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">base_dir</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span> <span class="o">=</span> <span class="n">batch</span><span class="p">(</span><span class="n">base_dir</span><span class="p">)</span>
</pre></div>
</div>
<p>Read all the <code class="docutils literal notranslate"><span class="pre">.spec</span></code> files in <code class="docutils literal notranslate"><span class="pre">base_dir</span></code> and load them to
<code class="docutils literal notranslate"><span class="pre">df_spec</span></code>, a <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df_spec</span> <span class="o">=</span> <span class="n">hsbatch</span><span class="o">.</span><span class="n">spectra_to_df</span><span class="p">(</span><span class="n">base_dir</span><span class="o">=</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">search_ext</span><span class="o">=</span><span class="s1">&#39;spec&#39;</span><span class="p">,</span>
<span class="go">                                    dir_level=0)</span>
<span class="go">Writing mean spectra to a ``pandas.DataFrame``.</span>
<span class="go">Number of input datacubes/spectra: 40</span>
</pre></div>
</div>
<p>When visualizing <code class="docutils literal notranslate"><span class="pre">df_spe</span></code> in <a class="reference external" href="https://www.spyder-ide.org/">Spyder</a>, we can see that each row
is a <code class="docutils literal notranslate"><span class="pre">.spec</span></code> file from a different plot, and each column is a
particular spectral band.</p>
<img alt="../img/batch/spectra_to_df.png" src="../img/batch/spectra_to_df.png" />
<p>It is somewhat confusing to conceptualize spectral data by band
number (as opposed to the wavelenth it represents).
<code class="docutils literal notranslate"><span class="pre">hs_process.hs_tools.get_band</span></code> can be used to retrieve
spectral data for all plots via indexing by wavelength. Say we need
to access reflectance at 710 nm for each plot.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df_710nm</span> <span class="o">=</span> <span class="n">df_spec</span><span class="p">[[</span><span class="s1">&#39;fname&#39;</span><span class="p">,</span> <span class="s1">&#39;plot_id&#39;</span><span class="p">,</span> <span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_band</span><span class="p">(</span><span class="mi">710</span><span class="p">)]]</span>
</pre></div>
</div>
<img alt="../img/batch/spectra_to_df_710nm.png" src="../img/batch/spectra_to_df_710nm.png" />
</dd></dl>

<dl class="py method">
<dt id="hs_process.batch.spectral_clip">
<code class="sig-name descname"><span class="pre">spectral_clip</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bip'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spec_clip'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_append</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spec-clip'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wl_bands</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[[0,</span> <span class="pre">420],</span> <span class="pre">[760,</span> <span class="pre">776],</span> <span class="pre">[813,</span> <span class="pre">827],</span> <span class="pre">[880,</span> <span class="pre">1000]]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_interleave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_byteorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/batch.html#batch.spectral_clip"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.batch.spectral_clip" title="Permalink to this definition">¶</a></dt>
<dd><p>Batch processing tool to spectrally clip multiple datacubes in the same
way.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname_list</strong> (<code class="docutils literal notranslate"><span class="pre">list</span></code>, optional) -- list of filenames to process; if
left to <code class="docutils literal notranslate"><span class="pre">None</span></code>, will look at <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>, <code class="docutils literal notranslate"><span class="pre">search_ext</span></code>, and
<code class="docutils literal notranslate"><span class="pre">dir_level</span></code> parameters for files to process (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>base_dir</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>, optional) -- directory path to search for files to
spectrally clip; if <code class="docutils literal notranslate"><span class="pre">fname_list</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">base_dir</span></code> will
be ignored (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>search_ext</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- file format/extension to search for in all
directories and subdirectories to determine which files to
process; if <code class="docutils literal notranslate"><span class="pre">fname_list</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">search_ext</span></code> will
be ignored (default: 'bip').</p></li>
<li><p><strong>dir_level</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- The number of directory levels to search; if
<code class="docutils literal notranslate"><span class="pre">None</span></code>, searches all directory levels (default: 0).</p></li>
<li><p><strong>base_dir_out</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- directory path to save all processed
datacubes; if set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, a folder named according to the
<code class="docutils literal notranslate"><span class="pre">folder_name</span></code> parameter is added to <code class="docutils literal notranslate"><span class="pre">base_dir</span></code></p></li>
<li><p><strong>folder_name</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- folder to add to <code class="docutils literal notranslate"><span class="pre">base_dir_out</span></code> to save all
the processed datacubes (default: 'spec-clip').</p></li>
<li><p><strong>name_append</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- name to append to the filename (default:
'spec-clip').</p></li>
<li><p><strong>wl_bands</strong> (<code class="docutils literal notranslate"><span class="pre">list</span></code> or <code class="docutils literal notranslate"><span class="pre">list</span> <span class="pre">of</span> <span class="pre">lists</span></code>) -- minimum and maximum
wavelenths to clip from image; if multiple groups of
wavelengths should be cut, this should be a list of lists. For
example, wl_bands=[760, 776] will clip all bands greater than
760.0 nm and less than 776.0 nm;
wl_bands = [[0, 420], [760, 776], [813, 827], [880, 1000]]
will clip all band less than 420.0 nm, bands greater than 760.0
nm and less than 776.0 nm, bands greater than 813.0 nm and less
than 827.0 nm, and bands greater than 880 nm (default).</p></li>
<li><p><strong>out_XXX</strong> -- Settings for saving the output files can be adjusted here
if desired. They are stored in <code class="docutils literal notranslate"><span class="pre">batch.io.defaults,</span> <span class="pre">and</span> <span class="pre">are</span>
<span class="pre">therefore</span> <span class="pre">accessible</span> <span class="pre">at</span> <span class="pre">a</span> <span class="pre">high</span> <span class="pre">level.</span> <span class="pre">See</span>
<span class="pre">``hsio.set_io_defaults()</span></code> for more information on each of the
settings.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following <code class="docutils literal notranslate"><span class="pre">batch</span></code> example builds on the API example results
of the <a class="reference external" href="hs_process.batch.html#hs_process.batch.spatial_crop">batch.spatial_crop</a> function. Please complete the
<a class="reference external" href="hs_process.batch.html#hs_process.batch.spatial_crop">batch.spatial_crop</a> example to be sure your directory
(i.e., <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>) is populated with multiple hyperspectral
datacubes. The following example will be using datacubes located in
the following directory:
<code class="docutils literal notranslate"><span class="pre">F:\nigo0024\Documents\hs_process_demo\spatial_crop</span></code></p>
</div>
<p class="rubric">Example</p>
<p>Load and initialize the <code class="docutils literal notranslate"><span class="pre">batch</span></code> module, checking to be sure the
directory exists.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">batch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\spatial_crop&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">base_dir</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span> <span class="o">=</span> <span class="n">batch</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">search_ext</span><span class="o">=</span><span class="s1">&#39;.bip&#39;</span><span class="p">,</span> <span class="n">progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># searches for all files in ``base_dir`` with a &quot;.bip&quot; file extension</span>
</pre></div>
</div>
<p>Use <code class="docutils literal notranslate"><span class="pre">batch.spectral_clip</span></code> to clip all spectral bands below
<em>420 nm</em> and above <em>880 nm</em>, as well as the bands near the oxygen
absorption (i.e., <em>760-776 nm</em>) and water absorption
(i.e., <em>813-827 nm</em>) regions.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span><span class="o">.</span><span class="n">spectral_clip</span><span class="p">(</span><span class="n">base_dir</span><span class="o">=</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">folder_name</span><span class="o">=</span><span class="s1">&#39;spec_clip&#39;</span><span class="p">,</span>
<span class="go">                          wl_bands=[[0, 420], [760, 776], [813, 827], [880, 1000]],</span>
<span class="go">                          out_force=True)</span>
<span class="go">Processing 40 files. If this is not what is expected, please check if files have already undergone processing. If existing files should be overwritten, be sure to set the ``out_force`` parameter.</span>
<span class="go">Processing file 39/40: 100%|██████████| 40/40 [00:01&lt;00:00, 26.68it/s]</span>
</pre></div>
</div>
<p>Use <code class="docutils literal notranslate"><span class="pre">seaborn</span></code> to visualize the spectra of a single pixel in one
of the processed images.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s1">&#39;Wells_rep2_20180628_16h56m_pika_gige_7_1011-spatial-crop.bip&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_cube</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spy_mem</span> <span class="o">=</span> <span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">open_memmap</span><span class="p">()</span>  <span class="c1"># datacube before clipping</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">meta_bands</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">meta_bands</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s1">&#39;spec_clip&#39;</span><span class="p">,</span> <span class="s1">&#39;Wells_rep2_20180628_16h56m_pika_gige_7_1011-spec-clip.bip&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_cube</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spy_mem_clip</span> <span class="o">=</span> <span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">open_memmap</span><span class="p">()</span>  <span class="c1"># datacube after clipping</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">meta_bands_clip</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">meta_bands</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">spy_mem</span><span class="p">[</span><span class="mi">26</span><span class="p">][</span><span class="mi">29</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Before spectral clipping&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands_clip</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">spy_mem_clip</span><span class="p">[</span><span class="mi">26</span><span class="p">][</span><span class="mi">29</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;After spectral clipping&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavelength (nm)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Reflectance (%)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;API Example: `batch.spectral_clip`&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../img/batch/spectral_clip_plot.png" src="../img/batch/spectral_clip_plot.png" />
<p>Notice the spectral areas that were clipped, namely the oxygen and
water absorption regions (~770 and ~820 nm, respectively). There
is perhaps a lower <em>signal:noise</em> ratio in these regions, which was
the merit for clipping those bands out.</p>
</dd></dl>

<dl class="py method">
<dt id="hs_process.batch.spectral_mimic">
<code class="sig-name descname"><span class="pre">spectral_mimic</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bip'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spec_mimic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_append</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spec-mimic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sentinel-2a'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_band_response</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_wl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wl_nm'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_wl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'peak'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_interleave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_byteorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/batch.html#batch.spectral_mimic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.batch.spectral_mimic" title="Permalink to this definition">¶</a></dt>
<dd><p>Batch processing tool to spectrally mimic a multispectral sensor for
multiple datacubes in the same way.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname_list</strong> (<code class="docutils literal notranslate"><span class="pre">list</span></code>, optional) -- list of filenames to process; if
left to <code class="docutils literal notranslate"><span class="pre">None</span></code>, will look at <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>, <code class="docutils literal notranslate"><span class="pre">search_ext</span></code>,
and <code class="docutils literal notranslate"><span class="pre">dir_level</span></code> parameters for files to process (default:
<code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>base_dir</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>, optional) -- directory path to search for files to
spectrally resample; if <code class="docutils literal notranslate"><span class="pre">fname_list</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>,
<code class="docutils literal notranslate"><span class="pre">base_dir</span></code> will be ignored (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>search_ext</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- file format/extension to search for in all
directories and subdirectories to determine which files to
process; if <code class="docutils literal notranslate"><span class="pre">fname_list</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">search_ext</span></code> will
be ignored (default: 'bip').</p></li>
<li><p><strong>dir_level</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- The number of directory levels to search; if
<code class="docutils literal notranslate"><span class="pre">None</span></code>, searches all directory levels (default: 0).</p></li>
<li><p><strong>base_dir_out</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- directory path to save all processed
datacubes; if set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, a folder named according to the
<code class="docutils literal notranslate"><span class="pre">folder_name</span></code> parameter is added to <code class="docutils literal notranslate"><span class="pre">base_dir</span></code></p></li>
<li><p><strong>folder_name</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- folder to add to <code class="docutils literal notranslate"><span class="pre">base_dir_out</span></code> to save
all the processed datacubes (default: 'spec_bin').</p></li>
<li><p><strong>name_append</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- name to append to the filename (default:
'spec-bin').</p></li>
<li><p><strong>sensor</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- Should be one of
[&quot;sentera_6x&quot;, &quot;micasense_rededge_3&quot;, &quot;sentinel-2a&quot;,
&quot;sentinel-2b&quot;, &quot;custom&quot;]; if &quot;custom&quot;, <code class="docutils literal notranslate"><span class="pre">df_band_response</span></code>
and <code class="docutils literal notranslate"><span class="pre">col_wl</span></code> must be passed.</p></li>
<li><p><strong>df_band_response</strong> (<code class="docutils literal notranslate"><span class="pre">pd.DataFrame</span></code>) -- A DataFrame that contains the
transmissivity (%) for each sensor band (as columns) mapped to
the continuous wavelength values (as rows). Required if
<code class="docutils literal notranslate"><span class="pre">sensor</span></code> is  &quot;custom&quot;, ignored otherwise.</p></li>
<li><p><strong>col_wl</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- The column of <code class="docutils literal notranslate"><span class="pre">df_band_response</span></code> denoting the
wavlengths (default: 'wl_nm').</p></li>
<li><p><strong>center_wl</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- Indicates how the center wavelength of each
band is determined. If <code class="docutils literal notranslate"><span class="pre">center_wl</span></code> is &quot;peak&quot;, the point at
which transmissivity is at its maximum is used as the center
wavelength. If <code class="docutils literal notranslate"><span class="pre">center_wl</span></code> is &quot;weighted&quot;, the weighted
average is used to compute the center wavelength. Must be one
of [&quot;peak&quot;, &quot;weighted&quot;] (<code class="docutils literal notranslate"><span class="pre">default:</span> <span class="pre">&quot;peak&quot;</span></code>).</p></li>
<li><p><strong>out_XXX</strong> -- Settings for saving the output files can be adjusted here
if desired. They are stored in <code class="docutils literal notranslate"><span class="pre">batch.io.defaults,</span> <span class="pre">and</span> <span class="pre">are</span>
<span class="pre">therefore</span> <span class="pre">accessible</span> <span class="pre">at</span> <span class="pre">a</span> <span class="pre">high</span> <span class="pre">level.</span> <span class="pre">See</span>
<span class="pre">``hsio.set_io_defaults()</span></code> for more information on each of the
settings.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following <code class="docutils literal notranslate"><span class="pre">batch</span></code> example builds on the API example results
of the <a class="reference external" href="hs_process.batch.html#hs_process.batch.spatial_crop">batch.spatial_crop</a> function. Please complete the
<a class="reference external" href="hs_process.batch.html#hs_process.batch.spatial_crop">batch.spatial_crop</a> example to be sure your directory
(i.e., <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>) is populated with multiple hyperspectral
datacubes. The following example will be using datacubes located in
the following directory:
<code class="docutils literal notranslate"><span class="pre">F:\nigo0024\Documents\hs_process_demo\spatial_crop</span></code></p>
</div>
<p class="rubric">Example</p>
<p>Load and initialize the <code class="docutils literal notranslate"><span class="pre">batch</span></code> module, checking to be sure the
directory exists.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">batch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\spatial_crop&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">base_dir</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span> <span class="o">=</span> <span class="n">batch</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">search_ext</span><span class="o">=</span><span class="s1">&#39;.bip&#39;</span><span class="p">,</span> <span class="n">progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># searches for all files in ``base_dir`` with a &quot;.bip&quot; file extension</span>
</pre></div>
</div>
<p>Use <code class="docutils literal notranslate"><span class="pre">batch.spectral_mimic</span></code> to spectrally mimic the Sentinel-2A
multispectral satellite sensor.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span><span class="o">.</span><span class="n">spectral_mimic</span><span class="p">(</span>
<span class="go">    base_dir=base_dir, folder_name=&#39;spec_mimic&#39;,</span>
<span class="go">    name_append=&#39;sentinel-2a&#39;,</span>
<span class="go">    sensor=&#39;sentinel-2a&#39;, center_wl=&#39;weighted&#39;)</span>
<span class="go">Processing 40 files. If existing files should be overwritten, be sure to set the ``out_force`` parameter.</span>
<span class="go">Processing file 39/40: 100%|██████████| 40/40 [00:04&lt;00:00,  8.85it/s]</span>
</pre></div>
</div>
<p>Use <code class="docutils literal notranslate"><span class="pre">seaborn</span></code> to visualize the spectra of a single pixel in one
of the processed images.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s1">&#39;Wells_rep2_20180628_16h56m_pika_gige_7_1011-spatial-crop.bip&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_cube</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spy_mem</span> <span class="o">=</span> <span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">open_memmap</span><span class="p">()</span>  <span class="c1"># datacube before mimicking</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">meta_bands</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">meta_bands</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s1">&#39;spec_mimic&#39;</span><span class="p">,</span> <span class="s1">&#39;Wells_rep2_20180628_16h56m_pika_gige_7_1011-sentinel-2a.bip&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_cube</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spy_mem_sen2a</span> <span class="o">=</span> <span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">open_memmap</span><span class="p">()</span>  <span class="c1"># datacube after mimicking</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">meta_bands_sen2a</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">meta_bands</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">spy_mem</span><span class="p">[</span><span class="mi">26</span><span class="p">][</span><span class="mi">29</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Hyperspectral (Pika II)&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands_sen2a</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">spy_mem_sen2a</span><span class="p">[</span><span class="mi">26</span><span class="p">][</span><span class="mi">29</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sentinel-2A &quot;mimic&quot;&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavelength (nm)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Reflectance (%)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;API Example: `batch.spectral_mimic`&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../img/batch/spectral_mimic_sentinel-2a_plot.png" src="../img/batch/spectral_mimic_sentinel-2a_plot.png" />
</dd></dl>

<dl class="py method">
<dt id="hs_process.batch.spectral_resample">
<code class="sig-name descname"><span class="pre">spectral_resample</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bip'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spec_bin'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_append</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spec-bin'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bandwidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins_n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_interleave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_byteorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/batch.html#batch.spectral_resample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.batch.spectral_resample" title="Permalink to this definition">¶</a></dt>
<dd><p>Batch processing tool to spectrally resample (a.k.a. &quot;bin&quot;) multiple
datacubes in the same way.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname_list</strong> (<code class="docutils literal notranslate"><span class="pre">list</span></code>, optional) -- list of filenames to process; if
left to <code class="docutils literal notranslate"><span class="pre">None</span></code>, will look at <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>, <code class="docutils literal notranslate"><span class="pre">search_ext</span></code>,
and <code class="docutils literal notranslate"><span class="pre">dir_level</span></code> parameters for files to process (default:
<code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>base_dir</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>, optional) -- directory path to search for files to
spectrally resample; if <code class="docutils literal notranslate"><span class="pre">fname_list</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>,
<code class="docutils literal notranslate"><span class="pre">base_dir</span></code> will be ignored (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>search_ext</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- file format/extension to search for in all
directories and subdirectories to determine which files to
process; if <code class="docutils literal notranslate"><span class="pre">fname_list</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">search_ext</span></code> will
be ignored (default: 'bip').</p></li>
<li><p><strong>dir_level</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- The number of directory levels to search; if
<code class="docutils literal notranslate"><span class="pre">None</span></code>, searches all directory levels (default: 0).</p></li>
<li><p><strong>base_dir_out</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- directory path to save all processed
datacubes; if set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, a folder named according to the
<code class="docutils literal notranslate"><span class="pre">folder_name</span></code> parameter is added to <code class="docutils literal notranslate"><span class="pre">base_dir</span></code></p></li>
<li><p><strong>folder_name</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- folder to add to <code class="docutils literal notranslate"><span class="pre">base_dir_out</span></code> to save
all the processed datacubes (default: 'spec_bin').</p></li>
<li><p><strong>name_append</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- name to append to the filename (default:
'spec-bin').</p></li>
<li><p><strong>bandwidth</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code> or <code class="docutils literal notranslate"><span class="pre">int</span></code>) -- The bandwidth of the bands
after spectral resampling is complete (units should be
consistent with that of the .hdr file). Setting <code class="docutils literal notranslate"><span class="pre">bandwidth</span></code>
to 10 will consolidate bands that fall within every 10 nm
interval.</p></li>
<li><p><strong>bins_n</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- The number of bins (i.e., &quot;bands&quot;) to achieve
after spectral resampling is complete. Ignored if <code class="docutils literal notranslate"><span class="pre">bandwidth</span></code>
is not <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>out_XXX</strong> -- Settings for saving the output files can be adjusted here
if desired. They are stored in <code class="docutils literal notranslate"><span class="pre">batch.io.defaults,</span> <span class="pre">and</span> <span class="pre">are</span>
<span class="pre">therefore</span> <span class="pre">accessible</span> <span class="pre">at</span> <span class="pre">a</span> <span class="pre">high</span> <span class="pre">level.</span> <span class="pre">See</span>
<span class="pre">``hsio.set_io_defaults()</span></code> for more information on each of the
settings.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following <code class="docutils literal notranslate"><span class="pre">batch</span></code> example builds on the API example results
of the <a class="reference external" href="hs_process.batch.html#hs_process.batch.spatial_crop">batch.spatial_crop</a> function. Please complete the
<a class="reference external" href="hs_process.batch.html#hs_process.batch.spatial_crop">batch.spatial_crop</a> example to be sure your directory
(i.e., <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>) is populated with multiple hyperspectral
datacubes. The following example will be using datacubes located in
the following directory:
<code class="docutils literal notranslate"><span class="pre">F:\nigo0024\Documents\hs_process_demo\spatial_crop</span></code></p>
</div>
<p class="rubric">Example</p>
<p>Load and initialize the <code class="docutils literal notranslate"><span class="pre">batch</span></code> module, checking to be sure the
directory exists.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">batch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\spatial_crop&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">base_dir</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span> <span class="o">=</span> <span class="n">batch</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">search_ext</span><span class="o">=</span><span class="s1">&#39;.bip&#39;</span><span class="p">,</span> <span class="n">progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># searches for all files in ``base_dir`` with a &quot;.bip&quot; file extension</span>
</pre></div>
</div>
<p>Use <code class="docutils literal notranslate"><span class="pre">batch.spectral_resample</span></code> to bin (&quot;group&quot;) all spectral bands
into 20 nm bandwidth bands (from ~2.3 nm bandwidth originally) on
a per-pixel basis.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span><span class="o">.</span><span class="n">spectral_resample</span><span class="p">(</span>
<span class="go">    base_dir=base_dir, folder_name=&#39;spec_bin&#39;,</span>
<span class="go">    name_append=&#39;spec-bin-20&#39;, bandwidth=20)</span>
<span class="go">Processing 40 files. If existing files should be overwritten, be sure to set the ``out_force`` parameter.</span>
<span class="go">Processing file 39/40: 100%|██████████| 40/40 [00:00&lt;00:00, 48.31it/s]</span>
<span class="gp">...</span>
</pre></div>
</div>
<p>Use <code class="docutils literal notranslate"><span class="pre">seaborn</span></code> to visualize the spectra of a single pixel in one
of the processed images.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s1">&#39;Wells_rep2_20180628_16h56m_pika_gige_7_1011-spatial-crop.bip&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_cube</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spy_mem</span> <span class="o">=</span> <span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">open_memmap</span><span class="p">()</span>  <span class="c1"># datacube before resampling</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">meta_bands</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">meta_bands</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s1">&#39;spec_bin&#39;</span><span class="p">,</span> <span class="s1">&#39;Wells_rep2_20180628_16h56m_pika_gige_7_1011-spec-bin-20.bip&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_cube</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spy_mem_bin</span> <span class="o">=</span> <span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">open_memmap</span><span class="p">()</span>  <span class="c1"># datacube after resampling</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">meta_bands_bin</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">meta_bands</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">spy_mem</span><span class="p">[</span><span class="mi">26</span><span class="p">][</span><span class="mi">29</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Hyperspectral (Pika II)&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands_bin</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">spy_mem_bin</span><span class="p">[</span><span class="mi">26</span><span class="p">][</span><span class="mi">29</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Spectral resample (20 nm)&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavelength (nm)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Reflectance (%)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;API Example: `batch.spectral_resample`&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../img/batch/spectral_resample-20nm_plot.png" src="../img/batch/spectral_resample-20nm_plot.png" />
</dd></dl>

<dl class="py method">
<dt id="hs_process.batch.spectral_smooth">
<code class="sig-name descname"><span class="pre">spectral_smooth</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bip'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spec_smooth'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_append</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spec-smooth'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_interleave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_byteorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/batch.html#batch.spectral_smooth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.batch.spectral_smooth" title="Permalink to this definition">¶</a></dt>
<dd><p>Batch processing tool to spectrally smooth multiple datacubes in the
same way.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname_list</strong> (<code class="docutils literal notranslate"><span class="pre">list</span></code>, optional) -- list of filenames to process; if
left to <code class="docutils literal notranslate"><span class="pre">None</span></code>, will look at <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>, <code class="docutils literal notranslate"><span class="pre">search_ext</span></code>, and
<code class="docutils literal notranslate"><span class="pre">dir_level</span></code> parameters for files to process (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>base_dir</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>, optional) -- directory path to search for files to
spectrally clip; if <code class="docutils literal notranslate"><span class="pre">fname_list</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">base_dir</span></code> will
be ignored (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>search_ext</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- file format/extension to search for in all
directories and subdirectories to determine which files to
process; if <code class="docutils literal notranslate"><span class="pre">fname_list</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">search_ext</span></code> will
be ignored (default: 'bip').</p></li>
<li><p><strong>dir_level</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- The number of directory levels to search; if
<code class="docutils literal notranslate"><span class="pre">None</span></code>, searches all directory levels (default: 0).</p></li>
<li><p><strong>base_dir_out</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- directory path to save all processed
datacubes; if set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, a folder named according to the
<code class="docutils literal notranslate"><span class="pre">folder_name</span></code> parameter is added to <code class="docutils literal notranslate"><span class="pre">base_dir</span></code></p></li>
<li><p><strong>folder_name</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- folder to add to <code class="docutils literal notranslate"><span class="pre">base_dir_out</span></code> to save all
the processed datacubes (default: 'spec-smooth').</p></li>
<li><p><strong>name_append</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- name to append to the filename (default:
'spec-smooth').</p></li>
<li><p><strong>window_size</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- the length of the window; must be an odd
integer number (default: 11).</p></li>
<li><p><strong>order</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- the order of the polynomial used in the filtering;
must be less than <code class="docutils literal notranslate"><span class="pre">window_size</span></code> - 1 (default: 2).</p></li>
<li><p><strong>stats</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- whether to compute some basic descriptive
statistics (mean, st. dev., and coefficient of variation) of
the smoothed data array (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)</p></li>
<li><p><strong>out_XXX</strong> -- Settings for saving the output files can be adjusted here
if desired. They are stored in <code class="docutils literal notranslate"><span class="pre">batch.io.defaults,</span> <span class="pre">and</span> <span class="pre">are</span>
<span class="pre">therefore</span> <span class="pre">accessible</span> <span class="pre">at</span> <span class="pre">a</span> <span class="pre">high</span> <span class="pre">level.</span> <span class="pre">See</span>
<span class="pre">``hsio.set_io_defaults()</span></code> for more information on each of the
settings.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following <code class="docutils literal notranslate"><span class="pre">batch</span></code> example builds on the API example results
of the <a class="reference external" href="hs_process.batch.html#hs_process.batch.spatial_crop">batch.spatial_crop</a> function. Please complete the
<a class="reference external" href="hs_process.batch.html#hs_process.batch.spatial_crop">batch.spatial_crop</a> example to be sure your directory
(i.e., <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>) is populated with multiple hyperspectral
datacubes. The following example will be using datacubes located in
the following directory:
<code class="docutils literal notranslate"><span class="pre">F:\nigo0024\Documents\hs_process_demo\spatial_crop</span></code></p>
</div>
<p class="rubric">Example</p>
<p>Load and initialize the <code class="docutils literal notranslate"><span class="pre">batch</span></code> module, checking to be sure the
directory exists.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">batch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\spatial_crop&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">base_dir</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span> <span class="o">=</span> <span class="n">batch</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">search_ext</span><span class="o">=</span><span class="s1">&#39;.bip&#39;</span><span class="p">)</span>  <span class="c1"># searches for all files in ``base_dir`` with a &quot;.bip&quot; file extension</span>
</pre></div>
</div>
<p>Use <code class="docutils literal notranslate"><span class="pre">batch.spectral_smooth</span></code> to perform a <em>Savitzky-Golay</em>
smoothing operation on each image/pixel in <code class="docutils literal notranslate"><span class="pre">base_dir</span></code>. The
<code class="docutils literal notranslate"><span class="pre">window_size</span></code> and <code class="docutils literal notranslate"><span class="pre">order</span></code> can be adjusted to achieve desired
smoothing results.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span><span class="o">.</span><span class="n">spectral_smooth</span><span class="p">(</span><span class="n">base_dir</span><span class="o">=</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">folder_name</span><span class="o">=</span><span class="s1">&#39;spec_smooth&#39;</span><span class="p">,</span>
<span class="go">                            window_size=11, order=2)</span>
<span class="go">Processing 40 files. If this is not what is expected, please check if files have already undergone processing. If existing files should be overwritten, be sure to set the ``out_force`` parameter.</span>
<span class="go">Spectrally smoothing: F:\nigo0024\Documents\hs_process_demo\spatial_crop\Wells_rep2_20180628_16h56m_pika_gige_7_1011-spatial-crop.bip</span>
<span class="go">Saving F:\nigo0024\Documents\hs_process_demo\spatial_crop\spec_smooth\Wells_rep2_20180628_16h56m_pika_gige_7_1011-spec-smooth.bip</span>
<span class="go">Spectrally smoothing: F:\nigo0024\Documents\hs_process_demo\spatial_crop\Wells_rep2_20180628_16h56m_pika_gige_7_1012-spatial-crop.bip</span>
<span class="go">Saving F:\nigo0024\Documents\hs_process_demo\spatial_crop\spec_smooth\Wells_rep2_20180628_16h56m_pika_gige_7_1012-spec-smooth.bip</span>
<span class="gp">...</span>
</pre></div>
</div>
<p>Use <code class="docutils literal notranslate"><span class="pre">seaborn</span></code> to visualize the spectra of a single pixel in one
of the processed images.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s1">&#39;Wells_rep2_20180628_16h56m_pika_gige_7_1011-spatial-crop.bip&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_cube</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spy_mem</span> <span class="o">=</span> <span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">open_memmap</span><span class="p">()</span>  <span class="c1"># datacube before smoothing</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">meta_bands</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">meta_bands</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s1">&#39;spec_smooth&#39;</span><span class="p">,</span> <span class="s1">&#39;Wells_rep2_20180628_16h56m_pika_gige_7_1011-spec-smooth.bip&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_cube</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spy_mem_clip</span> <span class="o">=</span> <span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">open_memmap</span><span class="p">()</span>  <span class="c1"># datacube after smoothing</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">meta_bands_clip</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">hsbatch</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">meta_bands</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">spy_mem</span><span class="p">[</span><span class="mi">26</span><span class="p">][</span><span class="mi">29</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Before spectral smoothing&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands_clip</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">spy_mem_clip</span><span class="p">[</span><span class="mi">26</span><span class="p">][</span><span class="mi">29</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;After spectral smoothing&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavelength (nm)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Reflectance (%)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;API Example: `batch.spectral_smooth`&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../img/batch/spectral_smooth_plot.png" src="../img/batch/spectral_smooth_plot.png" />
<p>Notice how the <em>&quot;choppiness&quot;</em> of the spectral curve is lessened
after the smoothing operation. There are spectral regions that
perhaps had a lower <em>signal:noise</em> ratio and did not do particularlly
well at smoothing (i.e., &lt; 410 nm, ~770 nm, and ~820 nm). It may be
wise to perform <code class="docutils literal notranslate"><span class="pre">batch.spectral_smooth</span></code> <em>after</em>
<a class="reference external" href="hs_process.batch.html#hs_process.batch.spectral_clip">batch.spectral_clip</a>.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="hs_process.defaults">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hs_process.</span></code><code class="sig-name descname"><span class="pre">defaults</span></code><a class="reference internal" href="_modules/hs_process/utilities.html#defaults"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.defaults" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class containing default values and/or settings for various
<code class="docutils literal notranslate"><span class="pre">hs_process</span></code> tools/functions.</p>
<dl class="py attribute">
<dt id="hs_process.defaults.crop_defaults">
<code class="sig-name descname"><span class="pre">crop_defaults</span></code><a class="headerlink" href="#hs_process.defaults.crop_defaults" title="Permalink to this definition">¶</a></dt>
<dd><p>Default values for performing spatial cropping on images. <code class="docutils literal notranslate"><span class="pre">crop_defaults</span></code>
is referenced by the <code class="docutils literal notranslate"><span class="pre">spatial_mod.crop_single()</span></code> function to get default
values if various user-parameters are not passed or are left to <code class="docutils literal notranslate"><span class="pre">None</span></code>.
In this way, <code class="docutils literal notranslate"><span class="pre">defaults.crop_defaults</span></code> can be modified once by the user to
avoid having to pass the same parameter(s) repeatedly if executing
<code class="docutils literal notranslate"><span class="pre">spatial_mod.crop_single()</span></code> many times, such as in a for loop.</p>
<dl class="py attribute">
<dt id="hs_process.defaults.crop_defaults.directory">
<code class="sig-prename descclassname"><span class="pre">crop_defaults.</span></code><code class="sig-name descname"><span class="pre">directory</span></code><a class="headerlink" href="#hs_process.defaults.crop_defaults.directory" title="Permalink to this definition">¶</a></dt>
<dd><p>File directory of the input image
to be cropped (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.defaults.crop_defaults.name_short">
<code class="sig-prename descclassname"><span class="pre">crop_defaults.</span></code><code class="sig-name descname"><span class="pre">name_short</span></code><a class="headerlink" href="#hs_process.defaults.crop_defaults.name_short" title="Permalink to this definition">¶</a></dt>
<dd><p>Part of the datacube name that is
generally not repeated across many datacubes captured at the
same time. In the <code class="docutils literal notranslate"><span class="pre">name_long</span></code> example above,
<code class="docutils literal notranslate"><span class="pre">name_short</span></code> = &quot;plot_101_pika_gige_2&quot;. The part of the
filename that is <code class="docutils literal notranslate"><span class="pre">name_short</span></code> should end with a dash (but
should not include that dash as it belongs to <code class="docutils literal notranslate"><span class="pre">name_long</span></code>;
default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.defaults.crop_defaults.name_long">
<code class="sig-prename descclassname"><span class="pre">crop_defaults.</span></code><code class="sig-name descname"><span class="pre">name_long</span></code><a class="headerlink" href="#hs_process.defaults.crop_defaults.name_long" title="Permalink to this definition">¶</a></dt>
<dd><p>Part of the datacube name that tends
to be long and is repeated across many datacubes captured at
the same time. This is an artifact of Resonon/Spectronon
software, and may be desireable to shorten and/or make more
informative. For example, a datacube may have the following name:
<em>&quot;plot_101_pika_gige_2-Radiance From Raw Data-Georectify Airborne Datacube-Reflectance from Radiance Data and Measured Reference Spectrum.bip&quot;</em>
and another datacube captured in the same campaign may be named:
<em>&quot;plot_102_pika_gige_1-Radiance From Raw Data-Georectify Airborne Datacube-Reflectance from Radiance Data and Measured Reference Spectrum.bip&quot;</em>
<code class="docutils literal notranslate"><span class="pre">name_long</span></code> should refer to everything after the first dash
(including the first dash) up to the file extension (&quot;.bip&quot;):
<code class="docutils literal notranslate"><span class="pre">name_long</span></code> = <em>&quot;-Radiance From Raw Data-Georectify Airborne Datacube-Reflectance from Radiance Data and Measured Reference Spectrum&quot;</em>
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.defaults.crop_defaults.ext">
<code class="sig-prename descclassname"><span class="pre">crop_defaults.</span></code><code class="sig-name descname"><span class="pre">ext</span></code><a class="headerlink" href="#hs_process.defaults.crop_defaults.ext" title="Permalink to this definition">¶</a></dt>
<dd><p>File extension to save the cropped image
(default: 'bip').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.defaults.crop_defaults.pix_e_ul">
<code class="sig-prename descclassname"><span class="pre">crop_defaults.</span></code><code class="sig-name descname"><span class="pre">pix_e_ul</span></code><a class="headerlink" href="#hs_process.defaults.crop_defaults.pix_e_ul" title="Permalink to this definition">¶</a></dt>
<dd><p>upper left pixel column (easting) to
begin cropping (default: 0).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">int</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.defaults.crop_defaults.pix_n_ul">
<code class="sig-prename descclassname"><span class="pre">crop_defaults.</span></code><code class="sig-name descname"><span class="pre">pix_n_ul</span></code><a class="headerlink" href="#hs_process.defaults.crop_defaults.pix_n_ul" title="Permalink to this definition">¶</a></dt>
<dd><p>upper left pixel row (northing) to
begin cropping (default: 0).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">int</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.defaults.crop_defaults.buf_e_pix">
<code class="sig-prename descclassname"><span class="pre">crop_defaults.</span></code><code class="sig-name descname"><span class="pre">buf_e_pix</span></code><a class="headerlink" href="#hs_process.defaults.crop_defaults.buf_e_pix" title="Permalink to this definition">¶</a></dt>
<dd><p>The buffer distance in the easting
direction (in pixel units) to be applied after calculating the
original crop area (default: 0).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">int</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.defaults.crop_defaults.buf_n_pix">
<code class="sig-prename descclassname"><span class="pre">crop_defaults.</span></code><code class="sig-name descname"><span class="pre">buf_n_pix</span></code><a class="headerlink" href="#hs_process.defaults.crop_defaults.buf_n_pix" title="Permalink to this definition">¶</a></dt>
<dd><p>The buffer distance in the northing
direction (in pixel units) to be applied after calculating the
original crop area (default: 0).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">int</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.defaults.crop_defaults.buf_e_m">
<code class="sig-prename descclassname"><span class="pre">crop_defaults.</span></code><code class="sig-name descname"><span class="pre">buf_e_m</span></code><a class="headerlink" href="#hs_process.defaults.crop_defaults.buf_e_m" title="Permalink to this definition">¶</a></dt>
<dd><p>The buffer distance in the easting
direction (in map units; e.g., meters) to be applied after
calculating the original crop area; the buffer is considered
after <code class="docutils literal notranslate"><span class="pre">crop_X_m</span></code>/<code class="docutils literal notranslate"><span class="pre">crop_X_pix</span></code>. A positive value will
reduce the size of <code class="docutils literal notranslate"><span class="pre">crop_X_m</span></code>/<code class="docutils literal notranslate"><span class="pre">crop_X_pix</span></code>, and a
negative value will increase it (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.defaults.crop_defaults.buf_n_m">
<code class="sig-prename descclassname"><span class="pre">crop_defaults.</span></code><code class="sig-name descname"><span class="pre">buf_n_m</span></code><a class="headerlink" href="#hs_process.defaults.crop_defaults.buf_n_m" title="Permalink to this definition">¶</a></dt>
<dd><p>The buffer distance in the northing
direction (in map units; e.g., meters) to be applied after
calculating the original crop area; the buffer is considered
after <code class="docutils literal notranslate"><span class="pre">crop_X_m</span></code>/<code class="docutils literal notranslate"><span class="pre">crop_X_pix</span></code>. A positive value will
reduce the size of <code class="docutils literal notranslate"><span class="pre">crop_X_m</span></code>/<code class="docutils literal notranslate"><span class="pre">crop_X_pix</span></code>, and a
negative value will increase it (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.defaults.crop_defaults.crop_e_pix">
<code class="sig-prename descclassname"><span class="pre">crop_defaults.</span></code><code class="sig-name descname"><span class="pre">crop_e_pix</span></code><a class="headerlink" href="#hs_process.defaults.crop_defaults.crop_e_pix" title="Permalink to this definition">¶</a></dt>
<dd><p>number of pixels in each row in the
cropped image (default: 90).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">int</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.defaults.crop_defaults.crop_n_pix">
<code class="sig-prename descclassname"><span class="pre">crop_defaults.</span></code><code class="sig-name descname"><span class="pre">crop_n_pix</span></code><a class="headerlink" href="#hs_process.defaults.crop_defaults.crop_n_pix" title="Permalink to this definition">¶</a></dt>
<dd><p>number of pixels in each column in
the cropped image (default: 120).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">int</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.defaults.crop_defaults.crop_e_m">
<code class="sig-prename descclassname"><span class="pre">crop_defaults.</span></code><code class="sig-name descname"><span class="pre">crop_e_m</span></code><a class="headerlink" href="#hs_process.defaults.crop_defaults.crop_e_m" title="Permalink to this definition">¶</a></dt>
<dd><p>length of each row (easting
direction) of the cropped image in map units (e.g., meters;
default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.defaults.crop_defaults.crop_n_m">
<code class="sig-prename descclassname"><span class="pre">crop_defaults.</span></code><code class="sig-name descname"><span class="pre">crop_n_m</span></code><a class="headerlink" href="#hs_process.defaults.crop_defaults.crop_n_m" title="Permalink to this definition">¶</a></dt>
<dd><p>length of each column (northing
direction) of the cropped image in map units (e.g., meters;
default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.defaults.crop_defaults.plot_id_ref">
<code class="sig-prename descclassname"><span class="pre">crop_defaults.</span></code><code class="sig-name descname"><span class="pre">plot_id_ref</span></code><a class="headerlink" href="#hs_process.defaults.crop_defaults.plot_id_ref" title="Permalink to this definition">¶</a></dt>
<dd><p>the plot ID of the area to be cropped
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">int</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py attribute">
<dt id="hs_process.defaults.envi_write">
<code class="sig-name descname"><span class="pre">envi_write</span></code><a class="headerlink" href="#hs_process.defaults.envi_write" title="Permalink to this definition">¶</a></dt>
<dd><p>Attributes for writing ENVI datacubes to file, following the convention of
the <a class="reference external" href="http://www.spectralpython.net/">Spectral Python</a> <a class="reference external" href="http://www.spectralpython.net/class_func_ref.html#spectral.io.envi.save_image">envi.save_image()</a> parameter options for writing
an ENVI datacube to file.</p>
<dl class="py attribute">
<dt id="hs_process.defaults.envi_write.dtype">
<code class="sig-prename descclassname"><span class="pre">envi_write.</span></code><code class="sig-name descname"><span class="pre">dtype</span></code><a class="headerlink" href="#hs_process.defaults.envi_write.dtype" title="Permalink to this definition">¶</a></dt>
<dd><p>The data type with which
to store the image. For example, to store the image in 16-bit
unsigned integer format, the argument could be any of
<code class="docutils literal notranslate"><span class="pre">numpy.uint16</span></code>, <code class="docutils literal notranslate"><span class="pre">'u2'</span></code>, <code class="docutils literal notranslate"><span class="pre">'uint16'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'H'</span></code> (default:
<code class="docutils literal notranslate"><span class="pre">np.float32</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">numpy.dtype</span></code> or <code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.defaults.envi_write.force">
<code class="sig-prename descclassname"><span class="pre">envi_write.</span></code><code class="sig-name descname"><span class="pre">force</span></code><a class="headerlink" href="#hs_process.defaults.envi_write.force" title="Permalink to this definition">¶</a></dt>
<dd><p>If <code class="docutils literal notranslate"><span class="pre">hdr_file</span></code> or its associated image
file exist, <code class="docutils literal notranslate"><span class="pre">force=True</span></code> will overwrite the files; otherwise, an
exception will be raised if either file exists (default:
<code class="docutils literal notranslate"><span class="pre">False</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.defaults.envi_write.ext">
<code class="sig-prename descclassname"><span class="pre">envi_write.</span></code><code class="sig-name descname"><span class="pre">ext</span></code><a class="headerlink" href="#hs_process.defaults.envi_write.ext" title="Permalink to this definition">¶</a></dt>
<dd><p>The extension to use for saving the image
file; if not specified, a default extension is determined based on
the <code class="docutils literal notranslate"><span class="pre">interleave</span></code>. For example, if <code class="docutils literal notranslate"><span class="pre">interleave``='bip',</span> <span class="pre">then</span>
<span class="pre">``ext</span></code> is set to 'bip' as well. If <code class="docutils literal notranslate"><span class="pre">ext</span></code> is an empty string, the
image file will have the same name as the .hdr, but without the
'.hdr' extension (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.defaults.envi_write.interleave">
<code class="sig-prename descclassname"><span class="pre">envi_write.</span></code><code class="sig-name descname"><span class="pre">interleave</span></code><a class="headerlink" href="#hs_process.defaults.envi_write.interleave" title="Permalink to this definition">¶</a></dt>
<dd><p>The band interleave format to use for
writing the file; <code class="docutils literal notranslate"><span class="pre">interleave</span></code> should be one of 'bil', 'bip', or
'bsq' (default: 'bip').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.defaults.envi_write.byteorder">
<code class="sig-prename descclassname"><span class="pre">envi_write.</span></code><code class="sig-name descname"><span class="pre">byteorder</span></code><a class="headerlink" href="#hs_process.defaults.envi_write.byteorder" title="Permalink to this definition">¶</a></dt>
<dd><p>Specifies the byte order
(endian-ness) of the data as written to disk. For little endian,
this value should be either 0 or 'little'. For big endian, it
should be either 1 or 'big'. If not specified, native byte order
will be used (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">int</span></code> or <code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py attribute">
<dt id="hs_process.defaults.spat_crop_cols">
<code class="sig-name descname"><span class="pre">spat_crop_cols</span></code><a class="headerlink" href="#hs_process.defaults.spat_crop_cols" title="Permalink to this definition">¶</a></dt>
<dd><p>Default column names for performing batch spatial cropping on
images. Useful when batch processing images via <a class="reference external" href="hs_process.batch.html#hs_process.batch.spatial_crop">batch.spatial_crop()</a>.
<code class="docutils literal notranslate"><span class="pre">batch.spatial_crop()</span></code> takes a parameter <code class="docutils literal notranslate"><span class="pre">fname_sheet</span></code>, which can be a
filename to a spreadsheet or a <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>.
<code class="docutils literal notranslate"><span class="pre">defaults.spat_crop_cols</span></code> should be modified if the column names in
<code class="docutils literal notranslate"><span class="pre">fname_sheet</span></code> are different than what is expected (see documentation for
<a class="reference external" href="hs_process.batch.html#hs_process.batch.spatial_crop">batch.spatial_crop()</a> to know the expected column names).</p>
<dl class="py attribute">
<dt id="hs_process.defaults.spat_crop_cols.directory">
<code class="sig-prename descclassname"><span class="pre">spat_crop_cols.</span></code><code class="sig-name descname"><span class="pre">directory</span></code><a class="headerlink" href="#hs_process.defaults.spat_crop_cols.directory" title="Permalink to this definition">¶</a></dt>
<dd><p>column name for input directory
(default: 'directory').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.defaults.spat_crop_cols.fname">
<code class="sig-prename descclassname"><span class="pre">spat_crop_cols.</span></code><code class="sig-name descname"><span class="pre">fname</span></code><a class="headerlink" href="#hs_process.defaults.spat_crop_cols.fname" title="Permalink to this definition">¶</a></dt>
<dd><p>column name for input fname
(default: 'fname').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.defaults.spat_crop_cols.name_short">
<code class="sig-prename descclassname"><span class="pre">spat_crop_cols.</span></code><code class="sig-name descname"><span class="pre">name_short</span></code><a class="headerlink" href="#hs_process.defaults.spat_crop_cols.name_short" title="Permalink to this definition">¶</a></dt>
<dd><p>column name for input image's
<code class="docutils literal notranslate"><span class="pre">name_short</span></code> (default: 'name_short').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.defaults.spat_crop_cols.name_long">
<code class="sig-prename descclassname"><span class="pre">spat_crop_cols.</span></code><code class="sig-name descname"><span class="pre">name_long</span></code><a class="headerlink" href="#hs_process.defaults.spat_crop_cols.name_long" title="Permalink to this definition">¶</a></dt>
<dd><p>column name for input image's
<code class="docutils literal notranslate"><span class="pre">name_long</span></code> (default: 'name_long').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.defaults.spat_crop_cols.ext">
<code class="sig-prename descclassname"><span class="pre">spat_crop_cols.</span></code><code class="sig-name descname"><span class="pre">ext</span></code><a class="headerlink" href="#hs_process.defaults.spat_crop_cols.ext" title="Permalink to this definition">¶</a></dt>
<dd><p>column name for file extension of input
image (default: 'ext').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.defaults.spat_crop_cols.pix_e_ul">
<code class="sig-prename descclassname"><span class="pre">spat_crop_cols.</span></code><code class="sig-name descname"><span class="pre">pix_e_ul</span></code><a class="headerlink" href="#hs_process.defaults.spat_crop_cols.pix_e_ul" title="Permalink to this definition">¶</a></dt>
<dd><p>column name for <code class="docutils literal notranslate"><span class="pre">pix_e_ul</span></code>
(default: 'pix_e_ul').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.defaults.spat_crop_cols.pix_n_ul">
<code class="sig-prename descclassname"><span class="pre">spat_crop_cols.</span></code><code class="sig-name descname"><span class="pre">pix_n_ul</span></code><a class="headerlink" href="#hs_process.defaults.spat_crop_cols.pix_n_ul" title="Permalink to this definition">¶</a></dt>
<dd><p>column name for <code class="docutils literal notranslate"><span class="pre">pix_n_ul</span></code>
(default: 'pix_n_ul').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.defaults.spat_crop_cols.alley_size_e_pix">
<code class="sig-prename descclassname"><span class="pre">spat_crop_cols.</span></code><code class="sig-name descname"><span class="pre">alley_size_e_pix</span></code><a class="headerlink" href="#hs_process.defaults.spat_crop_cols.alley_size_e_pix" title="Permalink to this definition">¶</a></dt>
<dd><p>column name for
<code class="docutils literal notranslate"><span class="pre">alley_size_e_pix</span></code> (default: 'alley_size_e_pix').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.defaults.spat_crop_cols.alley_size_n_pix">
<code class="sig-prename descclassname"><span class="pre">spat_crop_cols.</span></code><code class="sig-name descname"><span class="pre">alley_size_n_pix</span></code><a class="headerlink" href="#hs_process.defaults.spat_crop_cols.alley_size_n_pix" title="Permalink to this definition">¶</a></dt>
<dd><p>column name for
<code class="docutils literal notranslate"><span class="pre">alley_size_n_pix</span></code> (default: 'alley_size_n_pix').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.defaults.spat_crop_cols.alley_size_e_m">
<code class="sig-prename descclassname"><span class="pre">spat_crop_cols.</span></code><code class="sig-name descname"><span class="pre">alley_size_e_m</span></code><a class="headerlink" href="#hs_process.defaults.spat_crop_cols.alley_size_e_m" title="Permalink to this definition">¶</a></dt>
<dd><p>column name for
<code class="docutils literal notranslate"><span class="pre">alley_size_e_m</span></code> (default: 'alley_size_e_m').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.defaults.spat_crop_cols.alley_size_n_m">
<code class="sig-prename descclassname"><span class="pre">spat_crop_cols.</span></code><code class="sig-name descname"><span class="pre">alley_size_n_m</span></code><a class="headerlink" href="#hs_process.defaults.spat_crop_cols.alley_size_n_m" title="Permalink to this definition">¶</a></dt>
<dd><p>column name for
<code class="docutils literal notranslate"><span class="pre">alley_size_n_m</span></code> (default: 'alley_size_n_m').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.defaults.spat_crop_cols.buf_e_pix">
<code class="sig-prename descclassname"><span class="pre">spat_crop_cols.</span></code><code class="sig-name descname"><span class="pre">buf_e_pix</span></code><a class="headerlink" href="#hs_process.defaults.spat_crop_cols.buf_e_pix" title="Permalink to this definition">¶</a></dt>
<dd><p>column name for <code class="docutils literal notranslate"><span class="pre">buf_e_pix</span></code>
(default: 'buf_e_pix').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.defaults.spat_crop_cols.buf_n_pix">
<code class="sig-prename descclassname"><span class="pre">spat_crop_cols.</span></code><code class="sig-name descname"><span class="pre">buf_n_pix</span></code><a class="headerlink" href="#hs_process.defaults.spat_crop_cols.buf_n_pix" title="Permalink to this definition">¶</a></dt>
<dd><p>column name for <code class="docutils literal notranslate"><span class="pre">buf_n_pix</span></code>
(default: 'buf_n_pix').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.defaults.spat_crop_cols.buf_e_m">
<code class="sig-prename descclassname"><span class="pre">spat_crop_cols.</span></code><code class="sig-name descname"><span class="pre">buf_e_m</span></code><a class="headerlink" href="#hs_process.defaults.spat_crop_cols.buf_e_m" title="Permalink to this definition">¶</a></dt>
<dd><p>column name for <code class="docutils literal notranslate"><span class="pre">buf_e_m</span></code> (default:
'buf_e_m').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.defaults.spat_crop_cols.buf_n_m">
<code class="sig-prename descclassname"><span class="pre">spat_crop_cols.</span></code><code class="sig-name descname"><span class="pre">buf_n_m</span></code><a class="headerlink" href="#hs_process.defaults.spat_crop_cols.buf_n_m" title="Permalink to this definition">¶</a></dt>
<dd><p>column name for <code class="docutils literal notranslate"><span class="pre">buf_n_m</span></code> (default:
'buf_n_m').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.defaults.spat_crop_cols.crop_e_pix">
<code class="sig-prename descclassname"><span class="pre">spat_crop_cols.</span></code><code class="sig-name descname"><span class="pre">crop_e_pix</span></code><a class="headerlink" href="#hs_process.defaults.spat_crop_cols.crop_e_pix" title="Permalink to this definition">¶</a></dt>
<dd><p>column name for <code class="docutils literal notranslate"><span class="pre">crop_e_pix</span></code>
(default: 'crop_e_pix').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.defaults.spat_crop_cols.crop_n_pix">
<code class="sig-prename descclassname"><span class="pre">spat_crop_cols.</span></code><code class="sig-name descname"><span class="pre">crop_n_pix</span></code><a class="headerlink" href="#hs_process.defaults.spat_crop_cols.crop_n_pix" title="Permalink to this definition">¶</a></dt>
<dd><p>column name for <code class="docutils literal notranslate"><span class="pre">crop_n_pix</span></code>
(default: 'crop_n_pix').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.defaults.spat_crop_cols.crop_e_m">
<code class="sig-prename descclassname"><span class="pre">spat_crop_cols.</span></code><code class="sig-name descname"><span class="pre">crop_e_m</span></code><a class="headerlink" href="#hs_process.defaults.spat_crop_cols.crop_e_m" title="Permalink to this definition">¶</a></dt>
<dd><p>column name for <code class="docutils literal notranslate"><span class="pre">crop_e_m</span></code>
(default: 'crop_e_m').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.defaults.spat_crop_cols.crop_n_m">
<code class="sig-prename descclassname"><span class="pre">spat_crop_cols.</span></code><code class="sig-name descname"><span class="pre">crop_n_m</span></code><a class="headerlink" href="#hs_process.defaults.spat_crop_cols.crop_n_m" title="Permalink to this definition">¶</a></dt>
<dd><p>column name for <code class="docutils literal notranslate"><span class="pre">crop_n_m</span></code>
(default: 'crop_n_m').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.defaults.spat_crop_cols.plot_id_ref">
<code class="sig-prename descclassname"><span class="pre">spat_crop_cols.</span></code><code class="sig-name descname"><span class="pre">plot_id_ref</span></code><a class="headerlink" href="#hs_process.defaults.spat_crop_cols.plot_id_ref" title="Permalink to this definition">¶</a></dt>
<dd><p>column name for <code class="docutils literal notranslate"><span class="pre">plot_id</span></code>
(default: 'crop_n_pix').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.defaults.spat_crop_cols.n_plots_x">
<code class="sig-prename descclassname"><span class="pre">spat_crop_cols.</span></code><code class="sig-name descname"><span class="pre">n_plots_x</span></code><a class="headerlink" href="#hs_process.defaults.spat_crop_cols.n_plots_x" title="Permalink to this definition">¶</a></dt>
<dd><p>column name for <code class="docutils literal notranslate"><span class="pre">n_plots_x</span></code>
(default: 'n_plots_x').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.defaults.spat_crop_cols.n_plots_y">
<code class="sig-prename descclassname"><span class="pre">spat_crop_cols.</span></code><code class="sig-name descname"><span class="pre">n_plots_y</span></code><a class="headerlink" href="#hs_process.defaults.spat_crop_cols.n_plots_y" title="Permalink to this definition">¶</a></dt>
<dd><p>column name for <code class="docutils literal notranslate"><span class="pre">n_plots_y</span></code>
(default: 'n_plots_y').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hs_process.defaults.spat_crop_cols.n_plots">
<code class="sig-prename descclassname"><span class="pre">spat_crop_cols.</span></code><code class="sig-name descname"><span class="pre">n_plots</span></code><a class="headerlink" href="#hs_process.defaults.spat_crop_cols.n_plots" title="Permalink to this definition">¶</a></dt>
<dd><p>column name for <code class="docutils literal notranslate"><span class="pre">n_plots</span></code>
(default: 'n_plots').</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="hs_process.hsio">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hs_process.</span></code><code class="sig-name descname"><span class="pre">hsio</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname_in</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_long</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_short</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">str_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'plot_'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">individual_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname_hdr_spec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hsio"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.hsio" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for reading and writing hyperspectral data files, as well as
accessing, interpreting, and modifying its associated metadata. With a
hyperspectral data file loaded via <code class="docutils literal notranslate"><span class="pre">hsio</span></code>, there is simple
functionality to display the datacube image as a multi-band render, as
well as for saving a datacube as a 3-band geotiff. <code class="docutils literal notranslate"><span class="pre">hsio</span></code> relies
heavily on the <a class="reference external" href="http://www.spectralpython.net/">Spectral Python</a> package.</p>
<dl class="py method">
<dt id="hs_process.hsio.read_cube">
<code class="sig-name descname"><span class="pre">read_cube</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname_hdr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_long</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_short</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">individual_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hsio.read_cube"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.hsio.read_cube" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads in a hyperspectral datacube using the <a class="reference external" href="http://www.spectralpython.net/">Spectral Python</a> package.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname_hdr</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- filename of datacube to be read (default:
<code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>overwrite</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- Whether to overwrite any of the previous
user-passed variables, including <code class="docutils literal notranslate"><span class="pre">name_long</span></code>, <code class="docutils literal notranslate"><span class="pre">name_plot</span></code>,
and <code class="docutils literal notranslate"><span class="pre">name_short</span></code>. If variables are already set and
<code class="docutils literal notranslate"><span class="pre">overwrite</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, they will remain the same. If
variables are set and <code class="docutils literal notranslate"><span class="pre">overwrite</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, they will be
overwritten based on typcial file naming conventions of
Resonon/Spectronon software. Any of the user-passed variables
(e.g., <code class="docutils literal notranslate"><span class="pre">name_long</span></code>, etc.) will overwrite those that were set
previously whether <code class="docutils literal notranslate"><span class="pre">overwrite</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code>
(default: <code class="docutils literal notranslate"><span class="pre">False</span></code>).</p></li>
<li><p><strong>name_long</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- Spectronon processing appends processing names
to the filenames; this indicates those processing names that
are repetitive and can be deleted from the filename following
processing (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>name_short</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- The base name of the image file (see note
above about <code class="docutils literal notranslate"><span class="pre">name_long</span></code>; default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>name_plot</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- numeric text that describes the plot number
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>individual_plot</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- Indicates whether image (and its
filename) is for an individual plot (<code class="docutils literal notranslate"><span class="pre">True</span></code>), or for many
plots (<code class="docutils literal notranslate"><span class="pre">False</span></code>; default: <code class="docutils literal notranslate"><span class="pre">False</span></code>).</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">hs_process</span></code> will search for <code class="docutils literal notranslate"><span class="pre">name_long</span></code>, <code class="docutils literal notranslate"><span class="pre">name_plot</span></code>, and
<code class="docutils literal notranslate"><span class="pre">name_short</span></code> based on typical file naming behavior of Resonon/
Spectronon software. If any of these parameters are passed by the
user, however, that will take precedence over &quot;searching the
typical file nameing behavior&quot;.</p>
</div>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_hdr</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">()</span>  <span class="c1"># initialize an instance of the hsio class (note there are no required parameters)</span>
</pre></div>
</div>
<p>Load datacube using <code class="docutils literal notranslate"><span class="pre">hsio.read_cube</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">read_cube</span><span class="p">(</span><span class="n">fname_hdr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span>
<span class="go">Data Source:   &#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip&#39;</span>
<span class="go">    # Rows:            617</span>
<span class="go">    # Samples:        1300</span>
<span class="go">    # Bands:           240</span>
<span class="go">    Interleave:        BIP</span>
<span class="go">    Quantization:  32 bits</span>
<span class="go">    Data format:   float32</span>
</pre></div>
</div>
<p>Check <code class="docutils literal notranslate"><span class="pre">name_long</span></code>, <code class="docutils literal notranslate"><span class="pre">name_short</span></code>, and <code class="docutils literal notranslate"><span class="pre">name_plot</span></code> values derived from the filename</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">name_long</span>
<span class="go">&#39;-Convert Radiance Cube to Reflectance from Measured Reference Spectrum&#39;</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">name_plot</span>
<span class="go">&#39;7&#39;</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">name_short</span>
<span class="go">&#39;Wells_rep2_20180628_16h56m_pika_gige_7&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hs_process.hsio.read_spec">
<code class="sig-name descname"><span class="pre">read_spec</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname_hdr_spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_long</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_short</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hsio.read_spec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.hsio.read_spec" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads in a hyperspectral spectrum file using the using the <a class="reference external" href="http://www.spectralpython.net/">Spectral
Python</a> package.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fname_hdr_spec</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- filename of spectra to be read.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_hdr</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7_plot_611-cube-to-spec-mean.spec.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">()</span>  <span class="c1"># initialize an instance of the hsio class (note there are no required parameters)</span>
</pre></div>
</div>
<p>Load datacube using <code class="docutils literal notranslate"><span class="pre">hsio.read_spec</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">read_spec</span><span class="p">(</span><span class="n">fname_hdr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">spyfile_spec</span>
<span class="go">Data Source:   &#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7_plot_611-cube-to-spec-mean.spec&#39;</span>
<span class="go">    # Rows:              1</span>
<span class="go">    # Samples:           1</span>
<span class="go">    # Bands:           240</span>
<span class="go">    Interleave:        BIP</span>
<span class="go">    Quantization:  32 bits</span>
<span class="go">    Data format:   float32</span>
</pre></div>
</div>
<p>Check <code class="docutils literal notranslate"><span class="pre">name_long</span></code>, <code class="docutils literal notranslate"><span class="pre">name_short</span></code>, and <code class="docutils literal notranslate"><span class="pre">name_plot</span></code> values derived from the filename</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">name_long</span>
<span class="go">&#39;-cube-to-spec-mean&#39;</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">name_short</span>
<span class="go">&#39;Wells_rep2_20180628_16h56m_pika_gige_7_plot_611&#39;</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">name_plot</span>
<span class="go">&#39;611&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hs_process.hsio.set_io_defaults">
<code class="sig-name descname"><span class="pre">set_io_defaults</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interleave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">byteorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hsio.set_io_defaults"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.hsio.set_io_defaults" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets any of the ENVI file writing parameters to <code class="docutils literal notranslate"><span class="pre">hsio</span></code>; if any
parameter is left unchanged from its default, it will remain as-is
(i.e., it will not be set).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dtype</strong> (<code class="docutils literal notranslate"><span class="pre">numpy.dtype</span></code> or <code class="docutils literal notranslate"><span class="pre">str</span></code>) -- The data type with which to store
the image. For example, to store the image in 16-bit unsigned
integer format, the argument could be any of numpy.uint16,
'u2', 'uint16', or 'H' (default=``False``).</p></li>
<li><p><strong>force</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- If <code class="docutils literal notranslate"><span class="pre">hdr_file</span></code> or its associated image file exist,
<code class="docutils literal notranslate"><span class="pre">force=True</span></code> will overwrite the files; otherwise, an exception
will be raised if either file exists (default=``None``).</p></li>
<li><p><strong>ext</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- The extension to use for saving the image file; if not
specified, a default extension is determined based on the
<code class="docutils literal notranslate"><span class="pre">interleave</span></code>. For example, if <code class="docutils literal notranslate"><span class="pre">interleave``='bip',</span> <span class="pre">then</span> <span class="pre">``ext</span></code> is
set to 'bip' as well. If <code class="docutils literal notranslate"><span class="pre">ext</span></code> is an empty string, the image
file will have the same name as the .hdr, but without the
'.hdr' extension (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>).</p></li>
<li><p><strong>interleave</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- The band interleave format to use for writing
the file; <code class="docutils literal notranslate"><span class="pre">interleave</span></code> should be one of 'bil', 'bip', or 'bsq'
(default=``False``).</p></li>
<li><p><strong>byteorder</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code> or <code class="docutils literal notranslate"><span class="pre">str</span></code>) -- Specifies the byte order (endian-ness)
of the data as written to disk. For little endian, this value
should be either 0 or 'little'. For big endian, it should be
either 1 or 'big'. If not specified, native byte order will be
used (default=``False``).</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">()</span>  <span class="c1"># initialize an instance of the hsio class</span>
</pre></div>
</div>
<p>Check <code class="docutils literal notranslate"><span class="pre">defaults.envi_write</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">defaults</span><span class="o">.</span><span class="n">envi_write</span>
<span class="go">{&#39;dtype&#39;: numpy.float32,</span>
<span class="go"> &#39;force&#39;: False,</span>
<span class="go"> &#39;ext&#39;: &#39;&#39;,</span>
<span class="go"> &#39;interleave&#39;: &#39;bip&#39;,</span>
<span class="go"> &#39;byteorder&#39;: 0}</span>
</pre></div>
</div>
<p>Modify <code class="docutils literal notranslate"><span class="pre">force</span></code> parameter and recheck <code class="docutils literal notranslate"><span class="pre">defaults.envi_write</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">set_io_defaults</span><span class="p">(</span><span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">defaults</span><span class="o">.</span><span class="n">envi_write</span>
<span class="go">{&#39;dtype&#39;: numpy.float32,</span>
<span class="go"> &#39;force&#39;: True,</span>
<span class="go"> &#39;ext&#39;: &#39;&#39;,</span>
<span class="go"> &#39;interleave&#39;: &#39;bip&#39;,</span>
<span class="go"> &#39;byteorder&#39;: 0}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hs_process.hsio.show_img">
<code class="sig-name descname"><span class="pre">show_img</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spyfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band_r</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">120</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band_g</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">76</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band_b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'viridis'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inline</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hsio.show_img"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.hsio.show_img" title="Permalink to this definition">¶</a></dt>
<dd><p>Displays a datacube as a 3-band RGB image using <a class="reference external" href="https://matplotlib.org/3.1.1/api/_as_gen/matplotlib.pyplot.imshow.html#">Matplotlib</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object or <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) -- The data cube to
display; if <code class="docutils literal notranslate"><span class="pre">None</span></code>, loads from <code class="docutils literal notranslate"><span class="pre">self.spyfile</span></code> (default:
<code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>band_r</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- Band to display on the red channel (default: 120)</p></li>
<li><p><strong>band_g</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- Band to display on the green channel (default:
76)</p></li>
<li><p><strong>band_b</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- Band to display on the blue channel (default: 32)</p></li>
<li><p><strong>vmin/vmax</strong> (<code class="docutils literal notranslate"><span class="pre">scalar</span></code>, optional) -- The data range that the colormap
covers. By default, the colormap covers the complete value
range of the supplied data (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>cmap</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- The Colormap instance or registered colormap name
used to map scalar data to colors. This parameter is ignored
for RGB(A) data (default: &quot;viridis&quot;).</p></li>
<li><p><strong>cbar</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- Whether to include a colorbar in the image
(default: <code class="docutils literal notranslate"><span class="pre">True</span></code>).</p></li>
<li><p><strong>inline</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- If <code class="docutils literal notranslate"><span class="pre">True</span></code>, displays in the IPython console;
else displays in a pop-out window (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>).</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <cite>inline</cite> parameter points to the <cite>hsio.show_img</cite> function, and
is only expected to work in an IPython console (not intended to be
used in a normal Python console).</p>
</div>
<p class="rubric">Example</p>
<p>Load <code class="docutils literal notranslate"><span class="pre">hsio</span></code> and <code class="docutils literal notranslate"><span class="pre">spatial_mod</span></code> modules</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span> <span class="c1"># load hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">spatial_mod</span> <span class="c1"># load spatial mod</span>
</pre></div>
</div>
<p>Load the datacube using <code class="docutils literal notranslate"><span class="pre">hsio.read_cube</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fname_hdr</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">()</span>  <span class="c1"># initialize an instance of the hsio class</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">read_cube</span><span class="p">(</span><span class="n">fname_hdr</span><span class="p">)</span>
</pre></div>
</div>
<p>Perform simple spatial cropping via <code class="docutils literal notranslate"><span class="pre">spatial_mod.crop_single</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">my_spatial_mod</span> <span class="o">=</span> <span class="n">spatial_mod</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>  <span class="c1"># initialize spatial_mod instance to crop the image</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array_crop</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">my_spatial_mod</span><span class="o">.</span><span class="n">crop_single</span><span class="p">(</span><span class="n">pix_e_ul</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">pix_n_ul</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">crop_e_m</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">crop_n_m</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>Show an RGB render of the cropped image using <code class="docutils literal notranslate"><span class="pre">hsio.show_img</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">show_img</span><span class="p">(</span><span class="n">array_crop</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../img/utilities/show_img.png" src="../img/utilities/show_img.png" />
</dd></dl>

<dl class="py method">
<dt id="hs_process.hsio.write_cube">
<code class="sig-name descname"><span class="pre">write_cube</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname_hdr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spyfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interleave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">byteorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hsio.write_cube"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.hsio.write_cube" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper function that accesses the <a class="reference external" href="http://www.spectralpython.net/">Spectral Python</a> package to save a
datacube to file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname_hdr</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- Output header file path (with the '.hdr'
extension).</p></li>
<li><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object or <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) -- The hyperspectral
datacube to save. If <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, then metadata (<code class="docutils literal notranslate"><span class="pre">dict</span></code>)
should also be passed.</p></li>
<li><p><strong>metadata</strong> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>) -- Metadata to write to the ENVI .hdr file
describing the hyperspectral data cube being saved. If
<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object is passed to <code class="docutils literal notranslate"><span class="pre">spyfile</span></code>, <code class="docutils literal notranslate"><span class="pre">metadata</span></code> will
overwrite any existing metadata stored by the <code class="docutils literal notranslate"><span class="pre">SpyFile</span></code>
object (default=None).</p></li>
<li><p><strong>dtype</strong> (<code class="docutils literal notranslate"><span class="pre">numpy.dtype</span></code> or <code class="docutils literal notranslate"><span class="pre">str</span></code>) -- The data type with which to
store the image. For example, to store the image in 16-bit
unsigned integer format, the argument could be any of
numpy.uint16, 'u2', 'uint16', or 'H' (default=np.float32).</p></li>
<li><p><strong>force</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- If <code class="docutils literal notranslate"><span class="pre">hdr_file</span></code> or its associated image file
exist, <code class="docutils literal notranslate"><span class="pre">force=True</span></code> will overwrite the files; otherwise, an
exception will be raised if either file exists (default=False).</p></li>
<li><p><strong>ext</strong> (<code class="docutils literal notranslate"><span class="pre">None</span></code> or <code class="docutils literal notranslate"><span class="pre">str</span></code>) -- The extension to use for saving the
image file. If not specified or if set to an empty string
(e.g., <code class="docutils literal notranslate"><span class="pre">ext=''</span></code>), a default extension is determined using the
same name as <code class="docutils literal notranslate"><span class="pre">fname_hdr</span></code>, except without the &quot;.hdr&quot;
extension. If <code class="docutils literal notranslate"><span class="pre">fname_hdr</span></code> is provided without the
&quot;non-.hdr&quot; extension (e.g., &quot;bip&quot;), then the extension is
determined from the <code class="docutils literal notranslate"><span class="pre">interleave</span></code> parameter. For example, if
<code class="docutils literal notranslate"><span class="pre">interleave``='bip',</span> <span class="pre">then</span> <span class="pre">``ext</span></code> is set to 'bip' as well. Use
of <code class="docutils literal notranslate"><span class="pre">ext</span></code> is not recommended; instead, just set
<code class="docutils literal notranslate"><span class="pre">fname_hdr</span></code> with the correct extension or use
<code class="docutils literal notranslate"><span class="pre">interleave</span></code> to set the extension (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>;
determined from <code class="docutils literal notranslate"><span class="pre">fname_hdr</span></code> or <code class="docutils literal notranslate"><span class="pre">interleave</span></code>).</p></li>
<li><p><strong>interleave</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- The band interleave format to use for writing
the file; <code class="docutils literal notranslate"><span class="pre">interleave</span></code> should be one of 'bil', 'bip', or
'bsq' (default='bip').</p></li>
<li><p><strong>byteorder</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code> or <code class="docutils literal notranslate"><span class="pre">str</span></code>) -- Specifies the byte order
(endian-ness) of the data as written to disk. For little
endian, this value should be either 0 or 'little'. For big
endian, it should be either 1 or 'big'. If not specified,
native byte order will be used (default=None).</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <code class="docutils literal notranslate"><span class="pre">dtype</span></code>, <code class="docutils literal notranslate"><span class="pre">force</span></code>, <code class="docutils literal notranslate"><span class="pre">ext</span></code>, <code class="docutils literal notranslate"><span class="pre">interleave</span></code>, and <code class="docutils literal notranslate"><span class="pre">byteorder</span></code> are not
passed, default values will be pulled from <code class="docutils literal notranslate"><span class="pre">hsio.defaults</span></code>. Thus,
<code class="docutils literal notranslate"><span class="pre">hsio.defaults</span></code> can be modified prior to calling
<code class="docutils literal notranslate"><span class="pre">hsio.write_cube()</span></code> to avoid having to pass each of thes parameters
in the <code class="docutils literal notranslate"><span class="pre">hsio.write_cube()</span></code> function (see the
<code class="docutils literal notranslate"><span class="pre">hsio.set_io_defaults()</span></code> function for support on setting these
defaults and for more information on the parameters). Each of these
parameters are passed directly to the Spectral Python
<code class="docutils literal notranslate"><span class="pre">envi.save_image()</span></code> function. For more information, please refer to
the Spectral Python documentation.</p>
</div>
<p class="rubric">Example</p>
<p>Load <code class="docutils literal notranslate"><span class="pre">hsio</span></code> and <code class="docutils literal notranslate"><span class="pre">spatial_mod</span></code> modules</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pathlib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>  <span class="c1"># load hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">spatial_mod</span>  <span class="c1"># load spatial mod</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_hdr_in</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">()</span>  <span class="c1"># initialize the hsio class</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">read_cube</span><span class="p">(</span><span class="n">fname_hdr_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Perform simple spatial cropping via <code class="docutils literal notranslate"><span class="pre">spatial_mod.crop_single</span></code> to generate a new datacube.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">my_spatial_mod</span> <span class="o">=</span> <span class="n">spatial_mod</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>  <span class="c1"># initialize spatial_mod instance to crop the image</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array_crop</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">my_spatial_mod</span><span class="o">.</span><span class="n">crop_single</span><span class="p">(</span><span class="n">pix_e_ul</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">pix_n_ul</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">crop_e_m</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">crop_n_m</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>Save the datacube using <code class="docutils literal notranslate"><span class="pre">hsio.write_cube</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fname_hdr</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;hsio&#39;</span><span class="p">,</span> <span class="s1">&#39;Wells_rep2_20180628_16h56m_pika_gige_7-hsio-write-cube-cropped.bip.hdr&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">fname_hdr</span><span class="p">))</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">write_cube</span><span class="p">(</span><span class="n">fname_hdr</span><span class="p">,</span> <span class="n">array_crop</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Load the datacube into Spectronon for visualization</p>
<img alt="../img/utilities/write_cube.png" src="../img/utilities/write_cube.png" />
</dd></dl>

<dl class="py method">
<dt id="hs_process.hsio.write_spec">
<code class="sig-name descname"><span class="pre">write_spec</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname_hdr_spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interleave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">byteorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hsio.write_spec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.hsio.write_spec" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Wrapper function that accesses the <a class="reference external" href="http://www.spectralpython.net/">Spectral Python</a> package to save a
single spectra to file.</p>
<dl>
<dt>Parameters:</dt><dd><dl class="simple">
<dt>fname_hdr_spec (<code class="docutils literal notranslate"><span class="pre">str</span></code>): Output header file path (with the '.hdr'</dt><dd><p>extension). If the extension is explicitely specified in
<code class="docutils literal notranslate"><span class="pre">fname_hdr_spec</span></code> and the <code class="docutils literal notranslate"><span class="pre">ext</span></code> parameter is also specified,
<code class="docutils literal notranslate"><span class="pre">fname_hdr_spec</span></code> will be modified to conform to the extension
set using the <code class="docutils literal notranslate"><span class="pre">ext</span></code> parameter.</p>
</dd>
<dt>df_mean (<code class="docutils literal notranslate"><span class="pre">pandas.Series</span></code> or <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>): Mean spectra,</dt><dd><p>stored as a df row, where columns are the bands.</p>
</dd>
<dt>df_std (<code class="docutils literal notranslate"><span class="pre">pandas.Series</span></code> or <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, optional): Standard</dt><dd><p>deviation of each spectra, stored as a df row, where columns
are the bands. This will be saved to the .hdr file.</p>
</dd>
<dt>dtype (<code class="docutils literal notranslate"><span class="pre">numpy.dtype</span></code> or <code class="docutils literal notranslate"><span class="pre">str</span></code>): The data type with which to</dt><dd><p>store the image. For example, to store the image in 16-bit
unsigned integer format, the argument could be any of
numpy.uint16, 'u2', 'uint16', or 'H' (default=np.float32).</p>
</dd>
<dt>force (<code class="docutils literal notranslate"><span class="pre">bool</span></code>): If <code class="docutils literal notranslate"><span class="pre">hdr_file</span></code> or its associated image file</dt><dd><p>exist, <code class="docutils literal notranslate"><span class="pre">force=True</span></code> will overwrite the files; otherwise, an
exception will be raised if either file exists (default=False).</p>
</dd>
<dt>ext (<code class="docutils literal notranslate"><span class="pre">None</span></code> or <code class="docutils literal notranslate"><span class="pre">str</span></code>): The extension to use for saving the</dt><dd><p>image file. If not specified or if set to an empty string
(e.g., <code class="docutils literal notranslate"><span class="pre">ext=''</span></code>), a default extension is determined using the
same name as <code class="docutils literal notranslate"><span class="pre">fname_hdr_spec</span></code>, except without the &quot;.hdr&quot;
extension. If <code class="docutils literal notranslate"><span class="pre">fname_hdr_spec</span></code> is provided without the
&quot;non-.hdr&quot; extension (e.g., &quot;bip&quot;), then the extension is
determined from the <code class="docutils literal notranslate"><span class="pre">interleave</span></code> parameter. For example, if
<code class="docutils literal notranslate"><span class="pre">interleave``='bip',</span> <span class="pre">then</span> <span class="pre">``ext</span></code> is set to 'bip' as well. Use
of <code class="docutils literal notranslate"><span class="pre">ext</span></code> is not recommended; instead, just set
<code class="docutils literal notranslate"><span class="pre">fname_hdr_spec</span></code> with the correct extension or use
<code class="docutils literal notranslate"><span class="pre">interleave</span></code> to set the extension (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>;
determined from <code class="docutils literal notranslate"><span class="pre">fname_hdr_spec</span></code> or <code class="docutils literal notranslate"><span class="pre">interleave</span></code>).</p>
</dd>
<dt>interleave (<code class="docutils literal notranslate"><span class="pre">str</span></code>): The band interleave format to use for writing</dt><dd><p>the file; <code class="docutils literal notranslate"><span class="pre">interleave</span></code> should be one of 'bil', 'bip', or
'bsq' (default='bip').</p>
</dd>
<dt>byteorder (<code class="docutils literal notranslate"><span class="pre">int</span></code> or <code class="docutils literal notranslate"><span class="pre">str</span></code>): Specifies the byte order</dt><dd><p>(endian-ness) of the data as written to disk. For little
endian, this value should be either 0 or 'little'. For big
endian, it should be either 1 or 'big'. If not specified,
native byte order will be used (default=None).</p>
</dd>
<dt>metadata (<code class="docutils literal notranslate"><span class="pre">dict</span></code>): Metadata to write to the ENVI .hdr file</dt><dd><p>describing the spectra being saved; if <code class="docutils literal notranslate"><span class="pre">None</span></code>, will try to
pull metadata template from <code class="docutils literal notranslate"><span class="pre">hsio.spyfile_spec.metadata</span></code> or
<code class="docutils literal notranslate"><span class="pre">hsio.spyfile.metadata</span></code> (default=None).</p>
</dd>
</dl>
</dd>
<dt>Example:</dt><dd><p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span> <span class="c1"># load hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_hdr_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">()</span>  <span class="c1"># initialize the hsio class (note there are no required parameters)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">read_cube</span><span class="p">(</span><span class="n">fname_hdr_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Calculate spectral mean via <code class="docutils literal notranslate"><span class="pre">hstools.mean_datacube</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">spec_mean</span><span class="p">,</span> <span class="n">spec_std</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">mean_datacube</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_hdr_spec</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\hsio\Wells_rep2_20180628_16h56m_pika_gige_7-mean.spec.hdr&#39;</span>
</pre></div>
</div>
<p>Save the new spectra to file via <code class="docutils literal notranslate"><span class="pre">hsio.write_spec</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">write_spec</span><span class="p">(</span><span class="n">fname_hdr_spec</span><span class="p">,</span> <span class="n">spec_mean</span><span class="p">,</span> <span class="n">spec_std</span><span class="p">)</span>
<span class="go">Saving F:</span>
</pre></div>
</div>
</dd>
</dl>
</div></blockquote>
<p>igo0024Documentshs_process_demohsioWells_rep2_20180628_16h56m_pika_gige_7-mean.spec</p>
<blockquote>
<div><blockquote>
<div><p>Open <em>Wells_rep2_20180628_16h56m_pika_gige_7-mean.spec</em> in <em>Spectronon</em> for visualization</p>
<img alt="../img/utilities/write_spec.png" src="../img/utilities/write_spec.png" />
</div></blockquote>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="hs_process.hsio.write_tif">
<code class="sig-name descname"><span class="pre">write_tif</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname_tif</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spyfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname_in</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">projection_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geotransform_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_img</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hsio.write_tif"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.hsio.write_tif" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper function that accesses the <a class="reference external" href="https://pypi.org/project/GDAL/">GDAL Python package</a> to save a
small datacube subset (i.e., three bands or less) to file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname_tif</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- Output image file path (with the '.tif'
extension).</p></li>
<li><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object or <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, optional) -- The
data cube to save. If <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, then metadata
(<code class="docutils literal notranslate"><span class="pre">dict</span></code>) should also be passed. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, uses
hsio.spyfile (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>metadata</strong> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>) -- Metadata information; if <code class="docutils literal notranslate"><span class="pre">geotransform_out</span></code>
is not passed, &quot;map info&quot; is accessed from <code class="docutils literal notranslate"><span class="pre">metadata</span></code> and
<code class="docutils literal notranslate"><span class="pre">geotransform_out</span></code> is created from that &quot;map info&quot;.</p></li>
<li><p><strong>fname_in</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>, optional) -- The filename of the image datacube to
be read in initially. This is potentially useful if
<code class="docutils literal notranslate"><span class="pre">projection_out</span></code> and/or <code class="docutils literal notranslate"><span class="pre">geotransform_out</span></code> are not passed
and a <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> is passed as the <code class="docutils literal notranslate"><span class="pre">spyfile</span></code> - in this
case, <code class="docutils literal notranslate"><span class="pre">write_tif()</span></code> uses <code class="docutils literal notranslate"><span class="pre">fname_in</span></code> to load the
<code class="docutils literal notranslate"><span class="pre">fname_in</span></code> datacube via GDAL, which can in turn be used to
load the projection or geotransform information for the output
geotiff (default: None).</p></li>
<li><p><strong>projection_out</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- The GDAL projection to use while writing
the geotiff. Applied using
gdal.driver.dataset.SetProjection() (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>;
<code class="docutils literal notranslate"><span class="pre">hsio.projection_out</span></code>)</p></li>
<li><p><strong>geotransform_out</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- The GDAL geotransform to use while
writing the geotiff. Applied using
gdal.driver.dataset.SetGeoTransform() (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>;
<code class="docutils literal notranslate"><span class="pre">hsio.geotransform_out</span></code>)</p></li>
<li><p><strong>show_img</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code> or <code class="docutils literal notranslate"><span class="pre">str</span></code>) -- Whether to display a render of the
image being saved as a geotiff. Must be <code class="docutils literal notranslate"><span class="pre">False</span></code> (does not
display the image), &quot;inline&quot; (displays the image inline using
the IPython console), or &quot;popout&quot; (displays the image in a
pop-out window; default: &quot;inline&quot;).</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>  <span class="c1"># load hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_hdr_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">()</span>  <span class="c1"># initialize the hsio class</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">read_cube</span><span class="p">(</span><span class="n">fname_hdr_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Save an RGB render of the datacube to file via <code class="docutils literal notranslate"><span class="pre">hsio.write_tif</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fname_tif</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\hsio\Wells_rep2_20180628_16h56m_pika_gige_7.tif&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">write_tif</span><span class="p">(</span><span class="n">fname_tif</span><span class="p">,</span> <span class="n">spyfile</span><span class="o">=</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">,</span> <span class="n">fname_in</span><span class="o">=</span><span class="n">fname_hdr_in</span><span class="p">)</span>
<span class="go">Either `projection_out` is `None` or `geotransform_out` is `None` (or both are). Retrieving projection and geotransform information by loading `hsio.fname_in` via GDAL. Be sure this is appropriate for the data you are trying to write.</span>
<span class="go">Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).</span>
</pre></div>
</div>
<img alt="../img/utilities/write_tif.png" src="../img/utilities/write_tif.png" />
<p>Open <em>Wells_rep2_20180628_16h56m_pika_gige_7.tif</em> in <em>QGIS</em> with the plot boundaries overlaid</p>
<img alt="../img/utilities/write_tif_qgis.png" src="../img/utilities/write_tif_qgis.png" />
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="hs_process.hstools">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hs_process.</span></code><code class="sig-name descname"><span class="pre">hstools</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spyfile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hstools"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.hstools" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Basic tools for manipulating Spyfiles and accessing their metadata.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object) -- The datacube being accessed and/or
manipulated.</p>
</dd>
</dl>
<dl class="py method">
<dt id="hs_process.hstools.clean_md_sets">
<code class="sig-name descname"><span class="pre">clean_md_sets</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hstools.clean_md_sets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.hstools.clean_md_sets" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts metadata items that are expressed as a list to be expressed as
a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>metadata</strong> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>, optional) -- Metadata dictionary to clean</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>metadata_out</strong> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>) -- Cleaned metadata dictionary.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">dict</span></code></p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Create sample metadata with &quot;wavelength&quot; expressed as a list of strings</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;samples&#39;</span><span class="p">:</span> <span class="mi">1300</span><span class="p">,</span>
<span class="go">                &#39;lines&#39;: 617,</span>
<span class="go">                &#39;bands&#39;: 4,</span>
<span class="go">                &#39;file type&#39;: &#39;ENVI Standard&#39;,</span>
<span class="go">                &#39;wavelength&#39;: [&#39;394.6&#39;, &#39;396.6528&#39;, &#39;398.7056&#39;,</span>
<span class="go">                &#39;400.7584&#39;]}</span>
</pre></div>
</div>
<p>Clean metadata using <code class="docutils literal notranslate"><span class="pre">hstools.clean_md_sets</span></code>. Notice how
wavelength is now expressed as a <code class="docutils literal notranslate"><span class="pre">str</span></code> representation of a
<code class="docutils literal notranslate"><span class="pre">dict</span></code>, which is required for properly writing the metadata to
the .hdr file via <a class="reference external" href="http://www.spectralpython.net/class_func_ref.html#spectral.io.envi.save_image">save_image()</a> in Spectral Python.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">clean_md_sets</span><span class="p">(</span><span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">)</span>
<span class="go">{&#39;samples&#39;: 1300,</span>
<span class="go"> &#39;lines&#39;: 617,</span>
<span class="go"> &#39;bands&#39;: 4,</span>
<span class="go"> &#39;file type&#39;: &#39;ENVI Standard&#39;,</span>
<span class="go"> &#39;wavelength&#39;: &#39;{394.6, 396.6528, 398.7056, 400.7584}&#39;}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hs_process.hstools.del_meta_item">
<code class="sig-name descname"><span class="pre">del_meta_item</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metadata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hstools.del_meta_item"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.hstools.del_meta_item" title="Permalink to this definition">¶</a></dt>
<dd><p>Deletes metadata item from SpyFile object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metadata</strong> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>) -- dictionary of the metadata</p></li>
<li><p><strong>key</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- dictionary key to delete</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>metadata</strong> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>) -- Dictionary containing the modified
metadata.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">dict</span></code></p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Create sample metadata</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;samples&#39;</span><span class="p">:</span> <span class="mi">1300</span><span class="p">,</span>
<span class="go">                &#39;lines&#39;: 617,</span>
<span class="go">                &#39;bands&#39;: 4,</span>
<span class="go">                &#39;file type&#39;: &#39;ENVI Standard&#39;,</span>
<span class="go">                &#39;map info&#39;: &#39;{UTM, 1.0, 1.0, 421356.76707299997, 4844936.7317699995, 0.04, 0.04, 15, T, WGS-84, units  meters, rotation  0.000}&#39;,</span>
<span class="go">                &#39;wavelength&#39;: [&#39;394.6&#39;, &#39;396.6528&#39;, &#39;398.7056&#39;,</span>
<span class="go">                &#39;400.7584&#39;]}</span>
</pre></div>
</div>
<p>Delete <em>&quot;map info&quot;</em> from <code class="docutils literal notranslate"><span class="pre">metadata</span></code> using <code class="docutils literal notranslate"><span class="pre">hstools.del_met_item</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">del_meta_item</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span> <span class="s1">&#39;map info&#39;</span><span class="p">)</span>
<span class="go">{&#39;samples&#39;: 1827,</span>
<span class="go"> &#39;lines&#39;: 617,</span>
<span class="go"> &#39;bands&#39;: 4,</span>
<span class="go"> &#39;file type&#39;: &#39;ENVI Standard&#39;,</span>
<span class="go"> &#39;wavelength&#39;: [&#39;394.6&#39;, &#39;396.6528&#39;, &#39;398.7056&#39;, &#39;400.7584&#39;]}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hs_process.hstools.dir_data">
<code class="sig-name descname"><span class="pre">dir_data</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hstools.dir_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.hstools.dir_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves the data directory from &quot;site packages&quot;.</p>
</dd></dl>

<dl class="py method">
<dt id="hs_process.hstools.get_UTM">
<code class="sig-name descname"><span class="pre">get_UTM</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pix_e_ul</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pix_n_ul</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">utm_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">utm_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size_y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hstools.get_UTM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.hstools.get_UTM" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the new UTM coordinate of cropped plot to modify the
&quot;map info&quot; tag of the .hdr file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pix_e_ul</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- upper left column (easting) where image
cropping begins.</p></li>
<li><p><strong>pix_n_ul</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- upper left row (northing) where image cropping
begins.</p></li>
<li><p><strong>utm_x</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>) -- UTM easting coordinates (meters) of the original
image (from the upper left).</p></li>
<li><p><strong>utm_y</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>) -- UTM northing coordinates (meters) of the
original image (from the upper left).</p></li>
<li><p><strong>size_x</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>) -- Ground resolved distance of the image pixels in
the x (easting) direction (meters).</p></li>
<li><p><strong>size_y</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>) -- Ground resolved distance of the image pixels in
the y (northing) direction (meters).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>2-element <code class="docutils literal notranslate"><span class="pre">tuple</span></code> containing</p>
<ul class="simple">
<li><p><strong>utm_x_new</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>): The modified UTM x coordinate (easting)
of cropped plot.</p></li>
<li><p><strong>utm_y_new</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>): The modified UTM y coordinate (northing)
of cropped plot.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Retrieve UTM coordinates and pixel sizes from the metadata</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">map_info_set</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;map info&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">utm_x</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_meta_set</span><span class="p">(</span><span class="n">map_info_set</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">utm_y</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_meta_set</span><span class="p">(</span><span class="n">map_info_set</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spy_ps_e</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">map_info_set</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spy_ps_n</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">map_info_set</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>
</pre></div>
</div>
<p>Calculate the UTM coordinates at the <em>100th easting pixel</em> and
<em>50th northing pixel</em> using <code class="docutils literal notranslate"><span class="pre">hstools.get_UTM</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ul_x_utm</span><span class="p">,</span> <span class="n">ul_y_utm</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_UTM</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span>
<span class="go">                                          utm_x, utm_y,</span>
<span class="go">                                          spy_ps_e,</span>
<span class="go">                                          spy_ps_n)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ul_x_utm</span>
<span class="go">441360.80707299995</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ul_y_utm</span>
<span class="go">4855934.691769999</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hs_process.hstools.get_band">
<code class="sig-name descname"><span class="pre">get_band</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_wl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spyfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hstools.get_band"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.hstools.get_band" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the band number of the closest target wavelength.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_wl</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code> or <code class="docutils literal notranslate"><span class="pre">float</span></code>) -- the target wavelength to retrieve
the band number for (required).</p></li>
<li><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object, optional) -- The datacube being accessed
and/or manipulated; if <code class="docutils literal notranslate"><span class="pre">None</span></code>, uses <code class="docutils literal notranslate"><span class="pre">hstools.spyfile</span></code>
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>key_band</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- band number of the closest target
wavelength (<code class="docutils literal notranslate"><span class="pre">target_wl</span></code>).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">int</span></code></p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Use <code class="docutils literal notranslate"><span class="pre">hstools.get_band</span></code> to find the band number corresponding to
<em>703 nm</em></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_band</span><span class="p">(</span><span class="mi">703</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
<span class="go">151</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hs_process.hstools.get_band_index">
<code class="sig-name descname"><span class="pre">get_band_index</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">band_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hstools.get_band_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.hstools.get_band_index" title="Permalink to this definition">¶</a></dt>
<dd><p>.
Returns the index of <code class="docutils literal notranslate"><span class="pre">band</span></code> from &quot;band names&quot;.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>band_name</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code> or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the target band to retrieve the
band index for (required).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>band_idx</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- band index of the passed band name
(<code class="docutils literal notranslate"><span class="pre">band_name</span></code>).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">int</span></code> or <code class="docutils literal notranslate"><span class="pre">list</span></code></p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Using <code class="docutils literal notranslate"><span class="pre">hstools.get_band_index</span></code>, find the band index of bands <em>4</em>, <em>43</em>, and <em>111</em>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_band_index</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">111</span><span class="p">])</span>
<span class="go">[3, 42, 110]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hs_process.hstools.get_band_num">
<code class="sig-name descname"><span class="pre">get_band_num</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">band_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hstools.get_band_num"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.hstools.get_band_num" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds 1 to <code class="docutils literal notranslate"><span class="pre">band_idx</span></code> and returns the band number(s).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>band_idx</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code> or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the target band index(es) to
retrive the band number for (required).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>band_num</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code> or <code class="docutils literal notranslate"><span class="pre">list</span></code>): band number of the passed
band index (<code class="docutils literal notranslate"><span class="pre">band_idx</span></code>).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">int</span></code> or <code class="docutils literal notranslate"><span class="pre">list</span></code></p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Using <code class="docutils literal notranslate"><span class="pre">hstools.get_band_num</span></code>, find the band number located at the <em>4th</em>, <em>43rd</em>, and <em>111th</em> index values.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_band_num</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">111</span><span class="p">])</span>
<span class="go">[5, 44, 112]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hs_process.hstools.get_band_range">
<code class="sig-name descname"><span class="pre">get_band_range</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">range_wl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spyfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hstools.get_band_range"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.hstools.get_band_range" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Retrieves the band index or band name for all bands within a
wavelength range.</p>
<dl>
<dt>Parameters:</dt><dd><dl class="simple">
<dt>range_wl (<code class="docutils literal notranslate"><span class="pre">list</span></code>): the minimum and maximum wavelength to consider;</dt><dd><p>values should be <code class="docutils literal notranslate"><span class="pre">int</span></code> or <code class="docutils literal notranslate"><span class="pre">float</span></code>.</p>
</dd>
<dt>index (bool): Indicates whether to return the band number</dt><dd><p>(<code class="docutils literal notranslate"><span class="pre">False</span></code>; min=1) or to return index number (<code class="docutils literal notranslate"><span class="pre">True</span></code>; min=0)
(default: <code class="docutils literal notranslate"><span class="pre">True</span></code>).</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">list</span></code>:</dt><dd><p><strong>band_list</strong> (<code class="docutils literal notranslate"><span class="pre">list</span></code>): A list of all bands (either index or
number, depending on how <code class="docutils literal notranslate"><span class="pre">index</span></code> is set) between a range in
wavelength values.</p>
</dd>
</dl>
</dd>
<dt>Example:</dt><dd><p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Find the band name of all bands between <em>700</em> and <em>710 nm</em></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_band_range</span><span class="p">([</span><span class="mi">700</span><span class="p">,</span> <span class="mi">710</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">spyfile</span><span class="o">=</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
<span class="go">[150, 151, 152, 153, 154]</span>
</pre></div>
</div>
<p>Find the band index values of all bands between <em>700</em> and <em>710 nm</em>
via <code class="docutils literal notranslate"><span class="pre">hstools.get_band_range</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_band_range</span><span class="p">([</span><span class="mi">700</span><span class="p">,</span> <span class="mi">710</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">spyfile</span><span class="o">=</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
<span class="go">[149, 150, 151, 152, 153]</span>
</pre></div>
</div>
<p>Sometimes &quot;band names&quot; are not integers in sequential order. To
demonstrate the utility of the <code class="docutils literal notranslate"><span class="pre">index</span></code> parameter, let's take a
look at Sentinel 2A mimicked imagery.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:</span>
</pre></div>
</div>
</dd>
</dl>
</div></blockquote>
<dl>
<dt>igo0024Documentshs_process_demospec_mod'</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;Wells_rep2_20180628_16h56m_pika_gige_7-mimic-s2a.bip.hdr&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Find the band name of all bands between <em>760</em> and <em>840 nm</em></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_band_range</span><span class="p">([</span><span class="mi">760</span><span class="p">,</span> <span class="mi">840</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">spyfile</span><span class="o">=</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
<span class="go">[&#39;S2A_SR_AV_B7&#39;, &#39;S2A_SR_AV_B8&#39;]</span>
</pre></div>
</div>
<p>Find the band index values of all bands between <em>760</em> and <em>840 nm</em>
via <code class="docutils literal notranslate"><span class="pre">hstools.get_band_range</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_band_range</span><span class="p">([</span><span class="mi">760</span><span class="p">,</span> <span class="mi">840</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">spyfile</span><span class="o">=</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
<span class="go">[6, 7]</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hs_process.hstools.get_center_wl">
<code class="sig-name descname"><span class="pre">get_center_wl</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wl_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spyfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wls</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hstools.get_center_wl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.hstools.get_center_wl" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets band numbers and mean wavelength from all wavelengths (or bands)
in <code class="docutils literal notranslate"><span class="pre">wl_list</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wl_list</strong> (<code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the list of bands to get information for
(required).</p></li>
<li><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object) -- The datacube being accessed and/or
manipulated; if <code class="docutils literal notranslate"><span class="pre">None</span></code>, uses <code class="docutils literal notranslate"><span class="pre">hstools.spyfile</span></code> (default:
<code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>wls</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- whether wavelengths are passed in <code class="docutils literal notranslate"><span class="pre">wl_list</span></code> or if
bands are passed in <code class="docutils literal notranslate"><span class="pre">wl_list</span></code> (default: <code class="docutils literal notranslate"><span class="pre">True</span></code> - wavelenghts
passed).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>2-element <code class="docutils literal notranslate"><span class="pre">tuple</span></code> containing</p>
<ul class="simple">
<li><p><strong>bands</strong> (<code class="docutils literal notranslate"><span class="pre">list</span></code>): the list of bands (band number) corresponding
to <code class="docutils literal notranslate"><span class="pre">wl_list</span></code>.</p></li>
<li><p><strong>wls_mean</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>): the mean wavelength from <code class="docutils literal notranslate"><span class="pre">wl_list</span></code>.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Using <code class="docutils literal notranslate"><span class="pre">hstools.get_center_wl</span></code>, find the bands and <em>actual mean wavelength</em> of the bands closest to <em>700</em> and <em>710</em> nm.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bands</span><span class="p">,</span> <span class="n">wls_mean</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_center_wl</span><span class="p">([</span><span class="mi">700</span><span class="p">,</span> <span class="mi">710</span><span class="p">],</span> <span class="n">wls</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bands</span>
<span class="go">[150, 155]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wls_mean</span>
<span class="go">705.5992</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hs_process.hstools.get_meta_set">
<code class="sig-name descname"><span class="pre">get_meta_set</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">meta_set</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hstools.get_meta_set"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.hstools.get_meta_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads metadata &quot;set&quot; (i.e., string representation of a Python set;
common in .hdr files), taking care to remove leading and trailing
spaces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>meta_set</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- the string representation of the metadata set</p></li>
<li><p><strong>idx</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- index to be read; if <code class="docutils literal notranslate"><span class="pre">None</span></code>, the whole list is
returned (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>metadata_list</strong> (<code class="docutils literal notranslate"><span class="pre">list</span></code> or <code class="docutils literal notranslate"><span class="pre">str</span></code>): List of metadata set
items (as <code class="docutils literal notranslate"><span class="pre">str</span></code>), or if idx is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, the item in the
position described by <code class="docutils literal notranslate"><span class="pre">idx</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">list</span></code> or <code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Retrieve the <em>&quot;map info&quot; set</em> from the metadata via
<code class="docutils literal notranslate"><span class="pre">hstools.get_meta_set</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">map_info_set</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;map info&#39;</span><span class="p">]</span>
<span class="go">[&#39;UTM&#39;,</span>
<span class="go"> &#39;1.0&#39;,</span>
<span class="go"> &#39;1.0&#39;,</span>
<span class="go"> &#39;441357.287073&#39;,</span>
<span class="go"> &#39;4855944.7717699995&#39;,</span>
<span class="go"> &#39;0.04&#39;,</span>
<span class="go"> &#39;0.04&#39;,</span>
<span class="go"> &#39;15&#39;,</span>
<span class="go"> &#39;T&#39;,</span>
<span class="go"> &#39;WGS-84&#39;,</span>
<span class="go"> &#39;units  meters&#39;,</span>
<span class="go"> &#39;rotation  0.000&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hs_process.hstools.get_spectral_mean">
<code class="sig-name descname"><span class="pre">get_spectral_mean</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">band_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spyfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hstools.get_spectral_mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.hstools.get_spectral_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the spectral mean of a datacube from a list of bands.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>band_list</strong> (<code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the list of bands to calculate the spectral
mean for on the datacube (required).</p></li>
<li><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object or <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) -- The datacube being
accessed and/or manipulated; if <code class="docutils literal notranslate"><span class="pre">None</span></code>, uses <code class="docutils literal notranslate"><span class="pre">hstools.spyfile</span></code>
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>array_mean</strong> (<code class="docutils literal notranslate"><span class="pre">numpy.array</span></code> or <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>): The
mean reflectance from <code class="docutils literal notranslate"><span class="pre">spyfile</span></code> for the bands in <code class="docutils literal notranslate"><span class="pre">band_list</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">numpy.array</span></code> or <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Calculate the spectral mean of the datacube via
<code class="docutils literal notranslate"><span class="pre">hstools.get_spectral_mean</span></code> using all bands between <em>800</em> and
<em>840 nm</em></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">band_list</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_band_range</span><span class="p">([</span><span class="mi">800</span><span class="p">,</span> <span class="mi">840</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array_mean</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_spectral_mean</span><span class="p">(</span><span class="n">band_list</span><span class="p">,</span> <span class="n">spyfile</span><span class="o">=</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">show_img</span><span class="p">(</span><span class="n">array_mean</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../img/utilities/get_spectral_mean.png" src="../img/utilities/get_spectral_mean.png" />
</dd></dl>

<dl class="py method">
<dt id="hs_process.hstools.get_wavelength">
<code class="sig-name descname"><span class="pre">get_wavelength</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_band</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spyfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hstools.get_wavelength"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.hstools.get_wavelength" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns actual wavelength of the closest target band.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_band</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code> or <code class="docutils literal notranslate"><span class="pre">float</span></code>) -- the target band to retrieve
wavelength number for (required).</p></li>
<li><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object, optional) -- The datacube being accessed and/or
manipulated; if <code class="docutils literal notranslate"><span class="pre">None</span></code>, uses <code class="docutils literal notranslate"><span class="pre">hstools.spyfile</span></code> (default:
<code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>key_wavelength</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>) -- wavelength of the closest
target band (<code class="docutils literal notranslate"><span class="pre">target_band</span></code>).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Use <code class="docutils literal notranslate"><span class="pre">hstools.get_wavelength</span></code> to find the wavelength value corresponding to the <em>151st band</em></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_wavelength</span><span class="p">(</span><span class="mi">151</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
<span class="go">702.52</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hs_process.hstools.get_wavelength_range">
<code class="sig-name descname"><span class="pre">get_wavelength_range</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">range_bands</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spyfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hstools.get_wavelength_range"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.hstools.get_wavelength_range" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Retrieves the wavelengths for all bands within a band range.</p>
<dl>
<dt>Parameters:</dt><dd><dl class="simple">
<dt>range_bands (<code class="docutils literal notranslate"><span class="pre">list</span></code>): the minimum and maximum band number to</dt><dd><p>consider; values should be <code class="docutils literal notranslate"><span class="pre">int</span></code>.</p>
</dd>
<dt>index (bool): Indicates whether the bands in <code class="docutils literal notranslate"><span class="pre">range_bands</span></code> denote</dt><dd><p>the band number (<code class="docutils literal notranslate"><span class="pre">False</span></code>; min=1) or the index number
(<code class="docutils literal notranslate"><span class="pre">True</span></code>; min=0) (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>).</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">list</span></code>:</dt><dd><p><strong>wavelength_list</strong> (<code class="docutils literal notranslate"><span class="pre">list</span></code>): A list of all wavelengths
between a range in band numbers or index values (depending how
<code class="docutils literal notranslate"><span class="pre">index</span></code> is set).</p>
</dd>
</dl>
</dd>
<dt>Example:</dt><dd><p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_hdr</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:</span>
</pre></div>
</div>
</dd>
</dl>
</div></blockquote>
<dl>
<dt>igo0024DocumentsGitHubhs_processhs_processdataWells_rep2_20180628_16h56m_test_pika_gige_7-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr'</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_hdr</span><span class="p">)</span>
</pre></div>
</div>
<p>Find the wavelengths from the <em>16th</em> to <em>21st bands</em></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_wavelength_range</span><span class="p">([</span><span class="mi">16</span><span class="p">,</span> <span class="mi">21</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">spyfile</span><span class="o">=</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
<span class="go">[425.392, 427.4448, 429.4976, 431.5504, 433.6032, 435.656]</span>
</pre></div>
</div>
<p>Find the wavelengths from the <em>16th</em> to the <em>21st index</em></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_wavelength_range</span><span class="p">([</span><span class="mi">16</span><span class="p">,</span> <span class="mi">21</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">spyfile</span><span class="o">=</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
<span class="go">[427.4448, 429.4976, 431.5504, 433.6032, 435.656, 437.7088]</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hs_process.hstools.load_spyfile">
<code class="sig-name descname"><span class="pre">load_spyfile</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spyfile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hstools.load_spyfile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.hstools.load_spyfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a <code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> (Spectral Python object) for data access and/or
manipulation by the <code class="docutils literal notranslate"><span class="pre">hstools</span></code> class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object) -- The datacube being accessed and/or
manipulated.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Load a new datacube using <code class="docutils literal notranslate"><span class="pre">hstools.load_spyfile</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">load_spyfile</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">spyfile</span>
<span class="go">Data Source:   &#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip&#39;</span>
<span class="go">    # Rows:            617</span>
<span class="go">    # Samples:        1300</span>
<span class="go">    # Bands:           240</span>
<span class="go">    Interleave:        BIP</span>
<span class="go">    Quantization:  32 bits</span>
<span class="go">    Data format:   float32</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hs_process.hstools.mask_array">
<code class="sig-name descname"><span class="pre">mask_array</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percentile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">side</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lower'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hstools.mask_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.hstools.mask_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a masked numpy array based on a threshold value. If <code class="docutils literal notranslate"><span class="pre">array</span></code> is
already a masked array, that mask is maintained and the new mask(s) is/
are added to the original mask.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) -- The data array to mask.</p></li>
<li><p><strong>thresh</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code> or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- The value for which to base the
threshold; if <code class="docutils literal notranslate"><span class="pre">thresh</span></code> is <code class="docutils literal notranslate"><span class="pre">list</span></code> and <code class="docutils literal notranslate"><span class="pre">side</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>,
then all values in <code class="docutils literal notranslate"><span class="pre">thresh</span></code> will be masked; if <code class="docutils literal notranslate"><span class="pre">thresh</span></code> is
<code class="docutils literal notranslate"><span class="pre">list</span></code> and <code class="docutils literal notranslate"><span class="pre">side</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, then only the first
value in the list will be considered for thresholding (default:
<code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>percentile</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>) -- The percentile of pixels to mask; if
<code class="docutils literal notranslate"><span class="pre">percentile</span></code> = 95 and <code class="docutils literal notranslate"><span class="pre">side</span></code> = 'lower', the lowest 95% of
pixels will be masked prior to calculating the mean spectra
across pixels (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>; range: 0-100).</p></li>
<li><p><strong>side</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- The side of the threshold for which to apply the
mask. Must be either 'lower', 'upper', 'outside', or <code class="docutils literal notranslate"><span class="pre">None</span></code>;
if 'lower', everything below the threshold will be masked; if
'outside', the <code class="docutils literal notranslate"><span class="pre">thresh</span></code> / <code class="docutils literal notranslate"><span class="pre">percentile</span></code> parameter must be
list-like with two values indicating the lower and upper bounds
- anything outside of these values will be masked out; if
<code class="docutils literal notranslate"><span class="pre">None</span></code>, only the values that exactly match the threshold will
be masked (default: 'lower').</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>2-element <code class="docutils literal notranslate"><span class="pre">tuple</span></code> containing</p>
<ul class="simple">
<li><p><strong>array_mask</strong> (<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>): The masked <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>
based on the passed threshold and/or percentile value.</p></li>
<li><p><strong>metadata</strong> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>): The modified metadata.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Retrieve the image band at <em>800 nm</em> using <code class="docutils literal notranslate"><span class="pre">hstools.get_band</span></code> and
<code class="docutils literal notranslate"><span class="pre">hsio.spyfile.open_memmap</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">band</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_band</span><span class="p">(</span><span class="mi">800</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">open_memmap</span><span class="p">()[:,</span> <span class="p">:,</span> <span class="n">band</span><span class="p">]</span>
</pre></div>
</div>
<p>Create a masked array of all values below the <em>75th percentile</em>
via <code class="docutils literal notranslate"><span class="pre">hstools.mask_array</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">array_mask</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">mask_array</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span> <span class="n">percentile</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>See that the <em>&quot;history&quot;</em> tage in the <code class="docutils literal notranslate"><span class="pre">metadata</span></code> has been modified</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;history&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">158</span><span class="p">:]</span>
<span class="go">&quot;hs_process.mask_array[&lt;label: &#39;thresh?&#39; value:None; label: &#39;percentile?&#39; value:75; label: &#39;side?&#39; value:lower; label: &#39;unmasked_pct?&#39; value:24.9935170178282&gt;]&quot;</span>
</pre></div>
</div>
<p>Visualize the unmasked array using <code class="docutils literal notranslate"><span class="pre">hsio.show_img</span></code>. Set <code class="docutils literal notranslate"><span class="pre">vmin</span></code>
and <code class="docutils literal notranslate"><span class="pre">vmax</span></code> to ensure the same color scale is used in comparing
the masked vs. unmasked arrays.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">vmin</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vmax</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">show_img</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../img/utilities/mask_array_800nm.png" src="../img/utilities/mask_array_800nm.png" />
<p>Visualize the unmasked array using <code class="docutils literal notranslate"><span class="pre">hsio.show_img</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">show_img</span><span class="p">(</span><span class="n">array_mask</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../img/utilities/mask_array_800nm_75th.png" src="../img/utilities/mask_array_800nm_75th.png" />
</dd></dl>

<dl class="py method">
<dt id="hs_process.hstools.mean_datacube">
<code class="sig-name descname"><span class="pre">mean_datacube</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spyfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nodata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hstools.mean_datacube"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.hstools.mean_datacube" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Calculates the mean spectra for a datcube; if <code class="docutils literal notranslate"><span class="pre">mask</span></code> is passed (as a
<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>), then the mask is applied to <code class="docutils literal notranslate"><span class="pre">spyfile</span></code> prior to
computing the mean spectra.</p>
<dl>
<dt>Parameters:</dt><dd><dl class="simple">
<dt>spyfile (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object or <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>): The</dt><dd><p>hyperspectral datacube to mask.</p>
</dd>
<dt>mask (<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>): the mask to apply to <code class="docutils literal notranslate"><span class="pre">spyfile</span></code>; if</dt><dd><p><code class="docutils literal notranslate"><span class="pre">mask</span></code> does not have similar dimensions to <code class="docutils literal notranslate"><span class="pre">spyfile</span></code>, the
first band (i.e., first two dimensions) of <code class="docutils literal notranslate"><span class="pre">mask</span></code> will be
repeated <em>n</em> times to match the number of bands of <code class="docutils literal notranslate"><span class="pre">spyfile</span></code>
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
</dd>
<dt>nodata (<code class="docutils literal notranslate"><span class="pre">float</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code>): If <code class="docutils literal notranslate"><span class="pre">None</span></code>, treats all pixels</dt><dd><p>cells as they are repressented in the <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>.
Otherwise, replaces <code class="docutils literal notranslate"><span class="pre">nodata</span></code> with <code class="docutils literal notranslate"><span class="pre">np.nan</span></code> and these cells
will not be considered when calculating the mean spectra.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>3-element <code class="docutils literal notranslate"><span class="pre">tuple</span></code> containing</p>
<ul class="simple">
<li><p><strong>spec_mean</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile.SpyFile</span></code> object): The mean spectra from
the input datacube.</p></li>
<li><p><strong>spec_std</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile.SpyFile</span></code> object): The standard deviation
of the spectra from the input datacube.</p></li>
<li><p><strong>datacube_masked</strong> (<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>): The masked
<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>; if <code class="docutils literal notranslate"><span class="pre">mask</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">datacube_masked</span></code>
is identical to the <code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> data array.</p></li>
</ul>
</dd>
<dt>Example:</dt><dd><p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Retrieve the image band at <em>800 nm</em> using <code class="docutils literal notranslate"><span class="pre">hstools.get_band</span></code> and
<code class="docutils literal notranslate"><span class="pre">hsio.spyfile.open_memmap</span></code>, then mask out all pixels whose value falls
below the <em>75th percentile</em>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">band</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_band</span><span class="p">(</span><span class="mi">800</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">open_memmap</span><span class="p">()[:,</span> <span class="p">:,</span> <span class="n">band</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array_mask</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">mask_array</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span> <span class="n">percentile</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Calculate the spectral mean from the remaining <em>(i.e., unmasked)</em>
pixels using <code class="docutils literal notranslate"><span class="pre">hstools.mean_datacube</span></code>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">spec_mean</span><span class="p">,</span> <span class="n">spec_std</span><span class="p">,</span> <span class="n">datacube_masked</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">mean_datacube</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">array_mask</span><span class="p">)</span>
</pre></div>
</div>
<p>Save using <code class="docutils literal notranslate"><span class="pre">hsio.write_spec</span></code> and <code class="docutils literal notranslate"><span class="pre">hsio.write_cube</span></code>, then load
into Spectronon software for visualization.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fname_hdr_spec</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\hstools\Wells_rep2_20180628_16h56m_pika_gige_7-mean_800nm_75th.spec.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_hdr_cube</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\hstools\Wells_rep2_20180628_16h56m_pika_gige_7-mean_800nm_75th.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">write_spec</span><span class="p">(</span><span class="n">fname_hdr_spec</span><span class="p">,</span> <span class="n">spec_mean</span><span class="p">,</span> <span class="n">spec_std</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Saving F:</span>
</pre></div>
</div>
</dd>
</dl>
</div></blockquote>
<dl>
<dt>igo0024Documentshs_process_demohstoolsWells_rep2_20180628_16h56m_pika_gige_7-mean_800nm_75th.spec</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">write_cube</span><span class="p">(</span><span class="n">fname_hdr_cube</span><span class="p">,</span> <span class="n">datacube_masked</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Saving F:</span>
</pre></div>
</div>
</dd>
</dl>
<p>igo0024Documentshs_process_demohstoolsWells_rep2_20180628_16h56m_pika_gige_7-mean_800nm_75th.bip</p>
<blockquote>
<div><img alt="../img/utilities/mean_datacube.png" src="../img/utilities/mean_datacube.png" />
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="hs_process.hstools.modify_meta_set">
<code class="sig-name descname"><span class="pre">modify_meta_set</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">meta_set</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hstools.modify_meta_set"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.hstools.modify_meta_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Modifies metadata &quot;set&quot; (i.e., string representation of a Python set;
common in .hdr files) by converting string to list, then adjusts the
value of an item by its index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>meta_set</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- the string representation of the metadata set</p></li>
<li><p><strong>idx</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- index to be modified; if <code class="docutils literal notranslate"><span class="pre">None</span></code>, the whole meta_set is
returned (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>value</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>, <code class="docutils literal notranslate"><span class="pre">int</span></code>, or <code class="docutils literal notranslate"><span class="pre">str</span></code>) -- value to replace at idx</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>set_str</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>): Modified metadata set string.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Retrieve the <em>&quot;map info&quot; set</em> from the metadata via
<code class="docutils literal notranslate"><span class="pre">hstools.get_meta_set</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">map_info_set</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;map info&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">map_info_set</span>
<span class="go">[&#39;UTM&#39;,</span>
<span class="go"> &#39;1.0&#39;,</span>
<span class="go"> &#39;1.0&#39;,</span>
<span class="go"> &#39;441357.287073&#39;,</span>
<span class="go"> &#39;4855944.7717699995&#39;,</span>
<span class="go"> &#39;0.04&#39;,</span>
<span class="go"> &#39;0.04&#39;,</span>
<span class="go"> &#39;15&#39;,</span>
<span class="go"> &#39;T&#39;,</span>
<span class="go"> &#39;WGS-84&#39;,</span>
<span class="go"> &#39;units  meters&#39;,</span>
<span class="go"> &#39;rotation  0.000&#39;]</span>
</pre></div>
</div>
<p>Modify the value at <em>index position 4</em> from <code class="docutils literal notranslate"><span class="pre">4855944.7717699995</span></code>
to <code class="docutils literal notranslate"><span class="pre">441300.2</span></code> using <code class="docutils literal notranslate"><span class="pre">hstools.modify_meta_set</span></code>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">modify_meta_set</span><span class="p">(</span><span class="n">map_info_set</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">441300.2</span><span class="p">)</span>
<span class="go">&#39;{UTM, 1.0, 1.0, 441357.287073, 441300.2, 0.04, 0.04, 15, T, WGS-84, units  meters, rotation  0.000}&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hs_process.hstools.plot_histogram">
<code class="sig-name descname"><span class="pre">plot_histogram</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname_fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percentile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">90</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#444444'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/utilities.html#hstools.plot_histogram"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.hstools.plot_histogram" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots a histogram with the percentile value labeled.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) -- The data array used to create the
histogram for; if <code class="docutils literal notranslate"><span class="pre">array</span></code> is masked, the masked pixels are
excluded from the histogram.</p></li>
<li><p><strong>fname_fig</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>, optional) -- The filename to save the figure to;
if <code class="docutils literal notranslate"><span class="pre">None</span></code>, the figure will not be saved (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>title</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>, optional) -- The plot title (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>xlabel</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>, optional) -- The x-axis label of the histogram
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>percentile</strong> (<code class="docutils literal notranslate"><span class="pre">scalar</span></code>, optional) -- The percentile to label and
illustrate on the histogram; if <code class="docutils literal notranslate"><span class="pre">percentile</span></code> = 90, the
band/spectral index value at the 90th percentile will be
labeled on the plot (default: 90; range: 0-100).</p></li>
<li><p><strong>bins</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, optional) -- Number of histogram bins (default: 50).</p></li>
<li><p><strong>fontsize</strong> (<code class="docutils literal notranslate"><span class="pre">scalar</span></code>) -- Font size of the axes labels. The title and
text annotations will be scaled relatively (default: 16).</p></li>
<li><p><strong>color</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>, optional) -- Color of the histogram columns (default:
&quot;#444444&quot;)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Figure object showing the histogram.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>fig (<code class="docutils literal notranslate"><span class="pre">matplotlib.figure</span></code>)</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
</pre></div>
</div>
<p>Retrieve the image band at <em>800 nm</em> using <code class="docutils literal notranslate"><span class="pre">hstools.get_band</span></code> and
<code class="docutils literal notranslate"><span class="pre">hsio.spyfile.open_memmap</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">band</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get_band</span><span class="p">(</span><span class="mi">800</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">open_memmap</span><span class="p">()[:,</span> <span class="p">:,</span> <span class="n">band</span><span class="p">]</span>
</pre></div>
</div>
<p>Create a masked array of all values below the <em>5th percentile</em>
via <code class="docutils literal notranslate"><span class="pre">hstools.mask_array</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">array_mask</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">mask_array</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span> <span class="n">percentile</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Visualize the histogram of the unmasked pixels (i.e., those greater
than the 5th percentile) using <code class="docutils literal notranslate"><span class="pre">hstools.plot_histogram</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Reflectance at 800 nm&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;Reflectance (%)&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">plot_histogram</span><span class="p">(</span><span class="n">array_mask</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">xlabel</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../img/utilities/plot_histogram_800nm.png" src="../img/utilities/plot_histogram_800nm.png" />
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="hs_process.segment">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hs_process.</span></code><code class="sig-name descname"><span class="pre">segment</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spyfile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/segment.html#segment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.segment" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for aiding in the segmentation and/or masking of image
data to filter out pixels that are of least interest.</p>
<dl class="py method">
<dt id="hs_process.segment.band_math_derivative">
<code class="sig-name descname"><span class="pre">band_math_derivative</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wl1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wl2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wl3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spyfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">list_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/segment.html#segment.band_math_derivative"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.segment.band_math_derivative" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates a derivative-type spectral index from two input bands
and/or wavelengths. Bands/wavelengths can be input as two individual
bands, two sets of bands (i.e., list of bands), or range of bands
(i.e., list of two bands indicating the lower and upper range).</p>
<dl class="simple">
<dt>Definition:</dt><dd><p>array_der = (<code class="docutils literal notranslate"><span class="pre">wl1</span></code> - <code class="docutils literal notranslate"><span class="pre">wl2</span></code>) / (<code class="docutils literal notranslate"><span class="pre">wl2</span></code> - <code class="docutils literal notranslate"><span class="pre">wl3</span></code>)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wl1</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the wavelength (or set of
wavelengths) to be used as the first parameter of the
derivative index; if <code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all
bands between two wavelength values by calculating the mean
pixel value across all bands in that range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>wl2</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the wavelength (or set of
wavelengths) to be used as the second parameter of the
derivative index; if <code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all
bands between two wavelength values by calculating the mean
pixel value across all bands in that range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>wl3</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the wavelength (or set of
wavelengths) to be used as the third parameter of the
derivative index; if <code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all
bands between two wavelength values by calculating the mean
pixel value across all bands in that range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>b1</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the band (or set of bands) to
be used as the first parameter of the derivative index;
if <code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all bands between two band
values by calculating the mean pixel value across all bands in
that range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>b2</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the band (or set of bands) to
be used as the second parameter of the derivative index; if
<code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all bands between two band values
by calculating the mean pixel value across all bands in that
range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>b3</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the band (or set of bands) to
be used as the third parameter of the derivative index; if
<code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all bands between two band values
by calculating the mean pixel value across all bands in that
range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object or <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) -- The datacube to
process; if <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code>, loads band information
from <code class="docutils literal notranslate"><span class="pre">self.spyfile</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>list_range</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- Whether bands/wavelengths passed as a list
is interpreted as a range of bands (<code class="docutils literal notranslate"><span class="pre">True</span></code>) or for each
individual band in the list (<code class="docutils literal notranslate"><span class="pre">False</span></code>). If <code class="docutils literal notranslate"><span class="pre">list_range</span></code> is
<code class="docutils literal notranslate"><span class="pre">True</span></code>, <code class="docutils literal notranslate"><span class="pre">b1</span></code>/<code class="docutils literal notranslate"><span class="pre">wl1</span></code> and <code class="docutils literal notranslate"><span class="pre">b2</span></code>/<code class="docutils literal notranslate"><span class="pre">wl2</span></code> should be lists
with two items, and all bands/wavelegths between the two values
will be used (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>).</p></li>
<li><p><strong>print_out</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- Whether to print out the actual bands and
wavelengths being used in the NDI calculation (default:
<code class="docutils literal notranslate"><span class="pre">True</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>2-element <code class="docutils literal notranslate"><span class="pre">tuple</span></code> containing</p>
<ul class="simple">
<li><p><strong>array_der</strong> (<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>): Derivative band math array.</p></li>
<li><p><strong>metadata</strong> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>): Modified metadata describing the
derivative array (<code class="docutils literal notranslate"><span class="pre">array_der</span></code>).</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load <code class="docutils literal notranslate"><span class="pre">hsio</span></code> and <code class="docutils literal notranslate"><span class="pre">segment</span></code> modules</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">segment</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_segment</span> <span class="o">=</span> <span class="n">segment</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
</pre></div>
</div>
<p>Calculate the MERIS Terrestrial Chlorophyll Index (MTCI; Dash and
Curran, 2004) via <code class="docutils literal notranslate"><span class="pre">segment.band_math_derivative</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">array_mtci</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">my_segment</span><span class="o">.</span><span class="n">band_math_derivative</span><span class="p">(</span><span class="n">wl1</span><span class="o">=</span><span class="mi">754</span><span class="p">,</span> <span class="n">wl2</span><span class="o">=</span><span class="mi">709</span><span class="p">,</span> <span class="n">wl3</span><span class="o">=</span><span class="mi">681</span><span class="p">,</span> <span class="n">spyfile</span><span class="o">=</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
<span class="go">Band 1: [176]  Band 2: [154]  Band 3: [141]</span>
<span class="go">Wavelength 1: [753.84]  Wavelength 2: [708.6784]  Wavelength 3: [681.992]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">array_mtci</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(617, 1300)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">array_mtci</span><span class="p">)</span>
<span class="go">9.401104</span>
</pre></div>
</div>
<p>Show MTCI image via <code class="docutils literal notranslate"><span class="pre">hsio.show_img</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">show_img</span><span class="p">(</span><span class="n">array_mtci</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../img/segment/mtci.png" src="../img/segment/mtci.png" />
</dd></dl>

<dl class="py method">
<dt id="hs_process.segment.band_math_mcari2">
<code class="sig-name descname"><span class="pre">band_math_mcari2</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wl1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wl2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wl3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spyfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">list_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/segment.html#segment.band_math_mcari2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.segment.band_math_mcari2" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the MCARI2 (Modified Chlorophyll Absorption Ratio Index
Improved; Haboudane et al., 2004) spectral index from three input bands
and/or wavelengths. Bands/wavelengths can be input as two individual
bands, two sets of bands (i.e., list of bands), or range of bands
(i.e., list of two bands indicating the lower and upper range).</p>
<dl class="simple">
<dt>Definition:</dt><dd><p>array_mcari2 = ((1.5 * (2.5 * (<code class="docutils literal notranslate"><span class="pre">wl1</span></code> - <code class="docutils literal notranslate"><span class="pre">wl2</span></code>) - 1.3 * (<code class="docutils literal notranslate"><span class="pre">wl1</span></code> - <code class="docutils literal notranslate"><span class="pre">wl3</span></code>))) / np.sqrt((2 * <code class="docutils literal notranslate"><span class="pre">wl1</span></code> + 1)**2 - (6 * <code class="docutils literal notranslate"><span class="pre">wl1</span></code> - 5 * np.sqrt(<code class="docutils literal notranslate"><span class="pre">wl2</span></code>)) - 0.5))</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wl1</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the wavelength (or set of
wavelengths) to be used as the first parameter of the
MCARI2 index; if <code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all
bands between two wavelength values by calculating the mean
pixel value across all bands in that range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>wl2</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the wavelength (or set of
wavelengths) to be used as the second parameter of the
MCARI2 index; if <code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all
bands between two wavelength values by calculating the mean
pixel value across all bands in that range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>wl3</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the wavelength (or set of
wavelengths) to be used as the third parameter of the
MCARI2 index; if <code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all
bands between two wavelength values by calculating the mean
pixel value across all bands in that range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>b1</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the band (or set of bands) to
be used as the first parameter of the MCARI2 index;
if <code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all bands between two band
values by calculating the mean pixel value across all bands in
that range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>b2</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the band (or set of bands) to
be used as the second parameter of the MCARI2 index; if
<code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all bands between two band values
by calculating the mean pixel value across all bands in that
range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>b3</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the band (or set of bands) to
be used as the third parameter of the MCARI2 index; if
<code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all bands between two band values
by calculating the mean pixel value across all bands in that
range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object or <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) -- The datacube to
process; if <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code>, loads band information
from <code class="docutils literal notranslate"><span class="pre">self.spyfile</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>list_range</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- Whether bands/wavelengths passed as a list
is interpreted as a range of bands (<code class="docutils literal notranslate"><span class="pre">True</span></code>) or for each
individual band in the list (<code class="docutils literal notranslate"><span class="pre">False</span></code>). If <code class="docutils literal notranslate"><span class="pre">list_range</span></code> is
<code class="docutils literal notranslate"><span class="pre">True</span></code>, <code class="docutils literal notranslate"><span class="pre">b1</span></code>/<code class="docutils literal notranslate"><span class="pre">wl1</span></code> and <code class="docutils literal notranslate"><span class="pre">b2</span></code>/<code class="docutils literal notranslate"><span class="pre">wl2</span></code> should be lists
with two items, and all bands/wavelegths between the two values
will be used (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>).</p></li>
<li><p><strong>print_out</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- Whether to print out the actual bands and
wavelengths being used in the NDI calculation (default:
<code class="docutils literal notranslate"><span class="pre">True</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>2-element <code class="docutils literal notranslate"><span class="pre">tuple</span></code> containing</p>
<ul class="simple">
<li><p><strong>array_mcari2</strong> (<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>): MCARI2 spectral index band
math array.</p></li>
<li><p><strong>metadata</strong> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>): Modified metadata describing the
MCARI2 index array (<code class="docutils literal notranslate"><span class="pre">array_mcari2</span></code>).</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load <code class="docutils literal notranslate"><span class="pre">hsio</span></code> and <code class="docutils literal notranslate"><span class="pre">segment</span></code> modules</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">segment</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_segment</span> <span class="o">=</span> <span class="n">segment</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
</pre></div>
</div>
<p>Calculate the MCARI2 spectral index (Haboudane et al., 2004) via
<code class="docutils literal notranslate"><span class="pre">segment.band_math_mcari2</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">array_mcari2</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">my_segment</span><span class="o">.</span><span class="n">band_math_mcari2</span><span class="p">(</span><span class="n">wl1</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">wl2</span><span class="o">=</span><span class="mi">670</span><span class="p">,</span> <span class="n">wl3</span><span class="o">=</span><span class="mi">550</span><span class="p">,</span> <span class="n">spyfile</span><span class="o">=</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
<span class="go">Band 1: [198]  Band 2: [135]  Band 3: [77]</span>
<span class="go">Wavelength 1: [799.0016]  Wavelength 2: [669.6752]  Wavelength 3: [550.6128]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">array_mcari2</span><span class="p">)</span>
<span class="go">0.57376945</span>
</pre></div>
</div>
<p>Show MCARI2 image via <code class="docutils literal notranslate"><span class="pre">hsio.show_img</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">show_img</span><span class="p">(</span><span class="n">array_mcari2</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../img/segment/mcari2.png" src="../img/segment/mcari2.png" />
</dd></dl>

<dl class="py method">
<dt id="hs_process.segment.band_math_ndi">
<code class="sig-name descname"><span class="pre">band_math_ndi</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wl1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wl2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spyfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">list_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/segment.html#segment.band_math_ndi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.segment.band_math_ndi" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates a normalized difference spectral index from two input bands
and/or wavelengths. Bands/wavelengths can be input as two individual
bands, two sets of bands (i.e., list of bands), or range of bands
(i.e., list of two bands indicating the lower and upper range).</p>
<dl class="simple">
<dt>Definition:</dt><dd><p>array_ndi = (<code class="docutils literal notranslate"><span class="pre">wl1</span></code> - <code class="docutils literal notranslate"><span class="pre">wl2</span></code>) / (<code class="docutils literal notranslate"><span class="pre">wl1</span></code> + <code class="docutils literal notranslate"><span class="pre">wl2</span></code>)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wl1</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the wavelength (or set of
wavelengths) to be used as the first parameter of the
normalized difference index; if <code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all
bands between two wavelength values by calculating the mean
pixel value across all bands in that range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>wl2</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the wavelength (or set of
wavelengths) to be used as the second parameter of the
normalized difference index; if <code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all
bands between two wavelength values by calculating the mean
pixel value across all bands in that range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>b1</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the band (or set of bands) to be
used as the first parameter of the normalized difference index;
if <code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all bands between two band values
by calculating the mean pixel value across all bands in that
range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>b2</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the band (or set of bands) to be
used as the second parameter of the normalized difference
index; if <code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all bands between two band
values by calculating the mean pixel value across all bands in
that range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object or <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) -- The datacube to
process; if <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code>, loads band information from
<code class="docutils literal notranslate"><span class="pre">self.spyfile</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>list_range</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- Whether bands/wavelengths passed as a list is
interpreted as a range of bands (<code class="docutils literal notranslate"><span class="pre">True</span></code>) or for each individual
band in the list (<code class="docutils literal notranslate"><span class="pre">False</span></code>). If <code class="docutils literal notranslate"><span class="pre">list_range</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>,
<code class="docutils literal notranslate"><span class="pre">b1</span></code>/<code class="docutils literal notranslate"><span class="pre">wl1</span></code> and <code class="docutils literal notranslate"><span class="pre">b2</span></code>/<code class="docutils literal notranslate"><span class="pre">wl2</span></code> should be lists with two items, and
all bands/wavelegths between the two values will be used
(default: <code class="docutils literal notranslate"><span class="pre">True</span></code>).</p></li>
<li><p><strong>print_out</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- Whether to print out the actual bands and
wavelengths being used in the NDI calculation (default:
<code class="docutils literal notranslate"><span class="pre">True</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>2-element <code class="docutils literal notranslate"><span class="pre">tuple</span></code> containing</p>
<ul class="simple">
<li><p><strong>array_ndi</strong> (<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>): Normalized difference band
math array.</p></li>
<li><p><strong>metadata</strong> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>): Modified metadata describing the
normalized difference array (<code class="docutils literal notranslate"><span class="pre">array_ndi</span></code>).</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load <code class="docutils literal notranslate"><span class="pre">hsio</span></code> and <code class="docutils literal notranslate"><span class="pre">segment</span></code> modules</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">segment</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_segment</span> <span class="o">=</span> <span class="n">segment</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
</pre></div>
</div>
<p>Calculate the Normalized difference vegetation index using 10 nm
bands centered at 800 nm and 680 nm via <code class="docutils literal notranslate"><span class="pre">segment.band_math_ndi</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">array_ndvi</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">my_segment</span><span class="o">.</span><span class="n">band_math_ndi</span><span class="p">(</span><span class="n">wl1</span><span class="o">=</span><span class="p">[</span><span class="mi">795</span><span class="p">,</span> <span class="mi">805</span><span class="p">],</span> <span class="n">wl2</span><span class="o">=</span><span class="p">[</span><span class="mi">675</span><span class="p">,</span> <span class="mi">685</span><span class="p">],</span> <span class="n">spyfile</span><span class="o">=</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
<span class="go">Effective NDI: (800 - 680) / 800 + 680)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">array_ndvi</span><span class="p">)</span>
<span class="go">0.8184888</span>
</pre></div>
</div>
<p>Show NDVI image via <code class="docutils literal notranslate"><span class="pre">hsio.show_img</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">show_img</span><span class="p">(</span><span class="n">array_ndvi</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../img/segment/ndvi.png" src="../img/segment/ndvi.png" />
</dd></dl>

<dl class="py method">
<dt id="hs_process.segment.band_math_ratio">
<code class="sig-name descname"><span class="pre">band_math_ratio</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wl1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wl2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spyfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">list_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/segment.html#segment.band_math_ratio"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.segment.band_math_ratio" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates a simple ratio spectral index from two input band and/or
wavelengths. Bands/wavelengths can be input as two individual bands,
two sets of bands (i.e., list of bands), or a range of bands (i.e.,
list of two bands indicating the lower and upper range).</p>
<dl class="simple">
<dt>Definition:</dt><dd><p>array_ratio = (<code class="docutils literal notranslate"><span class="pre">wl1</span></code>/<code class="docutils literal notranslate"><span class="pre">wl2</span></code>)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wl1</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the wavelength (or set of
wavelengths) to be used as the first parameter of the
ratio index; if <code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all
bands between two wavelength values by calculating the mean
pixel value across all bands in that range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>wl2</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the wavelength (or set of
wavelengths) to be used as the second parameter of the
ratio index; if <code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all
bands between two wavelength values by calculating the mean
pixel value across all bands in that range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>b1</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the band (or set of bands) to
be used as the first parameter (numerator) of the ratio index;
if <code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all bands between two band
values by calculating the mean pixel value across all bands in
that range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>b2</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the bands (or set of bands)
to be used as the second parameter (denominator) of the ratio
index; if <code class="docutils literal notranslate"><span class="pre">list</span></code>, then consolidates all bands between two
bands values by calculating the mean pixel value across all
bands in that range (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object or <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) -- The datacube to
process; if <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code>, loads band information
from <code class="docutils literal notranslate"><span class="pre">self.spyfile</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>list_range</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- Whether a band passed as a list is
interpreted as a range of bands (<code class="docutils literal notranslate"><span class="pre">True</span></code>) or for each
individual band in the list (<code class="docutils literal notranslate"><span class="pre">False</span></code>). If <code class="docutils literal notranslate"><span class="pre">list_range</span></code> is
<code class="docutils literal notranslate"><span class="pre">True</span></code>, <code class="docutils literal notranslate"><span class="pre">b1</span></code>/<code class="docutils literal notranslate"><span class="pre">wl1</span></code> and <code class="docutils literal notranslate"><span class="pre">b2</span></code>/<code class="docutils literal notranslate"><span class="pre">wl2</span></code> should be lists
with two items, and all bands/wavelegths between the two values
will be used (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>).</p></li>
<li><p><strong>print_out</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- Whether to print out the actual bands and
wavelengths being used in the NDI calculation (default:
<code class="docutils literal notranslate"><span class="pre">True</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>2-element <code class="docutils literal notranslate"><span class="pre">tuple</span></code> containing</p>
<ul class="simple">
<li><p><strong>array_ratio</strong> (<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>): Ratio band math array.</p></li>
<li><p><strong>metadata</strong> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>): Modified metadata describing the
ratio array (<code class="docutils literal notranslate"><span class="pre">array_ratio</span></code>).</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load <code class="docutils literal notranslate"><span class="pre">hsio</span></code> and <code class="docutils literal notranslate"><span class="pre">segment</span></code> modules</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">segment</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_segment</span> <span class="o">=</span> <span class="n">segment</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
</pre></div>
</div>
<p>Calculate a red/near-infrared band ratio using a range of bands
(i.e., mimicking a broadband sensor) via
<code class="docutils literal notranslate"><span class="pre">segment.band_math_ratio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">array_ratio</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">my_segment</span><span class="o">.</span><span class="n">band_math_ratio</span><span class="p">(</span><span class="n">wl1</span><span class="o">=</span><span class="p">[</span><span class="mi">630</span><span class="p">,</span> <span class="mi">690</span><span class="p">],</span> <span class="n">wl2</span><span class="o">=</span><span class="p">[</span><span class="mi">800</span><span class="p">,</span> <span class="mi">860</span><span class="p">],</span> <span class="n">list_range</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Effective band ratio: (659/830)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">array_ratio</span><span class="p">)</span>
<span class="go">0.10981177</span>
</pre></div>
</div>
<p>Notice that 29 spectral bands were consolidated (i.e., averaged) to
mimic a single broad band. We can take the mean of two bands by
changing <code class="docutils literal notranslate"><span class="pre">list_range</span></code> to <code class="docutils literal notranslate"><span class="pre">False</span></code>, and this slightly changes the
result.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">array_ratio</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">my_segment</span><span class="o">.</span><span class="n">band_math_ratio</span><span class="p">(</span><span class="n">wl1</span><span class="o">=</span><span class="p">[</span><span class="mi">630</span><span class="p">,</span> <span class="mi">690</span><span class="p">],</span> <span class="n">wl2</span><span class="o">=</span><span class="p">[</span><span class="mi">800</span><span class="p">,</span> <span class="mi">860</span><span class="p">],</span> <span class="n">list_range</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">Effective band ratio: (660/830)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">array_ratio</span><span class="p">)</span>
<span class="go">0.113607444</span>
</pre></div>
</div>
<p>Show the red/near-infrared ratio image via <code class="docutils literal notranslate"><span class="pre">hsio.show_img</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">show_img</span><span class="p">(</span><span class="n">array_ratio</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../img/segment/ratio_r_nir.png" src="../img/segment/ratio_r_nir.png" />
</dd></dl>

<dl class="py method">
<dt id="hs_process.segment.composite_band">
<code class="sig-name descname"><span class="pre">composite_band</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wl1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spyfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">list_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/segment.html#segment.composite_band"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.segment.composite_band" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates a composite band from a range of bands or wavelengths.
Bands/wavelengths can be input as individual bands, a set of bands
(i.e., list of bands), or a range of bands (i.e., list of two bands
indicating the lower and upper range).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wl1</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the wavelength (or set of
wavelengths) to consolidate; if <code class="docutils literal notranslate"><span class="pre">list</span></code>, then all wavelengths
between two wavelength values are consolidated by calculating
the mean pixel value across all wavelengths in that range
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>b1</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>) -- the band (or set of
bands) to consolidate; if <code class="docutils literal notranslate"><span class="pre">list</span></code>, then all bands
between two band values are consolidated by calculating
the mean pixel value across all bands in that range (default:
<code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object or <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) -- The datacube to
process; if <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code>, loads band information
from <code class="docutils literal notranslate"><span class="pre">self.spyfile</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>list_range</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- Whether a band passed as a list is
interpreted as a range of bands (<code class="docutils literal notranslate"><span class="pre">True</span></code>) or for each
individual band in the list (<code class="docutils literal notranslate"><span class="pre">False</span></code>). If <code class="docutils literal notranslate"><span class="pre">list_range</span></code> is
<code class="docutils literal notranslate"><span class="pre">True</span></code>, <code class="docutils literal notranslate"><span class="pre">b1</span></code>/<code class="docutils literal notranslate"><span class="pre">wl1</span></code> and <code class="docutils literal notranslate"><span class="pre">b2</span></code>/<code class="docutils literal notranslate"><span class="pre">wl2</span></code> should be lists
with two items, and all bands/wavelegths between the two values
will be used (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>).</p></li>
<li><p><strong>print_out</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) -- Whether to print out the actual bands and
wavelengths being used in the NDI calculation (default:
<code class="docutils literal notranslate"><span class="pre">True</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>2-element <code class="docutils literal notranslate"><span class="pre">tuple</span></code> containing</p>
<ul class="simple">
<li><p><strong>array_b1</strong> (<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>): Consolidated array.</p></li>
<li><p><strong>metadata</strong> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>): Modified metadata describing the
consolidated array (<code class="docutils literal notranslate"><span class="pre">array_b1</span></code>).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hs_process.segment.load_spyfile">
<code class="sig-name descname"><span class="pre">load_spyfile</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spyfile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/segment.html#segment.load_spyfile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.segment.load_spyfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a <code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> (Spectral Python object) for data access and/or
manipulation by the <code class="docutils literal notranslate"><span class="pre">hstools</span></code> class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object) -- The datacube being accessed and/or
manipulated.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load <code class="docutils literal notranslate"><span class="pre">hsio</span></code> and <code class="docutils literal notranslate"><span class="pre">segment</span></code> modules</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">segment</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_segment</span> <span class="o">=</span> <span class="n">segment</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
</pre></div>
</div>
<p>Load datacube  via <code class="docutils literal notranslate"><span class="pre">segment.load_spyfile</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">my_segment</span><span class="o">.</span><span class="n">load_spyfile</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_segment</span><span class="o">.</span><span class="n">spyfile</span>
<span class="go">Data Source:   &#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip&#39;</span>
<span class="go">    # Rows:            617</span>
<span class="go">    # Samples:        1300</span>
<span class="go">    # Bands:           240</span>
<span class="go">    Interleave:        BIP</span>
<span class="go">    Quantization:  32 bits</span>
<span class="go">    Data format:   float32</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="hs_process.spatial_mod">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hs_process.</span></code><code class="sig-name descname"><span class="pre">spatial_mod</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spyfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gdf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/spatial_mod.html#spatial_mod"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.spatial_mod" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for manipulating data within the spatial domain
(e.g., cropping a datacube by a geographical boundary).</p>
<dl class="py method">
<dt id="hs_process.spatial_mod.crop_many_gdf">
<code class="sig-name descname"><span class="pre">crop_many_gdf</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spyfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gdf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/spatial_mod.html#spatial_mod.crop_many_gdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.spatial_mod.crop_many_gdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Crops many plots from a single image by comparing the image to a
polygon file (<code class="docutils literal notranslate"><span class="pre">geopandas.GoeDataFrame</span></code>) that contains plot
information and geometry of plot boundaries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object, optional) -- The datacube to crop; if
<code class="docutils literal notranslate"><span class="pre">None</span></code>, loads datacube and band information from
<code class="docutils literal notranslate"><span class="pre">spatial_mod.spyfile</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>gdf</strong> (<code class="docutils literal notranslate"><span class="pre">geopandas.GeoDataFrame</span></code>, optional) -- the plot IDs and
polygon geometery of each of the plots; 'plot_id' must be used as
a column name to identify each of the plots, and should be an
integer; if <code class="docutils literal notranslate"><span class="pre">None</span></code>, loads geodataframe from
<code class="docutils literal notranslate"><span class="pre">spatial_mod.gdf</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>kwargs</strong> -- <p>Can be any of the keys in self.defaults.crop_defaults:
plot_id_ref (<code class="docutils literal notranslate"><span class="pre">int</span></code>, optional): the plot ID of the reference plot.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">plot_id_ref</span></code> is required if passing <code class="docutils literal notranslate"><span class="pre">pix_e_ul</span></code>,
<code class="docutils literal notranslate"><span class="pre">pix_n_ul</span></code>, or <code class="docutils literal notranslate"><span class="pre">n_plots</span></code> because it is used as the
reference point for any of the adjustments/modifications
dictated by said parameters. <code class="docutils literal notranslate"><span class="pre">plot_id_ref</span></code> must be present in
the <code class="docutils literal notranslate"><span class="pre">gdf</span></code>, and the extent of <code class="docutils literal notranslate"><span class="pre">plot_id_ref</span></code> must intersect
the extent of the datacube (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
</div></blockquote>
<dl class="simple">
<dt>pix_e_ul (<code class="docutils literal notranslate"><span class="pre">int</span></code>, optional): upper left pixel column (easting) of</dt><dd><p><code class="docutils literal notranslate"><span class="pre">plot_id_ref</span></code>; this is used to calculate the offset between
the GeoDataFrame geometry and the approximate image
georeference error (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
</dd>
<dt>pix_n_ul (<code class="docutils literal notranslate"><span class="pre">int</span></code>, optional): upper left pixel row (northing) of</dt><dd><p><code class="docutils literal notranslate"><span class="pre">plot_id_ref</span></code>; this is used to calculate the offset between
the GeoDataFrame geometry and the approximate image
georeference error (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
</dd>
<dt>crop_e_m (<code class="docutils literal notranslate"><span class="pre">float</span></code>, optional): length of each row (easting</dt><dd><p>direction) of the cropped image in map units (e.g., meters;
default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
</dd>
<dt>crop_n_m (<code class="docutils literal notranslate"><span class="pre">float</span></code>, optional): length of each column (northing</dt><dd><p>direction) of the cropped image in map units (e.g., meters;
default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p>
</dd>
<dt>crop_e_pix (<code class="docutils literal notranslate"><span class="pre">int</span></code>, optional): number of pixels in each row in the</dt><dd><p>cropped image (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
</dd>
<dt>crop_n_pix (<code class="docutils literal notranslate"><span class="pre">int</span></code>, optional): number of pixels in each column in</dt><dd><p>the cropped image (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
</dd>
<dt>buf_e_m (<code class="docutils literal notranslate"><span class="pre">float</span></code>, optional): The buffer distance in the easting</dt><dd><p>direction (in map units; e.g., meters) to be applied after
calculating the original crop area; the buffer is considered
after <code class="docutils literal notranslate"><span class="pre">crop_X_m</span></code> / <code class="docutils literal notranslate"><span class="pre">crop_X_pix</span></code>. A positive value will
reduce the size of <code class="docutils literal notranslate"><span class="pre">crop_X_m</span></code> / <code class="docutils literal notranslate"><span class="pre">crop_X_pix</span></code>, and a
negative value will increase it (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
</dd>
<dt>buf_n_m (<code class="docutils literal notranslate"><span class="pre">float</span></code>, optional): The buffer distance in the northing</dt><dd><p>direction (in map units; e.g., meters) to be applied after
calculating the original crop area; the buffer is considered
after <code class="docutils literal notranslate"><span class="pre">crop_X_m</span></code> / <code class="docutils literal notranslate"><span class="pre">crop_X_pix</span></code>. A positive value will
reduce the size of <code class="docutils literal notranslate"><span class="pre">crop_X_m</span></code> / <code class="docutils literal notranslate"><span class="pre">crop_X_pix</span></code>, and a
negative value will increase it (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
</dd>
<dt>buf_e_pix (<code class="docutils literal notranslate"><span class="pre">int</span></code>, optional): The buffer distance in the easting</dt><dd><p>direction (in pixel units) to be applied after calculating the
original crop area (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
</dd>
<dt>buf_n_pix (<code class="docutils literal notranslate"><span class="pre">int</span></code>, optional): The buffer distance in the northing</dt><dd><p>direction (in pixel units) to be applied after calculating the
original crop area (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
</dd>
<dt>gdf_shft_e_m (<code class="docutils literal notranslate"><span class="pre">float</span></code>): The distance to shift the cropped</dt><dd><p>datacube from the upper left/NW plot corner in the east
direction (negative value will shift to the west). Only
relevent when <code class="docutils literal notranslate"><span class="pre">gdf</span></code> is passed. This shift is applied after
the offset is applied from buf_X (default: 0.0).</p>
</dd>
<dt>gdf_shft_n_m (<code class="docutils literal notranslate"><span class="pre">float</span></code>): The distance to shift the cropped</dt><dd><p>datacube from the upper left/NW plot corner in the north
direction (negative value will shift to the south). Only
relevent when <code class="docutils literal notranslate"><span class="pre">gdf</span></code> is passed. This shift is applied after
the offset is applied from buf_X (default: 0.0).</p>
</dd>
<dt>gdf_shft_e_pix (<code class="docutils literal notranslate"><span class="pre">int</span></code>): The pixel units to shift the cropped</dt><dd><p>datacube from the upper left/NW plot corner in the east
direction (negative value will shift to the west). Only
relevent when <code class="docutils literal notranslate"><span class="pre">gdf</span></code> is passed. This shift is applied after
the offset is applied from buf_X (default: 0.0).</p>
</dd>
<dt>gdf_shft_n_pix (<code class="docutils literal notranslate"><span class="pre">int</span></code>): The pixel units to shift the cropped</dt><dd><p>datacube from the upper left/NW plot corner in the north
direction (negative value will shift to the south). Only
relevent when <code class="docutils literal notranslate"><span class="pre">gdf</span></code> is passed. This shift is applied after
the offset is applied from buf_X (default: 0.0).</p>
</dd>
<dt>n_plots (<code class="docutils literal notranslate"><span class="pre">int</span></code>, optional): number of plots to crop, starting with</dt><dd><p><code class="docutils literal notranslate"><span class="pre">plot_id_ref</span></code> and moving from West to East and North to
South. This can be used to limit the number of cropped plots
(default; <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>df_plots</strong> (<code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>) -- data for
which to crop each plot; includes 'plot_id_ref', 'pix_e_ul', and
'pix_n_ul' columns. This data can be passed to
<code class="docutils literal notranslate"><span class="pre">spatial_mod.crop_single</span></code> to perform the actual cropping.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <code class="docutils literal notranslate"><span class="pre">pix_e_ul</span></code> or <code class="docutils literal notranslate"><span class="pre">pix_n_ul</span></code> are passed, the pixel offset from
the northwest corner of <code class="docutils literal notranslate"><span class="pre">plot_id_ref</span></code> will be calculated. This
offset is then applied to all plots within the extent of the image
to systematically shift the actual upper left pixel locations for
each plot, effectively shifting the easting and/or northing
of the upper left pixel of the hyperspectral datacube to match that
of the <code class="docutils literal notranslate"><span class="pre">gdf</span></code>. If the shift should only apply to a select number
of plots, <code class="docutils literal notranslate"><span class="pre">n_plots</span></code> can be passed to restrict the number of plots
that are processed.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Either the pixel coordinate or the map unit coordinate should be
passed for <code class="docutils literal notranslate"><span class="pre">crop_X_Y</span></code> and <code class="docutils literal notranslate"><span class="pre">buf_X_Y</span></code> in each direction (i.e.,
easting and northing). Do not pass both.</p>
</div>
<p class="rubric">Example</p>
<p>Load the <code class="docutils literal notranslate"><span class="pre">hsio</span></code> and <code class="docutils literal notranslate"><span class="pre">spatial_mod</span></code> modules</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">spatial_mod</span>
</pre></div>
</div>
<p>Read datacube and spatial plot boundaries</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7_nohist-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fname_gdf</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\plot_bounds.geojson&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">fname_gdf</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_spatial_mod</span> <span class="o">=</span> <span class="n">spatial_mod</span><span class="p">(</span>
<span class="go">        io.spyfile, base_dir=io.base_dir, name_short=io.name_short,</span>
<span class="go">        name_long=io.name_long)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dir_out</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">base_dir</span><span class="p">,</span> <span class="s1">&#39;spatial_mod&#39;</span><span class="p">,</span> <span class="s1">&#39;crop_many_gdf&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">name_append</span> <span class="o">=</span> <span class="s1">&#39;-crop-many-gdf&#39;</span>
</pre></div>
</div>
<p>Get instructions on how plots should be cropped via
<code class="docutils literal notranslate"><span class="pre">spatial_mod.crop_many_gdf()</span></code>; note that a <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>
is returned with information describing how each plot should be
cropped.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df_plots</span> <span class="o">=</span> <span class="n">my_spatial_mod</span><span class="o">.</span><span class="n">crop_many_gdf</span><span class="p">(</span><span class="n">spyfile</span><span class="o">=</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">,</span> <span class="n">gdf</span><span class="o">=</span><span class="n">gdf</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_plots</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">    plot_id_ref  pix_e_ul  pix_n_ul  crop_e_pix  crop_n_pix</span>
<span class="go">0          1018       478         0         229          76</span>
<span class="go">1           918       707         0         229          76</span>
<span class="go">2           818       936         0         229          76</span>
<span class="go">3           718      1165         0         229          76</span>
<span class="go">4           618      1394         0         229          76</span>
<span class="gp">...</span>
</pre></div>
</div>
<p>Use the data from the first row of df_plots to crop a single plot
from the original image (uses spatial_mod.crop_single)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pix_e_ul</span><span class="o">=</span><span class="mi">113</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pix_n_ul</span><span class="o">=</span><span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crop_e_pix</span><span class="o">=</span><span class="mi">229</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crop_n_pix</span><span class="o">=</span><span class="mi">75</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_id_ref</span><span class="o">=</span><span class="mi">1018</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array_crop</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">my_spatial_mod</span><span class="o">.</span><span class="n">crop_single</span><span class="p">(</span>
<span class="go">        pix_e_ul=pix_e_ul, pix_n_ul=pix_n_ul, crop_e_pix=crop_e_pix, crop_n_pix=crop_n_pix,</span>
<span class="go">        spyfile=io.spyfile, plot_id_ref=plot_id_ref)</span>
</pre></div>
</div>
<p>Save the cropped datacube and geotiff to a new directory</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fname_out</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_out</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">name_short</span> <span class="o">+</span> <span class="s1">&#39;_plot_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mi">1018</span><span class="p">)</span> <span class="o">+</span> <span class="n">name_append</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">io</span><span class="o">.</span><span class="n">defaults</span><span class="o">.</span><span class="n">envi_write</span><span class="o">.</span><span class="n">interleave</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_out_tif</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_out</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">name_short</span> <span class="o">+</span> <span class="s1">&#39;_plot_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mi">1018</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.tif&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">write_cube</span><span class="p">(</span><span class="n">fname_out</span><span class="p">,</span> <span class="n">array_crop</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">write_tif</span><span class="p">(</span><span class="n">fname_out_tif</span><span class="p">,</span> <span class="n">spyfile</span><span class="o">=</span><span class="n">array_crop</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">)</span>
<span class="go">Saving F:\nigo0024\Documents\hs_process_demo\spatial_mod\crop_many_gdf\Wells_rep2_20180628_16h56m_pika_gige_7_plot_1018-crop-many-gdf.bip</span>
<span class="go">Either `projection_out` is `None` or `geotransform_out` is `None` (or both are). Retrieving projection and geotransform information by loading `hsio.fname_in` via GDAL. Be sure this is appropriate for the data you are trying to write.</span>
</pre></div>
</div>
<p>Using a for loop, use <code class="docutils literal notranslate"><span class="pre">spatial_mod.crop_single</span></code> and
<code class="docutils literal notranslate"><span class="pre">hsio.write_cube</span></code> to crop by plot and save cropped datacubes to
file</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df_plots</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">io</span><span class="o">.</span><span class="n">read_cube</span><span class="p">(</span><span class="n">fname_in</span><span class="p">,</span> <span class="n">name_long</span><span class="o">=</span><span class="n">io</span><span class="o">.</span><span class="n">name_long</span><span class="p">,</span>
<span class="go">                     name_plot=row[&#39;plot_id_ref&#39;],</span>
<span class="go">                     name_short=io.name_short)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">my_spatial_mod</span><span class="o">.</span><span class="n">load_spyfile</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">array_crop</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">my_spatial_mod</span><span class="o">.</span><span class="n">crop_single</span><span class="p">(</span>
<span class="go">                pix_e_ul=row[&#39;pix_e_ul&#39;], pix_n_ul=row[&#39;pix_n_ul&#39;],</span>
<span class="go">                crop_e_pix=row[&#39;crop_e_pix&#39;], crop_n_pix=row[&#39;crop_n_pix&#39;],</span>
<span class="go">                buf_e_m=2.0, buf_n_m=0.75,</span>
<span class="go">                plot_id_ref=row[&#39;plot_id_ref&#39;])</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">fname_out</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_out</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">name_short</span> <span class="o">+</span> <span class="s1">&#39;_plot_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;plot_id_ref&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="n">name_append</span> <span class="o">+</span> <span class="s1">&#39;.bip.hdr&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">fname_out_tif</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_out</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">name_short</span> <span class="o">+</span> <span class="s1">&#39;_plot_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;plot_id_ref&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;.tif&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">io</span><span class="o">.</span><span class="n">write_cube</span><span class="p">(</span><span class="n">fname_out</span><span class="p">,</span> <span class="n">array_crop</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># force=True to overwrite the plot_1018 image</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">io</span><span class="o">.</span><span class="n">write_tif</span><span class="p">(</span><span class="n">fname_out_tif</span><span class="p">,</span> <span class="n">spyfile</span><span class="o">=</span><span class="n">array_crop</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">)</span>
<span class="go">Saving F:\nigo0024\Documents\hs_process_demo\crop_many_gdf\Wells_rep2_20180628_16h56m_pika_gige_7_plot_1018.bip</span>
<span class="go">Saving F:\nigo0024\Documents\hs_process_demo\crop_many_gdf\Wells_rep2_20180628_16h56m_pika_gige_7_plot_918.bip</span>
<span class="go">Saving F:\nigo0024\Documents\hs_process_demo\crop_many_gdf\Wells_rep2_20180628_16h56m_pika_gige_7_plot_818.bip</span>
<span class="go">Saving F:\nigo0024\Documents\hs_process_demo\crop_many_gdf\Wells_rep2_20180628_16h56m_pika_gige_7_plot_718.bip</span>
<span class="go">Saving F:\nigo0024\Documents\hs_process_demo\crop_many_gdf\Wells_rep2_20180628_16h56m_pika_gige_7_plot_618.bip</span>
<span class="go">Saving F:\nigo0024\Documents\hs_process_demo\crop_many_gdf\Wells_rep2_20180628_16h56m_pika_gige_7_plot_1017.bip</span>
<span class="go">Saving F:\nigo0024\Documents\hs_process_demo\crop_many_gdf\Wells_rep2_20180628_16h56m_pika_gige_7_plot_917.bip</span>
<span class="go">Saving F:\nigo0024\Documents\hs_process_demo\crop_many_gdf\Wells_rep2_20180628_16h56m_pika_gige_7_plot_817.bip</span>
<span class="go">Saving F:\nigo0024\Documents\hs_process_demo\crop_many_gdf\Wells_rep2_20180628_16h56m_pika_gige_7_plot_717.bip</span>
<span class="go">Saving F:\nigo0024\Documents\hs_process_demo\crop_many_gdf\Wells_rep2_20180628_16h56m_pika_gige_7_plot_617.bip</span>
<span class="gp">...</span>
</pre></div>
</div>
<p>Open cropped geotiff images in QGIS to visualize the extent of the
cropped images compared to the original datacube and the plot
boundaries (the full extent image is darkened and displayed in the
background:</p>
<img alt="../img/spatial_mod/crop_many_gdf_qgis.png" src="../img/spatial_mod/crop_many_gdf_qgis.png" />
</dd></dl>

<dl class="py method">
<dt id="hs_process.spatial_mod.crop_single">
<code class="sig-name descname"><span class="pre">crop_single</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pix_e_ul</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pix_n_ul</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop_e_pix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop_n_pix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop_e_m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop_n_m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buf_e_pix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buf_n_pix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buf_e_m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buf_n_m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spyfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_id_ref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gdf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gdf_shft_e_pix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gdf_shft_n_pix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gdf_shft_e_m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gdf_shft_n_m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_append</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spatial-crop-single'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/spatial_mod.html#spatial_mod.crop_single"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.spatial_mod.crop_single" title="Permalink to this definition">¶</a></dt>
<dd><p>Crops a single plot from an image. If <code class="docutils literal notranslate"><span class="pre">plot_id_ref</span></code> and <code class="docutils literal notranslate"><span class="pre">gdf</span></code> are
explicitly passed (i.e., they will not be loaded from <code class="docutils literal notranslate"><span class="pre">spatial_mod</span></code>
class), the &quot;map info&quot; tag in the metadata will be adjusted to center
the cropped area within the appropriate plot geometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pix_e_ul</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, optional) -- upper left pixel column (easting) to
begin cropping (default: 0).</p></li>
<li><p><strong>pix_n_ul</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, optional) -- upper left pixel row (northing) to
begin cropping (default: 0).</p></li>
<li><p><strong>crop_e_m</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>, optional) -- length of each row (easting
direction) of the cropped image in map units (e.g., meters;
default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>crop_n_m</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>, optional) -- length of each column (northing
direction) of the cropped image in map units (e.g., meters;
default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
<li><p><strong>crop_e_pix</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, optional) -- number of pixels in each row in the
cropped image (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>crop_n_pix</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, optional) -- number of pixels in each column in
the cropped image (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>buf_e_m</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>, optional) -- The buffer distance in the easting
direction (in map units; e.g., meters) to be applied after
calculating the original crop area; the buffer is considered
after <code class="docutils literal notranslate"><span class="pre">crop_X_m</span></code> / <code class="docutils literal notranslate"><span class="pre">crop_X_pix</span></code>. A positive value will
reduce the size of <code class="docutils literal notranslate"><span class="pre">crop_X_m</span></code> / <code class="docutils literal notranslate"><span class="pre">crop_X_pix</span></code>, and a
negative value will increase it (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>buf_n_m</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>, optional) -- The buffer distance in the northing
direction (in map units; e.g., meters) to be applied after
calculating the original crop area; the buffer is considered
after <code class="docutils literal notranslate"><span class="pre">crop_X_m</span></code> / <code class="docutils literal notranslate"><span class="pre">crop_X_pix</span></code>. A positive value will
reduce the size of <code class="docutils literal notranslate"><span class="pre">crop_X_m</span></code> / <code class="docutils literal notranslate"><span class="pre">crop_X_pix</span></code>, and a
negative value will increase it (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>buf_e_pix</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, optional) -- The buffer distance in the easting
direction (in pixel units) to be applied after calculating the
original crop area (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>buf_n_pix</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, optional) -- The buffer distance in the northing
direction (in pixel units) to be applied after calculating the
original crop area (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object or <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) -- The datacube to
crop; if <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code>, loads band information from
<code class="docutils literal notranslate"><span class="pre">self.spyfile</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>plot_id_ref</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- the plot ID of the area to be cropped
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>gdf</strong> (<code class="docutils literal notranslate"><span class="pre">geopandas.GeoDataFrame</span></code>) -- the plot names and polygon
geometery of each of the plots; 'plot_id' must be used as a column
name to identify each of the plots, and should be an integer.</p></li>
<li><p><strong>gdf_shft_e_m</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>) -- The distance to shift the cropped
datacube from the upper left/NW plot corner in the east
direction (negative value will shift to the west). Only
relevent when <code class="docutils literal notranslate"><span class="pre">gdf</span></code> is passed. This shift is applied after
the offset is applied from buf_X (default: 0.0).</p></li>
<li><p><strong>gdf_shft_n_m</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>) -- The distance to shift the cropped
datacube from the upper left/NW plot corner in the north
direction (negative value will shift to the south). Only
relevent when <code class="docutils literal notranslate"><span class="pre">gdf</span></code> is passed. This shift is applied after
the offset is applied from buf_X (default: 0.0).</p></li>
<li><p><strong>gdf_shft_e_pix</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- The pixel units to shift the cropped
datacube from the upper left/NW plot corner in the east
direction (negative value will shift to the west). Only
relevent when <code class="docutils literal notranslate"><span class="pre">gdf</span></code> is passed. This shift is applied after
the offset is applied from buf_X (default: 0.0).</p></li>
<li><p><strong>gdf_shft_n_pix</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- The pixel units to shift the cropped
datacube from the upper left/NW plot corner in the north
direction (negative value will shift to the south). Only
relevent when <code class="docutils literal notranslate"><span class="pre">gdf</span></code> is passed. This shift is applied after
the offset is applied from buf_X (default: 0.0).</p></li>
<li><p><strong>name_append</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- NOT YET SUPPORTED; name to append to the
filename (default: 'spatial-crop-single').</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>2-element <code class="docutils literal notranslate"><span class="pre">tuple</span></code> containing</p>
<ul class="simple">
<li><p><strong>array_crop</strong> (<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>): Cropped datacube.</p></li>
<li><p><strong>metadata</strong> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>): Modified metadata describing the cropped
hyperspectral datacube (<code class="docutils literal notranslate"><span class="pre">array_crop</span></code>).</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize the <code class="docutils literal notranslate"><span class="pre">hsio</span></code> and <code class="docutils literal notranslate"><span class="pre">spatial_mod</span></code> modules</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">spatial_mod</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_spatial_mod</span> <span class="o">=</span> <span class="n">spatial_mod</span><span class="p">(</span>
<span class="go">        io.spyfile, base_dir=io.base_dir, name_short=io.name_short,</span>
<span class="go">        name_long=io.name_long)</span>
</pre></div>
</div>
<p>Crop an area with a width (easting) <em>200 pixels</em> and a height
(northing) of <em>50 pixels</em>, with a northwest/upper left origin at
the <em>342nd column</em> (easting) and <em>75th row</em> (northing).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pix_e_ul</span> <span class="o">=</span> <span class="mi">342</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pix_n_ul</span> <span class="o">=</span> <span class="mi">75</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array_crop</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">my_spatial_mod</span><span class="o">.</span><span class="n">crop_single</span><span class="p">(</span><span class="n">pix_e_ul</span><span class="p">,</span> <span class="n">pix_n_ul</span><span class="p">,</span> <span class="n">crop_e_pix</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">crop_n_pix</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
<p>Save as a geotiff using <code class="docutils literal notranslate"><span class="pre">io.write_tif</span></code>, then load into QGIS to
visualize.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fname_tif</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\spatial_mod\crop_single\crop_single.tif&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">write_tif</span><span class="p">(</span><span class="n">fname_tif</span><span class="p">,</span> <span class="n">array_crop</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">)</span>
<span class="go">Either `projection_out` is `None` or `geotransform_out` is `None` (or both are). Retrieving projection and geotransform information by loading `hsio.fname_in` via GDAL. Be sure this is appropriate for the data you are trying to write.</span>
</pre></div>
</div>
<p>Open cropped geotiff image in QGIS to visualize the extent of the
cropped image compared to the original datacube and the plot
boundaries (the full extent image is darkened and displayed in the
background):</p>
<img alt="../img/spatial_mod/crop_single_qgis.png" src="../img/spatial_mod/crop_single_qgis.png" />
</dd></dl>

<dl class="py method">
<dt id="hs_process.spatial_mod.load_spyfile">
<code class="sig-name descname"><span class="pre">load_spyfile</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spyfile</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/spatial_mod.html#spatial_mod.load_spyfile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.spatial_mod.load_spyfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a <code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> (Spectral Python object) for data access and/or
manipulation by the <code class="docutils literal notranslate"><span class="pre">hstools</span></code> class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object) -- The datacube being accessed and/or
manipulated.</p></li>
<li><p><strong>base_dir</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- to be used by the plot gdf attribute data.</p></li>
<li><p><strong>name_short</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- to be used by the plot gdf attribute data.</p></li>
<li><p><strong>name_long</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) -- to be used by the plot gdf attribute data.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize the <code class="docutils literal notranslate"><span class="pre">hsio</span></code> and <code class="docutils literal notranslate"><span class="pre">spatial_mod</span></code> modules</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">spatial_mod</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_spatial_mod</span> <span class="o">=</span> <span class="n">spatial_mod</span><span class="p">(</span>
<span class="go">        io.spyfile, base_dir=io.base_dir, name_short=io.name_short,</span>
<span class="go">        name_long=io.name_long)</span>
</pre></div>
</div>
<p>Load datacube using <code class="docutils literal notranslate"><span class="pre">spatial_mod.load_spyfile</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">my_spatial_mod</span><span class="o">.</span><span class="n">load_spyfile</span><span class="p">(</span>
<span class="go">        io.spyfile, base_dir=io.base_dir, name_short=io.name_short,</span>
<span class="go">        name_long=io.name_long)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_spatial_mod</span><span class="o">.</span><span class="n">spyfile</span>
<span class="go">Data Source:   &#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip&#39;</span>
<span class="go">    # Rows:            617</span>
<span class="go">    # Samples:        1300</span>
<span class="go">    # Bands:           240</span>
<span class="go">    Interleave:        BIP</span>
<span class="go">    Quantization:  32 bits</span>
<span class="go">    Data format:   float32</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="hs_process.spec_mod">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hs_process.</span></code><code class="sig-name descname"><span class="pre">spec_mod</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spyfile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/spec_mod.html#spec_mod"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.spec_mod" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for manipulating data within the spectral domain, which
is usually pixel-based.</p>
<dl class="py method">
<dt id="hs_process.spec_mod.load_spyfile">
<code class="sig-name descname"><span class="pre">load_spyfile</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spyfile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/spec_mod.html#spec_mod.load_spyfile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.spec_mod.load_spyfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a <code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> (Spectral Python object) for data access and/or
manipulation by the <code class="docutils literal notranslate"><span class="pre">hstools</span></code> class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object) -- The datacube being accessed and/or
manipulated.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize the <code class="docutils literal notranslate"><span class="pre">hsio</span></code> and <code class="docutils literal notranslate"><span class="pre">spec_mod</span></code> modules</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">spec_mod</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_in</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">(</span><span class="n">fname_in</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_spec_mod</span> <span class="o">=</span> <span class="n">spec_mod</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
</pre></div>
</div>
<p>Load datacube</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">my_spec_mod</span><span class="o">.</span><span class="n">load_spyfile</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_spec_mod</span><span class="o">.</span><span class="n">spyfile</span>
<span class="go">Data Source:   &#39;F:\nigo0024\Documents\hs_process_demo\Wells_rep2_20180628_16h56m_pika_gige_7-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip&#39;</span>
<span class="go">    # Rows:            617</span>
<span class="go">    # Samples:        1300</span>
<span class="go">    # Bands:           240</span>
<span class="go">    Interleave:        BIP</span>
<span class="go">    Quantization:  32 bits</span>
<span class="go">    Data format:   float32</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hs_process.spec_mod.spec_derivative">
<code class="sig-name descname"><span class="pre">spec_derivative</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spyfile_spec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/spec_mod.html#spec_mod.spec_derivative"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.spec_mod.spec_derivative" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the numeric derivative spectra from spyfile_spec.</p>
<p>The derivavative spectra is calculated as the slope (rise over run) of
the input spectra, and is normalized by the wavelength unit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spyfile_spec</strong> -- The spectral spyfile object to calculate the
derivative for.</p></li>
<li><p><strong>order</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- The order of the derivative (default: 1).</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">spec_mod</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_hdr_spec</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;Wells_rep2_20180628_16h56m_pika_gige_7_plot_611-cube-to-spec-mean.spec.hdr&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">read_spec</span><span class="p">(</span><span class="n">fname_hdr_spec</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_spec_mod</span> <span class="o">=</span> <span class="n">spec_mod</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile_spec</span><span class="p">)</span>
</pre></div>
</div>
<p>Calculate the numeric derivative.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">spec_dydx</span><span class="p">,</span> <span class="n">metadata_dydx</span> <span class="o">=</span> <span class="n">my_spec_mod</span><span class="o">.</span><span class="n">spec_derivative</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">write_spec</span><span class="p">(</span><span class="s1">&#39;spec_derivative_order-1.spec.hdr&#39;</span><span class="p">,</span> <span class="n">spec_dydx</span><span class="p">,</span> <span class="n">df_std</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata_dydx</span><span class="p">)</span>
</pre></div>
</div>
<p>Plot the numeric derivative spectra and compare against the original spectra.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;ticks&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wl_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">metadata_dydx</span><span class="p">[</span><span class="s1">&#39;wavelength&#39;</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_ref</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">spyfile_spec</span><span class="o">.</span><span class="n">open_memmap</span><span class="p">()[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,:]</span><span class="o">*</span><span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">wl_x</span><span class="p">,</span> <span class="n">y_ref</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">wl_x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">wl_x</span><span class="p">,</span> <span class="n">spec_dydx</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,:]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavelength (nm)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Reflectance (%)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Reflectance derivative (%)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;API Example: `hstools.spec_derivative`&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hs_process.spec_mod.spectral_clip">
<code class="sig-name descname"><span class="pre">spectral_clip</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wl_bands</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[[0,</span> <span class="pre">420],</span> <span class="pre">[760,</span> <span class="pre">776],</span> <span class="pre">[813,</span> <span class="pre">827],</span> <span class="pre">[880,</span> <span class="pre">1000]]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spyfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/spec_mod.html#spec_mod.spectral_clip"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.spec_mod.spectral_clip" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes/clips designated wavelength bands from the hyperspectral
datacube.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wl_bands</strong> (<code class="docutils literal notranslate"><span class="pre">list</span></code> or <code class="docutils literal notranslate"><span class="pre">list</span></code> of <code class="docutils literal notranslate"><span class="pre">lists</span></code>) -- minimum and maximum
wavelenths to clip from image; if multiple groups of
wavelengths should be cut, this should be a list of lists. For
example, wl_bands=[760, 776] will clip all bands greater than
760.0 nm and less than 776.0 nm;
wl_bands = [[0, 420], [760, 776], [813, 827], [880, 1000]]
will clip all band less than 420.0 nm, bands greater than 760.0
nm and less than 776.0 nm, bands greater than 813.0 nm and less
than 827.0 nm, and bands greater than 880 nm (default).</p></li>
<li><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object or <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) -- The data cube to
clip; if <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code>, loads band information
from <code class="docutils literal notranslate"><span class="pre">spec_mod.spyfile</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>2-element <code class="docutils literal notranslate"><span class="pre">tuple</span></code> containing</p>
<ul class="simple">
<li><p><strong>array_clip</strong> (<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>): Clipped datacube.</p></li>
<li><p><strong>metadata</strong> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>): Modified metadata describing the clipped
hyperspectral datacube (<code class="docutils literal notranslate"><span class="pre">array_clip</span></code>).</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code> and <code class="docutils literal notranslate"><span class="pre">spec_mod</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">spec_mod</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_hdr</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">read_cube</span><span class="p">(</span><span class="n">fname_hdr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_spec_mod</span> <span class="o">=</span> <span class="n">spec_mod</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
</pre></div>
</div>
<p>Using <code class="docutils literal notranslate"><span class="pre">spec_mod.spectral_clip</span></code>, clip all spectral bands below
<em>420 nm</em> and above <em>880 nm</em>, as well as the bands near the oxygen
absorption (i.e., <em>760-776 nm</em>) and water absorption
(i.e., <em>813-827 nm</em>) regions.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">array_clip</span><span class="p">,</span> <span class="n">metadata_clip</span> <span class="o">=</span> <span class="n">my_spec_mod</span><span class="o">.</span><span class="n">spectral_clip</span><span class="p">(</span>
<span class="go">        wl_bands=[[0, 420], [760, 776], [813, 827], [880, 1000]])</span>
</pre></div>
</div>
<p>Plot the spectra of the unclippe hyperspectral image and compare to that of the clipped image for a single pixel.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ast</span> <span class="kn">import</span> <span class="n">literal_eval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spy_hs</span> <span class="o">=</span> <span class="n">my_spec_mod</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">open_memmap</span><span class="p">()</span>  <span class="c1"># datacube before smoothing</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">meta_bands</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">meta_bands</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">meta_bands_clip</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">literal_eval</span><span class="p">(</span><span class="n">metadata_clip</span><span class="p">[</span><span class="s1">&#39;wavelength&#39;</span><span class="p">])])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">spy_hs</span><span class="p">[</span><span class="mi">200</span><span class="p">][</span><span class="mi">800</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Before spectral clipping&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands_clip</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">array_clip</span><span class="p">[</span><span class="mi">200</span><span class="p">][</span><span class="mi">800</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;After spectral clipping&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavelength (nm)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Reflectance (%)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;API Example: `spec_mod.spectral_clip`&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../img/spec_mod/spectral_clip.png" src="../img/spec_mod/spectral_clip.png" />
</dd></dl>

<dl class="py method">
<dt id="hs_process.spec_mod.spectral_mimic">
<code class="sig-name descname"><span class="pre">spectral_mimic</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sensor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sentinel-2a'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_band_response</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_wl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wl_nm'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_wl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'peak'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spyfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/spec_mod.html#spec_mod.spectral_mimic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.spec_mod.spectral_mimic" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Mimics the response of a multispectral sensor based on transmissivity
of sensor bands across a range of wavelength values by calculating its
weighted average response and interpolating the hyperspectral response.</p>
<dl>
<dt>Parameters:</dt><dd><dl class="simple">
<dt>sensor (<code class="docutils literal notranslate"><span class="pre">str</span></code>): Should be one of</dt><dd><p>[&quot;sentera_6x&quot;, &quot;micasense_rededge_3&quot;, &quot;sentinel-2a&quot;,
&quot;sentinel-2b&quot;, &quot;custom&quot;]; if &quot;custom&quot;, <code class="docutils literal notranslate"><span class="pre">df_band_response</span></code>
and <code class="docutils literal notranslate"><span class="pre">col_wl</span></code> must be passed.</p>
</dd>
<dt>df_band_response (<code class="docutils literal notranslate"><span class="pre">pd.DataFrame</span></code>): A DataFrame that contains the</dt><dd><p>transmissivity (%) for each sensor band (as columns) mapped to
the continuous wavelength values (as rows). Required if
<code class="docutils literal notranslate"><span class="pre">sensor</span></code> is  &quot;custom&quot;, ignored otherwise.</p>
</dd>
<dt>col_wl (<code class="docutils literal notranslate"><span class="pre">str</span></code>): The column of <code class="docutils literal notranslate"><span class="pre">df_band_response</span></code> denoting the</dt><dd><p>wavlengths (default: 'wl_nm').</p>
</dd>
<dt>center_wl (<code class="docutils literal notranslate"><span class="pre">str</span></code>): Indicates how the center wavelength of each</dt><dd><p>band is determined. If <code class="docutils literal notranslate"><span class="pre">center_wl</span></code> is &quot;peak&quot;, the point at
which transmissivity is at its maximum is used as the center
wavelength. If <code class="docutils literal notranslate"><span class="pre">center_wl</span></code> is &quot;weighted&quot;, the weighted
average is used to compute the center wavelength. Must be one
of [&quot;peak&quot;, &quot;weighted&quot;] (<code class="docutils literal notranslate"><span class="pre">default:</span> <span class="pre">&quot;peak&quot;</span></code>).</p>
</dd>
<dt>spyfile (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object): The datacube being accessed and/or</dt><dd><p>manipulated.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>2-element <code class="docutils literal notranslate"><span class="pre">tuple</span></code> containing</p>
<ul class="simple">
<li><p><strong>array_multi</strong> (<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>): Mimicked datacube.</p></li>
<li><p><strong>metadata</strong> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>): Modified metadata describing the
mimicked spectral array (<code class="docutils literal notranslate"><span class="pre">array_multi</span></code>).</p></li>
</ul>
</dd>
<dt>Example:</dt><dd><p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code> and <code class="docutils literal notranslate"><span class="pre">spec_mod</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">spec_mod</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_hdr</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data_dir2</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;G:\BBE\AGROBOT\Shared Work\hs_process_results\data</span>
</pre></div>
</div>
</dd>
</dl>
</div></blockquote>
<dl>
<dt>ef_closest_panelcrop_plot'</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fname_hdr</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir2</span><span class="p">,</span> <span class="s1">&#39;study_aerffield_date_20190708_plot_5110-crop-plot.bip.hdr&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">open_memmap</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">read_cube</span><span class="p">(</span><span class="n">fname_hdr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_spec_mod</span> <span class="o">=</span> <span class="n">spec_mod</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
</pre></div>
</div>
<p>Use spec_mod.spectral_mimic to mimic the Sentinel-2A spectral
response function.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">array_s2a</span><span class="p">,</span> <span class="n">metadata_s2a</span> <span class="o">=</span> <span class="n">my_spec_mod</span><span class="o">.</span><span class="n">spectral_mimic</span><span class="p">(</span><span class="n">sensor</span><span class="o">=</span><span class="s1">&#39;sentinel-2a&#39;</span><span class="p">,</span> <span class="n">center_wl</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Plot the mean spectral response of the hyperspectral image to that
of the mimicked Sentinel-2A image bands (mean calculated across the
entire image).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ast</span> <span class="kn">import</span> <span class="n">literal_eval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spy_hs</span> <span class="o">=</span> <span class="n">my_spec_mod</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">open_memmap</span><span class="p">()</span>  <span class="c1"># datacube before smoothing</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">meta_bands</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">meta_bands</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">meta_bands_s2a</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">literal_eval</span><span class="p">(</span><span class="n">metadata_s2a</span><span class="p">[</span><span class="s1">&#39;wavelength&#39;</span><span class="p">])])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">spy_hs</span><span class="p">[</span><span class="mi">200</span><span class="p">][</span><span class="mi">800</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Hyperspectral (Pika II)&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands_s2a</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">array_s2a</span><span class="p">[</span><span class="mi">200</span><span class="p">][</span><span class="mi">800</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sentinel-2A &quot;mimic&quot;&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavelength (nm)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Reflectance (%)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;API Example: `spec_mod.spectral_mimic`&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../img/spec_mod/spectral_mimic_sentinel-2a.png" src="../img/spec_mod/spectral_mimic_sentinel-2a.png" />
<p>Use spec_mod.spectral_mimic to mimic the Sentera 6x spectral configuration and compare to both hyperspectral and Sentinel-2A.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">array_6x</span><span class="p">,</span> <span class="n">metadata_6x</span> <span class="o">=</span> <span class="n">my_spec_mod</span><span class="o">.</span><span class="n">spectral_mimic</span><span class="p">(</span><span class="n">sensor</span><span class="o">=</span><span class="s1">&#39;sentera_6x&#39;</span><span class="p">,</span> <span class="n">center_wl</span><span class="o">=</span><span class="s1">&#39;peak&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">meta_bands_6x</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">literal_eval</span><span class="p">(</span><span class="n">metadata_6x</span><span class="p">[</span><span class="s1">&#39;wavelength&#39;</span><span class="p">])])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">spy_hs</span><span class="p">[</span><span class="mi">200</span><span class="p">][</span><span class="mi">800</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Hyperspectral (Pika II)&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands_s2a</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">array_s2a</span><span class="p">[</span><span class="mi">200</span><span class="p">][</span><span class="mi">800</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sentinel-2A &quot;mimic&quot;&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands_6x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">array_6x</span><span class="p">[</span><span class="mi">200</span><span class="p">][</span><span class="mi">800</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sentera 6X &quot;mimic&quot;&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavelength (nm)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Reflectance (%)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;API Example: `spec_mod.spectral_mimic`&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../img/spec_mod/spectral_mimic_6x.png" src="../img/spec_mod/spectral_mimic_6x.png" />
<p>And finally, mimic the Micasense RedEdge-MX and compare to hyperspectral, Sentinel-2A, and Sentera 6X.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">array_re3</span><span class="p">,</span> <span class="n">metadata_re3</span> <span class="o">=</span> <span class="n">my_spec_mod</span><span class="o">.</span><span class="n">spectral_mimic</span><span class="p">(</span><span class="n">sensor</span><span class="o">=</span><span class="s1">&#39;micasense_rededge_3&#39;</span><span class="p">,</span> <span class="n">center_wl</span><span class="o">=</span><span class="s1">&#39;peak&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">meta_bands_re3</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">literal_eval</span><span class="p">(</span><span class="n">metadata_re3</span><span class="p">[</span><span class="s1">&#39;wavelength&#39;</span><span class="p">])])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">spy_hs</span><span class="p">[</span><span class="mi">200</span><span class="p">][</span><span class="mi">800</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Hyperspectral (Pika II)&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands_s2a</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">array_s2a</span><span class="p">[</span><span class="mi">200</span><span class="p">][</span><span class="mi">800</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sentinel-2A &quot;mimic&quot;&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands_6x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">array_6x</span><span class="p">[</span><span class="mi">200</span><span class="p">][</span><span class="mi">800</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sentera 6X &quot;mimic&quot;&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands_re3</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">array_re3</span><span class="p">[</span><span class="mi">200</span><span class="p">][</span><span class="mi">800</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Micasense RedEdge 3 &quot;mimic&quot;&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavelength (nm)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Reflectance (%)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;API Example: `spec_mod.spectral_mimic`&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../img/spec_mod/spectral_mimic_re.png" src="../img/spec_mod/spectral_mimic_re.png" />
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hs_process.spec_mod.spectral_resample">
<code class="sig-name descname"><span class="pre">spectral_resample</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bandwidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins_n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spyfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/spec_mod.html#spec_mod.spectral_resample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.spec_mod.spectral_resample" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Performs pixel-wise resampling of spectral bands via binning</dt><dd><dl class="simple">
<dt>(calculates the mean across all bands within each <code class="docutils literal notranslate"><span class="pre">bandwidth</span></code></dt><dd><p>region for each image pixel).</p>
</dd>
</dl>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bandwidth</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code> or <code class="docutils literal notranslate"><span class="pre">int</span></code>) -- The bandwidth of the bands
after spectral resampling is complete (units should be
consistent with that of the .hdr file). Setting <code class="docutils literal notranslate"><span class="pre">bandwidth</span></code>
to 10 will consolidate bands that fall within every 10 nm
interval.</p></li>
<li><p><strong>bins_n</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- The number of bins (i.e., &quot;bands&quot;) to achieve
after spectral resampling is complete. Ignored if <code class="docutils literal notranslate"><span class="pre">bandwidth</span></code>
is not <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object) -- The datacube being accessed and/or
manipulated.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>2-element <code class="docutils literal notranslate"><span class="pre">tuple</span></code> containing</p>
<ul class="simple">
<li><p><strong>array_bin</strong> (<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>): Binned datacube.</p></li>
<li><p><strong>metadata</strong> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>): Modified metadata describing the
binned spectral array (<code class="docutils literal notranslate"><span class="pre">array_bin</span></code>).</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code> and <code class="docutils literal notranslate"><span class="pre">spec_mod</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">spec_mod</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_hdr</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">read_cube</span><span class="p">(</span><span class="n">fname_hdr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_spec_mod</span> <span class="o">=</span> <span class="n">spec_mod</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
</pre></div>
</div>
<p>Use spec_mod.spectral_resample to &quot;bin&quot; the datacube to bands with
20 nm bandwidths.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">array_bin</span><span class="p">,</span> <span class="n">metadata_bin</span> <span class="o">=</span> <span class="n">my_spec_mod</span><span class="o">.</span><span class="n">spectral_resample</span><span class="p">(</span><span class="n">bandwidth</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
<p>Plot the mean spectral response of the hyperspectral image to that
of the binned image bands (mean calculated across the entire image).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ast</span> <span class="kn">import</span> <span class="n">literal_eval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spy_hs</span> <span class="o">=</span> <span class="n">my_spec_mod</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">open_memmap</span><span class="p">()</span>  <span class="c1"># datacube before smoothing</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">meta_bands</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">meta_bands</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">meta_bands_bin</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">literal_eval</span><span class="p">(</span><span class="n">metadata_bin</span><span class="p">[</span><span class="s1">&#39;wavelength&#39;</span><span class="p">])])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">spy_hs</span><span class="p">[</span><span class="mi">200</span><span class="p">][</span><span class="mi">800</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Hyperspectral (Pika II)&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands_bin</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">array_bin</span><span class="p">[</span><span class="mi">200</span><span class="p">][</span><span class="mi">800</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Spectral resample (20 nm)&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavelength (nm)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Reflectance (%)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;API Example: `spec_mod.spectral_resample`&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../img/spec_mod/spectral_resample.png" src="../img/spec_mod/spectral_resample.png" />
</dd></dl>

<dl class="py method">
<dt id="hs_process.spec_mod.spectral_smooth">
<code class="sig-name descname"><span class="pre">spectral_smooth</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spyfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hs_process/spec_mod.html#spec_mod.spectral_smooth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hs_process.spec_mod.spectral_smooth" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs Savitzky-Golay smoothing on the spectral domain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>window_size</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- the length of the window; must be an odd
integer number (default: 11).</p></li>
<li><p><strong>order</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) -- the order of the polynomial used in the filtering;
must be less than <code class="docutils literal notranslate"><span class="pre">window_size</span></code> - 1 (default: 2).</p></li>
<li><p><strong>spyfile</strong> (<code class="docutils literal notranslate"><span class="pre">SpyFile</span></code> object or <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) -- The data cube to
clip; if <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code>, loads band information
from <code class="docutils literal notranslate"><span class="pre">spec_mod.spyfile</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>2-element <code class="docutils literal notranslate"><span class="pre">tuple</span></code> containing</p>
<ul class="simple">
<li><p><strong>array_smooth</strong> (<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>): Clipped datacube.</p></li>
<li><p><strong>metadata</strong> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>): Modified metadata describing the smoothed
hyperspectral datacube (<code class="docutils literal notranslate"><span class="pre">array_smooth</span></code>).</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Because the smoothing operation is performed for every pixel
individually, this function may take several minutes for large
images.</p>
</div>
<p class="rubric">Example</p>
<p>Load and initialize <code class="docutils literal notranslate"><span class="pre">hsio</span></code> and <code class="docutils literal notranslate"><span class="pre">spec_mod</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">hsio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hs_process</span> <span class="kn">import</span> <span class="n">spec_mod</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_dir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;F:\nigo0024\Documents\hs_process_demo&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname_hdr</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;Wells_rep2_20180628_16h56m_pika_gige_7-Radiance Conversion-Georectify Airborne Datacube-Convert Radiance Cube to Reflectance from Measured Reference Spectrum.bip.hdr&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">hsio</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">read_cube</span><span class="p">(</span><span class="n">fname_hdr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_spec_mod</span> <span class="o">=</span> <span class="n">spec_mod</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">spyfile</span><span class="p">)</span>
</pre></div>
</div>
<p>Use <code class="docutils literal notranslate"><span class="pre">spec_mod.spectral_smooth</span></code> to perform a <em>Savitzky-Golay</em>
smoothing operation across the hyperspectral spectral signature.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">array_smooth</span><span class="p">,</span> <span class="n">metadata_smooth</span> <span class="o">=</span> <span class="n">my_spec_mod</span><span class="o">.</span><span class="n">spectral_smooth</span><span class="p">(</span>
<span class="go">        window_size=11, order=2)</span>
</pre></div>
</div>
<p>Plot the spectra of an individual pixel to visualize the result of the smoothing procedure.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spy_hs</span> <span class="o">=</span> <span class="n">my_spec_mod</span><span class="o">.</span><span class="n">spyfile</span><span class="o">.</span><span class="n">open_memmap</span><span class="p">()</span>  <span class="c1"># datacube before smoothing</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">meta_bands</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">meta_bands</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">meta_bands_smooth</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">metadata_smooth</span><span class="p">[</span><span class="s1">&#39;wavelength&#39;</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">spy_hs</span><span class="p">[</span><span class="mi">200</span><span class="p">][</span><span class="mi">800</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Before spectral smoothing&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">meta_bands_smooth</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">array_smooth</span><span class="p">[</span><span class="mi">200</span><span class="p">][</span><span class="mi">800</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;After spectral smoothing&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavelength (nm)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Reflectance (%)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;API Example: `spec_mod.spectral_smooth`&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../img/spec_mod/spectral_smooth.png" src="../img/spec_mod/spectral_smooth.png" />
</dd></dl>

</dd></dl>

</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2019-2021, Tyler J. Nigon.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.5.4.<br/>
    </p>
  </div>
</footer>
  </body>
</html>